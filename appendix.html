<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<meta name="author" content="[[sail-appendix]]">
<title>Auto-generated appendix example</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge, pre.rouge .w {
  color: #24292f;
  background-color: #f6f8fa;
}
pre.rouge .k, pre.rouge .kd, pre.rouge .kn, pre.rouge .kp, pre.rouge .kr, pre.rouge .kt, pre.rouge .kv {
  color: #cf222e;
}
pre.rouge .gr {
  color: #f6f8fa;
}
pre.rouge .gd {
  color: #82071e;
  background-color: #ffebe9;
}
pre.rouge .nb {
  color: #953800;
}
pre.rouge .nc {
  color: #953800;
}
pre.rouge .no {
  color: #953800;
}
pre.rouge .nn {
  color: #953800;
}
pre.rouge .sr {
  color: #116329;
}
pre.rouge .na {
  color: #116329;
}
pre.rouge .nt {
  color: #116329;
}
pre.rouge .gi {
  color: #116329;
  background-color: #dafbe1;
}
pre.rouge .ges {
  font-weight: bold;
  font-style: italic;
}
pre.rouge .kc {
  color: #0550ae;
}
pre.rouge .l, pre.rouge .ld, pre.rouge .m, pre.rouge .mb, pre.rouge .mf, pre.rouge .mh, pre.rouge .mi, pre.rouge .il, pre.rouge .mo, pre.rouge .mx {
  color: #0550ae;
}
pre.rouge .sb {
  color: #0550ae;
}
pre.rouge .bp {
  color: #0550ae;
}
pre.rouge .ne {
  color: #0550ae;
}
pre.rouge .nl {
  color: #0550ae;
}
pre.rouge .py {
  color: #0550ae;
}
pre.rouge .nv, pre.rouge .vc, pre.rouge .vg, pre.rouge .vi, pre.rouge .vm {
  color: #0550ae;
}
pre.rouge .o, pre.rouge .ow {
  color: #0550ae;
}
pre.rouge .gh {
  color: #0550ae;
  font-weight: bold;
}
pre.rouge .gu {
  color: #0550ae;
  font-weight: bold;
}
pre.rouge .s, pre.rouge .sa, pre.rouge .sc, pre.rouge .dl, pre.rouge .sd, pre.rouge .s2, pre.rouge .se, pre.rouge .sh, pre.rouge .sx, pre.rouge .s1, pre.rouge .ss {
  color: #0a3069;
}
pre.rouge .nd {
  color: #8250df;
}
pre.rouge .nf, pre.rouge .fm {
  color: #8250df;
}
pre.rouge .err {
  color: #f6f8fa;
  background-color: #82071e;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cm, pre.rouge .cp, pre.rouge .cpf, pre.rouge .c1, pre.rouge .cs {
  color: #6e7781;
}
pre.rouge .gl {
  color: #6e7781;
}
pre.rouge .gt {
  color: #6e7781;
}
pre.rouge .ni {
  color: #24292f;
}
pre.rouge .si {
  color: #24292f;
}
pre.rouge .ge {
  color: #24292f;
  font-style: italic;
}
pre.rouge .gs {
  color: #24292f;
  font-weight: bold;
}
</style>
</head>
<body class="article">
<div id="header">
<h1>Auto-generated appendix example</h1>
<div class="details">
<span id="author" class="author">[[sail-appendix]]</span><br>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_appendix_of_sail_instructions">Appendix of Sail instructions</a>
<ul class="sectlevel2">
<li><a href="#_instructions">Instructions</a>
<ul class="sectlevel3">
<li><a href="#_addiw">ADDIW</a></li>
<li><a href="#_aes32dsi">AES32DSI</a></li>
<li><a href="#_aes32dsmi">AES32DSMI</a></li>
<li><a href="#_aes32esi">AES32ESI</a></li>
<li><a href="#_aes32esmi">AES32ESMI</a></li>
<li><a href="#_aes64ds">AES64DS</a></li>
<li><a href="#_aes64dsm">AES64DSM</a></li>
<li><a href="#_aes64es">AES64ES</a></li>
<li><a href="#_aes64esm">AES64ESM</a></li>
<li><a href="#_aes64im">AES64IM</a></li>
<li><a href="#_aes64ks1i">AES64KS1I</a></li>
<li><a href="#_aes64ks2">AES64KS2</a></li>
<li><a href="#_amo">AMO</a></li>
<li><a href="#_brev8">BREV8</a></li>
<li><a href="#_btype">BTYPE</a></li>
<li><a href="#_clmul">CLMUL</a></li>
<li><a href="#_clmulh">CLMULH</a></li>
<li><a href="#_clmulr">CLMULR</a></li>
<li><a href="#_clz">CLZ</a></li>
<li><a href="#_clzw">CLZW</a></li>
<li><a href="#_cpop">CPOP</a></li>
<li><a href="#_cpopw">CPOPW</a></li>
<li><a href="#_csrimm">CSRImm</a></li>
<li><a href="#_csrreg">CSRReg</a></li>
<li><a href="#_ctz">CTZ</a></li>
<li><a href="#_ctzw">CTZW</a></li>
<li><a href="#_div">DIV</a></li>
<li><a href="#_divw">DIVW</a></li>
<li><a href="#_ebreak">EBREAK</a></li>
<li><a href="#_ecall">ECALL</a></li>
<li><a href="#_f_bin_f_type_d">F.BIN.F.TYPE.D</a></li>
<li><a href="#_f_bin_f_type_d_2">F.BIN.F.TYPE.D</a></li>
<li><a href="#_f_bin_f_type_d_3">F.BIN.F.TYPE.D</a></li>
<li><a href="#_f_bin_f_type_d_4">F.BIN.F.TYPE.D</a></li>
<li><a href="#_f_bin_f_type_d_5">F.BIN.F.TYPE.D</a></li>
<li><a href="#_f_bin_f_type_h">F.BIN.F.TYPE.H</a></li>
<li><a href="#_f_bin_f_type_h_2">F.BIN.F.TYPE.H</a></li>
<li><a href="#_f_bin_f_type_h_3">F.BIN.F.TYPE.H</a></li>
<li><a href="#_f_bin_f_type_h_4">F.BIN.F.TYPE.H</a></li>
<li><a href="#_f_bin_f_type_h_5">F.BIN.F.TYPE.H</a></li>
<li><a href="#_f_bin_rm_type_d">F.BIN.RM.TYPE.D</a></li>
<li><a href="#_f_bin_rm_type_h">F.BIN.RM.TYPE.H</a></li>
<li><a href="#_f_bin_rm_type_s">F.BIN.RM.TYPE.S</a></li>
<li><a href="#_f_bin_type_f_s">F.BIN.TYPE.F.S</a></li>
<li><a href="#_f_bin_type_f_s_2">F.BIN.TYPE.F.S</a></li>
<li><a href="#_f_bin_type_f_s_3">F.BIN.TYPE.F.S</a></li>
<li><a href="#_f_bin_type_f_s_4">F.BIN.TYPE.F.S</a></li>
<li><a href="#_f_bin_type_f_s_5">F.BIN.TYPE.F.S</a></li>
<li><a href="#_f_bin_type_x_s">F.BIN.TYPE.X.S</a></li>
<li><a href="#_f_bin_type_x_s_2">F.BIN.TYPE.X.S</a></li>
<li><a href="#_f_bin_type_x_s_3">F.BIN.TYPE.X.S</a></li>
<li><a href="#_f_bin_x_type_d">F.BIN.X.TYPE.D</a></li>
<li><a href="#_f_bin_x_type_d_2">F.BIN.X.TYPE.D</a></li>
<li><a href="#_f_bin_x_type_d_3">F.BIN.X.TYPE.D</a></li>
<li><a href="#_f_bin_x_type_h">F.BIN.X.TYPE.H</a></li>
<li><a href="#_f_bin_x_type_h_2">F.BIN.X.TYPE.H</a></li>
<li><a href="#_f_bin_x_type_h_3">F.BIN.X.TYPE.H</a></li>
<li><a href="#_f_madd_type_d">F.MADD.TYPE.D</a></li>
<li><a href="#_f_madd_type_h">F.MADD.TYPE.H</a></li>
<li><a href="#_f_madd_type_s">F.MADD.TYPE.S</a></li>
<li><a href="#_f_un_f_type_d">F.UN.F.TYPE.D</a></li>
<li><a href="#_f_un_f_type_h">F.UN.F.TYPE.H</a></li>
<li><a href="#_f_un_rm_ff_type_d">F.UN.RM.FF.TYPE.D</a></li>
<li><a href="#_f_un_rm_ff_type_d_2">F.UN.RM.FF.TYPE.D</a></li>
<li><a href="#_f_un_rm_ff_type_d_3">F.UN.RM.FF.TYPE.D</a></li>
<li><a href="#_f_un_rm_ff_type_h">F.UN.RM.FF.TYPE.H</a></li>
<li><a href="#_f_un_rm_ff_type_h_2">F.UN.RM.FF.TYPE.H</a></li>
<li><a href="#_f_un_rm_ff_type_h_3">F.UN.RM.FF.TYPE.H</a></li>
<li><a href="#_f_un_rm_ff_type_h_4">F.UN.RM.FF.TYPE.H</a></li>
<li><a href="#_f_un_rm_ff_type_h_5">F.UN.RM.FF.TYPE.H</a></li>
<li><a href="#_f_un_rm_ff_type_s">F.UN.RM.FF.TYPE.S</a></li>
<li><a href="#_f_un_rm_fx_type_d">F.UN.RM.FX.TYPE.D</a></li>
<li><a href="#_f_un_rm_fx_type_d_2">F.UN.RM.FX.TYPE.D</a></li>
<li><a href="#_f_un_rm_fx_type_d_3">F.UN.RM.FX.TYPE.D</a></li>
<li><a href="#_f_un_rm_fx_type_d_4">F.UN.RM.FX.TYPE.D</a></li>
<li><a href="#_f_un_rm_fx_type_h">F.UN.RM.FX.TYPE.H</a></li>
<li><a href="#_f_un_rm_fx_type_h_2">F.UN.RM.FX.TYPE.H</a></li>
<li><a href="#_f_un_rm_fx_type_h_3">F.UN.RM.FX.TYPE.H</a></li>
<li><a href="#_f_un_rm_fx_type_h_4">F.UN.RM.FX.TYPE.H</a></li>
<li><a href="#_f_un_rm_fx_type_s">F.UN.RM.FX.TYPE.S</a></li>
<li><a href="#_f_un_rm_fx_type_s_2">F.UN.RM.FX.TYPE.S</a></li>
<li><a href="#_f_un_rm_fx_type_s_3">F.UN.RM.FX.TYPE.S</a></li>
<li><a href="#_f_un_rm_fx_type_s_4">F.UN.RM.FX.TYPE.S</a></li>
<li><a href="#_f_un_rm_xf_type_d">F.UN.RM.XF.TYPE.D</a></li>
<li><a href="#_f_un_rm_xf_type_d_2">F.UN.RM.XF.TYPE.D</a></li>
<li><a href="#_f_un_rm_xf_type_d_3">F.UN.RM.XF.TYPE.D</a></li>
<li><a href="#_f_un_rm_xf_type_d_4">F.UN.RM.XF.TYPE.D</a></li>
<li><a href="#_f_un_rm_xf_type_h">F.UN.RM.XF.TYPE.H</a></li>
<li><a href="#_f_un_rm_xf_type_h_2">F.UN.RM.XF.TYPE.H</a></li>
<li><a href="#_f_un_rm_xf_type_h_3">F.UN.RM.XF.TYPE.H</a></li>
<li><a href="#_f_un_rm_xf_type_h_4">F.UN.RM.XF.TYPE.H</a></li>
<li><a href="#_f_un_rm_xf_type_s">F.UN.RM.XF.TYPE.S</a></li>
<li><a href="#_f_un_rm_xf_type_s_2">F.UN.RM.XF.TYPE.S</a></li>
<li><a href="#_f_un_rm_xf_type_s_3">F.UN.RM.XF.TYPE.S</a></li>
<li><a href="#_f_un_rm_xf_type_s_4">F.UN.RM.XF.TYPE.S</a></li>
<li><a href="#_f_un_type_f_s">F.UN.TYPE.F.S</a></li>
<li><a href="#_f_un_type_x_s">F.UN.TYPE.X.S</a></li>
<li><a href="#_f_un_type_x_s_2">F.UN.TYPE.X.S</a></li>
<li><a href="#_f_un_x_type_d">F.UN.X.TYPE.D</a></li>
<li><a href="#_f_un_x_type_d_2">F.UN.X.TYPE.D</a></li>
<li><a href="#_f_un_x_type_h">F.UN.X.TYPE.H</a></li>
<li><a href="#_f_un_x_type_h_2">F.UN.X.TYPE.H</a></li>
<li><a href="#_fcvtmod_w_d">FCVTMOD.W.D</a></li>
<li><a href="#_fence">FENCE</a></li>
<li><a href="#_fence_reserved">FENCE.RESERVED</a></li>
<li><a href="#_fence_tso">FENCE.TSO</a></li>
<li><a href="#_fencei_reserved">FENCEI.RESERVED</a></li>
<li><a href="#_fleq_d">FLEQ.D</a></li>
<li><a href="#_fleq_h">FLEQ.H</a></li>
<li><a href="#_fleq_s">FLEQ.S</a></li>
<li><a href="#_fli_d">FLI.D</a></li>
<li><a href="#_fli_h">FLI.H</a></li>
<li><a href="#_fli_s">FLI.S</a></li>
<li><a href="#_fltq_d">FLTQ.D</a></li>
<li><a href="#_fltq_h">FLTQ.H</a></li>
<li><a href="#_fltq_s">FLTQ.S</a></li>
<li><a href="#_fmaxm_d">FMAXM.D</a></li>
<li><a href="#_fmaxm_h">FMAXM.H</a></li>
<li><a href="#_fmaxm_s">FMAXM.S</a></li>
<li><a href="#_fminm_d">FMINM.D</a></li>
<li><a href="#_fminm_h">FMINM.H</a></li>
<li><a href="#_fminm_s">FMINM.S</a></li>
<li><a href="#_fmvh_x_d">FMVH.X.D</a></li>
<li><a href="#_fmvp_d_x">FMVP.D.X</a></li>
<li><a href="#_fround_d">FROUND.D</a></li>
<li><a href="#_fround_h">FROUND.H</a></li>
<li><a href="#_fround_s">FROUND.S</a></li>
<li><a href="#_froundnx_d">FROUNDNX.D</a></li>
<li><a href="#_froundnx_h">FROUNDNX.H</a></li>
<li><a href="#_froundnx_s">FROUNDNX.S</a></li>
<li><a href="#_fvfmatype">FVFMATYPE</a></li>
<li><a href="#_fvfmtype">FVFMTYPE</a></li>
<li><a href="#_fvftype">FVFTYPE</a></li>
<li><a href="#_fvvmatype">FVVMATYPE</a></li>
<li><a href="#_fvvmtype">FVVMTYPE</a></li>
<li><a href="#_fvvtype">FVVTYPE</a></li>
<li><a href="#_fwftype">FWFTYPE</a></li>
<li><a href="#_fwvfmatype">FWVFMATYPE</a></li>
<li><a href="#_fwvftype">FWVFTYPE</a></li>
<li><a href="#_fwvtype">FWVTYPE</a></li>
<li><a href="#_fwvvmatype">FWVVMATYPE</a></li>
<li><a href="#_fwvvtype">FWVVTYPE</a></li>
<li><a href="#_itype">ITYPE</a></li>
<li><a href="#_jal">JAL</a></li>
<li><a href="#_jalr">JALR</a></li>
<li><a href="#_load">LOAD</a></li>
<li><a href="#_load_fp">LOAD.FP</a></li>
<li><a href="#_loadres">LOADRES</a></li>
<li><a href="#_masktypei">MASKTYPEI</a></li>
<li><a href="#_masktypev">MASKTYPEV</a></li>
<li><a href="#_masktypex">MASKTYPEX</a></li>
<li><a href="#_mmtype">MMTYPE</a></li>
<li><a href="#_movetypei">MOVETYPEI</a></li>
<li><a href="#_movetypev">MOVETYPEV</a></li>
<li><a href="#_movetypex">MOVETYPEX</a></li>
<li><a href="#_mret">MRET</a></li>
<li><a href="#_mul">MUL</a></li>
<li><a href="#_mulw">MULW</a></li>
<li><a href="#_mvvcompress">MVVCOMPRESS</a></li>
<li><a href="#_mvvmatype">MVVMATYPE</a></li>
<li><a href="#_mvvtype">MVVTYPE</a></li>
<li><a href="#_mvxmatype">MVXMATYPE</a></li>
<li><a href="#_mvxtype">MVXTYPE</a></li>
<li><a href="#_nistype">NISTYPE</a></li>
<li><a href="#_nitype">NITYPE</a></li>
<li><a href="#_nvstype">NVSTYPE</a></li>
<li><a href="#_nvtype">NVTYPE</a></li>
<li><a href="#_nxstype">NXSTYPE</a></li>
<li><a href="#_nxtype">NXTYPE</a></li>
<li><a href="#_orcb">ORCB</a></li>
<li><a href="#_rem">REM</a></li>
<li><a href="#_remw">REMW</a></li>
<li><a href="#_rev8">REV8</a></li>
<li><a href="#_rfvvtype">RFVVTYPE</a></li>
<li><a href="#_rivvtype">RIVVTYPE</a></li>
<li><a href="#_rmvvtype">RMVVTYPE</a></li>
<li><a href="#_rori">RORI</a></li>
<li><a href="#_roriw">RORIW</a></li>
<li><a href="#_rtype">RTYPE</a></li>
<li><a href="#_rtypew">RTYPEW</a></li>
<li><a href="#_sfence_inval_ir">SFENCE.INVAL.IR</a></li>
<li><a href="#_sfence_vma">SFENCE.VMA</a></li>
<li><a href="#_sfence_w_inval">SFENCE.W.INVAL</a></li>
<li><a href="#_sha256sig0">SHA256SIG0</a></li>
<li><a href="#_sha256sig1">SHA256SIG1</a></li>
<li><a href="#_sha256sum0">SHA256SUM0</a></li>
<li><a href="#_sha256sum1">SHA256SUM1</a></li>
<li><a href="#_sha512sig0">SHA512SIG0</a></li>
<li><a href="#_sha512sig0h">SHA512SIG0H</a></li>
<li><a href="#_sha512sig0l">SHA512SIG0L</a></li>
<li><a href="#_sha512sig1">SHA512SIG1</a></li>
<li><a href="#_sha512sig1h">SHA512SIG1H</a></li>
<li><a href="#_sha512sig1l">SHA512SIG1L</a></li>
<li><a href="#_sha512sum0">SHA512SUM0</a></li>
<li><a href="#_sha512sum0r">SHA512SUM0R</a></li>
<li><a href="#_sha512sum1">SHA512SUM1</a></li>
<li><a href="#_sha512sum1r">SHA512SUM1R</a></li>
<li><a href="#_shiftiop">SHIFTIOP</a></li>
<li><a href="#_shiftiwop">SHIFTIWOP</a></li>
<li><a href="#_sinval_vma">SINVAL.VMA</a></li>
<li><a href="#_slliuw">SLLIUW</a></li>
<li><a href="#_sm3p0">SM3P0</a></li>
<li><a href="#_sm3p1">SM3P1</a></li>
<li><a href="#_sm4ed">SM4ED</a></li>
<li><a href="#_sm4ks">SM4KS</a></li>
<li><a href="#_sret">SRET</a></li>
<li><a href="#_store">STORE</a></li>
<li><a href="#_store_fp">STORE.FP</a></li>
<li><a href="#_storecon">STORECON</a></li>
<li><a href="#_unzip">UNZIP</a></li>
<li><a href="#_utype">UTYPE</a></li>
<li><a href="#_vaesdf">VAESDF</a></li>
<li><a href="#_vaesdm">VAESDM</a></li>
<li><a href="#_vaesef">VAESEF</a></li>
<li><a href="#_vaesem">VAESEM</a></li>
<li><a href="#_vaeskf1_vi">VAESKF1.VI</a></li>
<li><a href="#_vaeskf2_vi">VAESKF2.VI</a></li>
<li><a href="#_vaesz_vs">VAESZ.VS</a></li>
<li><a href="#_vandn_vv">VANDN.VV</a></li>
<li><a href="#_vandn_vx">VANDN.VX</a></li>
<li><a href="#_vbrev_v">VBREV.V</a></li>
<li><a href="#_vbrev8_v">VBREV8.V</a></li>
<li><a href="#_vclmul_vv">VCLMUL.VV</a></li>
<li><a href="#_vclmul_vx">VCLMUL.VX</a></li>
<li><a href="#_vclmulh_vv">VCLMULH.VV</a></li>
<li><a href="#_vclmulh_vx">VCLMULH.VX</a></li>
<li><a href="#_vclz_v">VCLZ.V</a></li>
<li><a href="#_vcpop_m">VCPOP.M</a></li>
<li><a href="#_vcpop_v">VCPOP.V</a></li>
<li><a href="#_vctz_v">VCTZ.V</a></li>
<li><a href="#_vexttype">VEXTTYPE</a></li>
<li><a href="#_vfirst_m">VFIRST.M</a></li>
<li><a href="#_vfmerge">VFMERGE</a></li>
<li><a href="#_vfmv">VFMV</a></li>
<li><a href="#_vfmvfs">VFMVFS</a></li>
<li><a href="#_vfmvsf">VFMVSF</a></li>
<li><a href="#_vfnunary0">VFNUNARY0</a></li>
<li><a href="#_vfunary0">VFUNARY0</a></li>
<li><a href="#_vfunary1">VFUNARY1</a></li>
<li><a href="#_vfwunary0">VFWUNARY0</a></li>
<li><a href="#_vghsh_vv">VGHSH.VV</a></li>
<li><a href="#_vgmul_vv">VGMUL.VV</a></li>
<li><a href="#_vicmptype">VICMPTYPE</a></li>
<li><a href="#_vid_v">VID.V</a></li>
<li><a href="#_vimctype">VIMCTYPE</a></li>
<li><a href="#_vimstype">VIMSTYPE</a></li>
<li><a href="#_vimtype">VIMTYPE</a></li>
<li><a href="#_viota_m">VIOTA.M</a></li>
<li><a href="#_visg">VISG</a></li>
<li><a href="#_vitype">VITYPE</a></li>
<li><a href="#_vloxsegtype">VLOXSEGTYPE</a></li>
<li><a href="#_vlretype">VLRETYPE</a></li>
<li><a href="#_vlsegfftype">VLSEGFFTYPE</a></li>
<li><a href="#_vlsegtype">VLSEGTYPE</a></li>
<li><a href="#_vlssegtype">VLSSEGTYPE</a></li>
<li><a href="#_vluxsegtype">VLUXSEGTYPE</a></li>
<li><a href="#_vmsbf_m">VMSBF.M</a></li>
<li><a href="#_vmsif_m">VMSIF.M</a></li>
<li><a href="#_vmsof_m">VMSOF.M</a></li>
<li><a href="#_vmtype">VMTYPE</a></li>
<li><a href="#_vmvrtype">VMVRTYPE</a></li>
<li><a href="#_vmvsx">VMVSX</a></li>
<li><a href="#_vmvxs">VMVXS</a></li>
<li><a href="#_vrev8_v">VREV8.V</a></li>
<li><a href="#_vrol_vv">VROL.VV</a></li>
<li><a href="#_vrol_vx">VROL.VX</a></li>
<li><a href="#_vror_vi">VROR.VI</a></li>
<li><a href="#_vror_vv">VROR.VV</a></li>
<li><a href="#_vror_vx">VROR.VX</a></li>
<li><a href="#_vsetivli">VSETIVLI</a></li>
<li><a href="#_vsetvl">VSETVL</a></li>
<li><a href="#_vsetvli">VSETVLI</a></li>
<li><a href="#_vsha2ms_vv">VSHA2MS.VV</a></li>
<li><a href="#_vsm3c_vi">VSM3C.VI</a></li>
<li><a href="#_vsm3me_vv">VSM3ME.VV</a></li>
<li><a href="#_vsm4k_vi">VSM4K.VI</a></li>
<li><a href="#_vsoxsegtype">VSOXSEGTYPE</a></li>
<li><a href="#_vsretype">VSRETYPE</a></li>
<li><a href="#_vssegtype">VSSEGTYPE</a></li>
<li><a href="#_vsssegtype">VSSSEGTYPE</a></li>
<li><a href="#_vsuxsegtype">VSUXSEGTYPE</a></li>
<li><a href="#_vvcmptype">VVCMPTYPE</a></li>
<li><a href="#_vvmctype">VVMCTYPE</a></li>
<li><a href="#_vvmstype">VVMSTYPE</a></li>
<li><a href="#_vvmtype">VVMTYPE</a></li>
<li><a href="#_vvtype">VVTYPE</a></li>
<li><a href="#_vwsll_vi">VWSLL.VI</a></li>
<li><a href="#_vwsll_vv">VWSLL.VV</a></li>
<li><a href="#_vwsll_vx">VWSLL.VX</a></li>
<li><a href="#_vxcmptype">VXCMPTYPE</a></li>
<li><a href="#_vxmctype">VXMCTYPE</a></li>
<li><a href="#_vxmstype">VXMSTYPE</a></li>
<li><a href="#_vxmtype">VXMTYPE</a></li>
<li><a href="#_vxsg">VXSG</a></li>
<li><a href="#_vxtype">VXTYPE</a></li>
<li><a href="#_wfi">WFI</a></li>
<li><a href="#_wmvvtype">WMVVTYPE</a></li>
<li><a href="#_wmvxtype">WMVXTYPE</a></li>
<li><a href="#_wrs">WRS</a></li>
<li><a href="#_wrs_2">WRS</a></li>
<li><a href="#_wvtype">WVTYPE</a></li>
<li><a href="#_wvvtype">WVVTYPE</a></li>
<li><a href="#_wvxtype">WVXTYPE</a></li>
<li><a href="#_wxtype">WXTYPE</a></li>
<li><a href="#_xperm4">XPERM4</a></li>
<li><a href="#_xperm8">XPERM8</a></li>
<li><a href="#_zba_rtype">ZBA.RTYPE</a></li>
<li><a href="#_zba_rtypeuw">ZBA.RTYPEUW</a></li>
<li><a href="#_zbb_extop">ZBB.EXTOP</a></li>
<li><a href="#_zbb_rtype">ZBB.RTYPE</a></li>
<li><a href="#_zbb_rtypew">ZBB.RTYPEW</a></li>
<li><a href="#_zbkb_packw">ZBKB.PACKW</a></li>
<li><a href="#_zbkb_rtype">ZBKB.RTYPE</a></li>
<li><a href="#_zbs_iop">ZBS.IOP</a></li>
<li><a href="#_zbs_rtype">ZBS.RTYPE</a></li>
<li><a href="#_zicbom">ZICBOM</a></li>
<li><a href="#_zicbom_2">ZICBOM</a></li>
<li><a href="#_zicbom_3">ZICBOM</a></li>
<li><a href="#_zicboz">ZICBOZ</a></li>
<li><a href="#_zicond_rtype">ZICOND.RTYPE</a></li>
<li><a href="#_zicond_rtype_2">ZICOND.RTYPE</a></li>
<li><a href="#_zimop_mop_r">ZIMOP.MOP.R</a></li>
<li><a href="#_zimop_mop_rr">ZIMOP.MOP.RR</a></li>
<li><a href="#_zip">ZIP</a></li>
<li><a href="#_zvksha2type">ZVKSHA2TYPE</a></li>
<li><a href="#_zvksm4rtype">ZVKSM4RTYPE</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_appendix_of_sail_instructions">Appendix of Sail instructions</h2>
<div class="sectionbody">
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
This is very experimental! Expect issues and bugs!
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_instructions">Instructions</h3>
<div class="sect3">
<h4 id="_addiw">ADDIW</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-4c7ca1106b7bec418aae13f2a464db67.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 1. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ADDIW goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">imm</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">]);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_aes32dsi">AES32DSI</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-094caa9abf612b31d08657631c7a3d5a.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 2. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for AES32DSI goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">shamt</span><span class="w">   </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">bs</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b000</span><span class="p">;</span><span class="w"> </span><span class="c">/* shamt = bs*8 */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">si</span><span class="w">      </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">)[</span><span class="mi">7</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w"> </span><span class="c">/* SBox Input */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">so</span><span class="w">      </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mh">0x000000</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L188">aes_sbox_inv</a></span><span class="p">(</span><span class="n">si</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">so</span><span class="w"> </span><span class="o">&lt;&lt;&lt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_aes32dsmi">AES32DSMI</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-c508a1ba79d122c68d2c29c5eced8b0d.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 3. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for AES32DSMI goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">shamt</span><span class="w">   </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">bs</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b000</span><span class="p">;</span><span class="w"> </span><span class="c">/* shamt = bs*8 */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">si</span><span class="w">      </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">)[</span><span class="mi">7</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w"> </span><span class="c">/* SBox Input */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">so</span><span class="w">      </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L188">aes_sbox_inv</a></span><span class="p">(</span><span class="n">si</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">mixed</span><span class="w">   </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L47">aes_mixcolumn_byte_inv</a></span><span class="p">(</span><span class="n">so</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">mixed</span><span class="w"> </span><span class="o">&lt;&lt;&lt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_aes32esi">AES32ESI</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-ed92a8b4b9b8c5728655aa7a2c3b5f12.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 4. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for AES32ESI goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">shamt</span><span class="w">   </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">bs</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b000</span><span class="p">;</span><span class="w"> </span><span class="c">/* shamt = bs*8 */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">si</span><span class="w">      </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">)[</span><span class="mi">7</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w"> </span><span class="c">/* SBox Input */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">so</span><span class="w">      </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mh">0x000000</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L184">aes_sbox_fwd</a></span><span class="p">(</span><span class="n">si</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">so</span><span class="w"> </span><span class="o">&lt;&lt;&lt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_aes32esmi">AES32ESMI</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-a135c0969bd243a261b4b76fbdc41af6.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 5. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for AES32ESMI goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">shamt</span><span class="w">   </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">bs</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b000</span><span class="p">;</span><span class="w"> </span><span class="c">/* shamt = bs*8 */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">si</span><span class="w">      </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">)[</span><span class="mi">7</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w"> </span><span class="c">/* SBox Input */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">so</span><span class="w">      </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L184">aes_sbox_fwd</a></span><span class="p">(</span><span class="n">si</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">mixed</span><span class="w">   </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L41">aes_mixcolumn_byte_fwd</a></span><span class="p">(</span><span class="n">so</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">mixed</span><span class="w"> </span><span class="o">&lt;&lt;&lt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_aes64ds">AES64DS</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-14d99c0e82184cc44ed350377c9b1796.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 6. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for AES64DS goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">AES64DS</span><span class="p">(</span><span class="n">rs2</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">sr</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L269">aes_rv64_shiftrows_inv</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">),</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">));</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">wd</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">sr</span><span class="p">[</span><span class="mi">63</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L238">aes_apply_inv_sbox_to_each_byte</a></span><span class="p">(</span><span class="n">wd</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_aes64dsm">AES64DSM</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-a356f85c7b36148423a79e2d0d750639.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 7. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for AES64DSM goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">AES64DSM</span><span class="p">(</span><span class="n">rs2</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">sr</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L269">aes_rv64_shiftrows_inv</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">),</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">));</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">wd</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">sr</span><span class="p">[</span><span class="mi">63</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">sb</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L238">aes_apply_inv_sbox_to_each_byte</a></span><span class="p">(</span><span class="n">wd</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L67">aes_mixcolumn_inv</a></span><span class="p">(</span><span class="n">sb</span><span class="p">[</span><span class="mi">63</span><span class="o">..</span><span class="mi">32</span><span class="p">])</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L67">aes_mixcolumn_inv</a></span><span class="p">(</span><span class="n">sb</span><span class="p">[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">]);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_aes64es">AES64ES</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-2e4b95eb3945ef4e5dad0b0456e4a1d6.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 8. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for AES64ES goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">AES64ES</span><span class="p">(</span><span class="n">rs2</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">sr</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L257">aes_rv64_shiftrows_fwd</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">),</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">));</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">wd</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">sr</span><span class="p">[</span><span class="mi">63</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L223">aes_apply_fwd_sbox_to_each_byte</a></span><span class="p">(</span><span class="n">wd</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_aes64esm">AES64ESM</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-3d64ca147efe999508b2c24213c99f49.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 9. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for AES64ESM goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">AES64ESM</span><span class="p">(</span><span class="n">rs2</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">sr</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L257">aes_rv64_shiftrows_fwd</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">),</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">));</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">wd</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">sr</span><span class="p">[</span><span class="mi">63</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">sb</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L223">aes_apply_fwd_sbox_to_each_byte</a></span><span class="p">(</span><span class="n">wd</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L53">aes_mixcolumn_fwd</a></span><span class="p">(</span><span class="n">sb</span><span class="p">[</span><span class="mi">63</span><span class="o">..</span><span class="mi">32</span><span class="p">])</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L53">aes_mixcolumn_fwd</a></span><span class="p">(</span><span class="n">sb</span><span class="p">[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">]);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_aes64im">AES64IM</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-43c288e45c13b8661b3c9e98e6596e77.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 10. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for AES64IM goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">AES64IM</span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">w0</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L67">aes_mixcolumn_inv</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">]);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">w1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L67">aes_mixcolumn_inv</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">63</span><span class="o">..</span><span class="mi">32</span><span class="p">]);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">w1</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">w0</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_aes64ks1i">AES64KS1I</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-80b141f325b97bc27f90d75e1f250087.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 11. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for AES64KS1I goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">AES64KS1I</span><span class="p">(</span><span class="n">rnum</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">prev</span><span class="w">     </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">63</span><span class="o">..</span><span class="mi">32</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">subwords</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L194">aes_subword_fwd</a></span><span class="p">(</span><span class="n">prev</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w">   </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rnum</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mh">0xA</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">subwords</span><span class="w">
                            </span><span class="k">else</span><span class="w"> </span><span class="p">(</span><span class="n">subwords</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L86">aes_decode_rcon</a></span><span class="p">(</span><span class="n">rnum</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_aes64ks2">AES64KS2</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-b7d70aac4e41af9fc4cc2b65d12abe0d.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 12. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for AES64KS2 goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">AES64KS2</span><span class="p">(</span><span class="n">rs2</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">w0</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">63</span><span class="o">..</span><span class="mi">32</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">w1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">63</span><span class="o">..</span><span class="mi">32</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)[</span><span class="mi">63</span><span class="o">..</span><span class="mi">32</span><span class="p">];</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">w1</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">w0</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_amo">AMO</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-63397917b0e2cf06c0906c223a6874dc.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 13. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for AMO goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="nv">'width</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">width</span><span class="p">;</span><span class="w">

  </span><span class="c">// This is checked during decoding.</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">width</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">xlen_bytes</span><span class="p">);</span><span class="w">

  </span><span class="c">/* Get the address, X(rs1) (no offset).</span><span class="w">
</span><span class="c">    * Some extensions perform additional checks on address validity.</span><span class="w">
</span><span class="c">    */</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_addr_checks.html#L57">ext_data_get_addr</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">(),</span><span class="w"> </span><span class="n">ReadWrite</span><span class="p">(</span><span class="n">Data</span><span class="p">,</span><span class="w"> </span><span class="n">Data</span><span class="p">),</span><span class="w"> </span><span class="n">width</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ext_DataAddr_Error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Ext_DataAddr_Check_Failure</span><span class="p">(</span><span class="n">e</span><span class="p">),</span><span class="w">
    </span><span class="n">Ext_DataAddr_OK</span><span class="p">(</span><span class="n">vaddr</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n">is_aligned_addr</span><span class="p">(</span><span class="n">bits_of</span><span class="p">(</span><span class="n">vaddr</span><span class="p">),</span><span class="w"> </span><span class="n">width</span><span class="p">))</span><span class="w">
      </span><span class="k">then</span><span class="w"> </span><span class="n">Memory_Exception</span><span class="p">(</span><span class="n">vaddr</span><span class="p">,</span><span class="w"> </span><span class="n">E_SAMO_Addr_Align</span><span class="p">())</span><span class="w">
      </span><span class="k">else</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vmem.html#L356">translateAddr</a></span><span class="p">(</span><span class="n">vaddr</span><span class="p">,</span><span class="w"> </span><span class="n">ReadWrite</span><span class="p">(</span><span class="n">Data</span><span class="p">,</span><span class="w"> </span><span class="n">Data</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">Err</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="mi">_</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Memory_Exception</span><span class="p">(</span><span class="n">vaddr</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">),</span><span class="w">
        </span><span class="n">Ok</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="mi">_</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)[</span><span class="n">width</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">];</span><span class="w">
          </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_mem.html#L169">mem_write_ea</a></span><span class="p">(</span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">aq</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">rl</span><span class="p">,</span><span class="w"> </span><span class="n">rl</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="n">Err</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Memory_Exception</span><span class="p">(</span><span class="n">vaddr</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">),</span><span class="w">
            </span><span class="n">Ok</span><span class="p">(</span><span class="mi">_</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_mem.html#L165">mem_read</a></span><span class="p">(</span><span class="n">ReadWrite</span><span class="p">(</span><span class="n">Data</span><span class="p">,</span><span class="w"> </span><span class="n">Data</span><span class="p">),</span><span class="w"> </span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">aq</span><span class="p">,</span><span class="w"> </span><span class="n">aq</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">rl</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="n">Err</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Memory_Exception</span><span class="p">(</span><span class="n">vaddr</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">),</span><span class="w">
                </span><span class="n">Ok</span><span class="p">(</span><span class="n">loaded</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'width</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w">
                    </span><span class="k">match</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="p">{</span><span class="w">
                      </span><span class="n">AMOSWAP</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs2_val</span><span class="p">,</span><span class="w">
                      </span><span class="n">AMOADD</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">loaded</span><span class="p">,</span><span class="w">
                      </span><span class="n">AMOXOR</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">loaded</span><span class="p">,</span><span class="w">
                      </span><span class="n">AMOAND</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">loaded</span><span class="p">,</span><span class="w">
                      </span><span class="n">AMOOR</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">loaded</span><span class="p">,</span><span class="w">
                      </span><span class="n">AMOMIN</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="n">&lt;_s</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">loaded</span><span class="p">,</span><span class="w">
                      </span><span class="n">AMOMAX</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="n">&gt;_s</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">loaded</span><span class="p">,</span><span class="w">
                      </span><span class="n">AMOMINU</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="n">&lt;_u</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">loaded</span><span class="p">,</span><span class="w">
                      </span><span class="n">AMOMAXU</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="n">&gt;_u</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">loaded</span><span class="p">,</span><span class="w">
                    </span><span class="p">};</span><span class="w">
                  </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_mem.html#L241">mem_write_value</a></span><span class="p">(</span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">result</span><span class="p">),</span><span class="w"> </span><span class="n">aq</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">rl</span><span class="p">,</span><span class="w"> </span><span class="n">rl</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="n">Ok</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">loaded</span><span class="p">);</span><span class="w"> </span><span class="n">RETIRE_SUCCESS</span><span class="w"> </span><span class="p">},</span><span class="w">
                    </span><span class="n">Ok</span><span class="p">(</span><span class="nb">false</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_errors.html#L20">internal_error</a></span><span class="p">(</span><span class="mi">__</span><span class="n">FILE__</span><span class="p">,</span><span class="w"> </span><span class="mi">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="s">"AMO got false from mem_write_value"</span><span class="p">)</span><span class="w"> </span><span class="p">},</span><span class="w">
                    </span><span class="n">Err</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Memory_Exception</span><span class="p">(</span><span class="n">vaddr</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">),</span><span class="w">
                  </span><span class="p">}</span><span class="w">
                </span><span class="p">}</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_brev8">BREV8</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-400590dbbb91f344c69ccba18bc277de.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 14. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for BREV8 goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./arithmetic.html#L11">brev8</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_btype">BTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-ad110074633132dab8a0adc8521036f7.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 15. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for BTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">taken</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">BEQ</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">),</span><span class="w">
    </span><span class="n">BNE</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">),</span><span class="w">
    </span><span class="n">BLT</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="n">&lt;_s</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">),</span><span class="w">
    </span><span class="n">BGE</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="n">&gt;=_s</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">),</span><span class="w">
    </span><span class="n">BLTU</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="n">&lt;_u</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">),</span><span class="w">
    </span><span class="n">BGEU</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="n">&gt;=_u</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="n">taken</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_regs.html#L11">PC</a></span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">imm</span><span class="p">);</span><span class="w">
    </span><span class="c">/* Extensions get the first checks on the prospective target address. */</span><span class="w">
    </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_addr_checks.html#L44">ext_control_check_pc</a></span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">Ext_ControlAddr_Error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Ext_ControlAddr_Check_Failure</span><span class="p">(</span><span class="n">e</span><span class="p">),</span><span class="w">
      </span><span class="n">Ext_ControlAddr_OK</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="k">let</span><span class="w"> </span><span class="n">target_bits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">bits_of</span><span class="p">(</span><span class="n">target</span><span class="p">);</span><span class="w">
        </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L111">bit_to_bool</a></span><span class="p">(</span><span class="n">target_bits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n">currentlyEnabled</span><span class="p">(</span><span class="n">Ext_Zca</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="n">Memory_Exception</span><span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="n">E_Fetch_Addr_Align</span><span class="p">())</span><span class="w">
        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_pc_access.html#L24">set_next_pc</a></span><span class="p">(</span><span class="n">target_bits</span><span class="p">);</span><span class="w">
          </span><span class="n">RETIRE_SUCCESS</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_clmul">CLMUL</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-72747f7a18e6a355d78a40262ca462aa.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 16. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for CLMUL goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">prod</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./arithmetic.html#L20">carryless_mul</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">),</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">));</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">prod</span><span class="p">[</span><span class="n">xlen</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_clmulh">CLMULH</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-d36f72dd1f07969097325c41664e216d.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 17. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for CLMULH goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">prod</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./arithmetic.html#L20">carryless_mul</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">),</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">));</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">prod</span><span class="p">[</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xlen</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="n">xlen</span><span class="p">];</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_clmulr">CLMULR</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-588702c9a6a44912f96e1a6f9c0779d8.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 18. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for CLMULR goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./arithmetic.html#L31">carryless_mulr</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">),</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_clz">CLZ</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-beb901dde71d803857895b96035bdc9b.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 19. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for CLZ goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L118">to_bits</a></span><span class="p">(</span><span class="n">count_leading_zeros</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_clzw">CLZW</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-97a53f142d441d4d9afa8fd7cb887776.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 20. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for CLZW goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L118">to_bits</a></span><span class="p">(</span><span class="n">count_leading_zeros</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">]));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_cpop">CPOP</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-ba68777cfbb0a7f59b4e079b9fcf212e.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 21. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for CPOP goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L118">to_bits</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./arithmetic.html#L62">count_ones</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_cpopw">CPOPW</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-94ba9b55910ba65259c8bd57404d5160.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 22. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for CPOPW goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L118">to_bits</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./arithmetic.html#L62">count_ones</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">]));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_csrimm">CSRImm</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-1659db41d032c5aa13c2df80b0fda0d5.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 23. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for CSRImm goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zicsr.html#L31">doCSR</a></span><span class="p">(</span><span class="n">csr</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n">imm</span><span class="p">),</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">op</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">op</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">CSRRW</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="n">imm</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">()))</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_csrreg">CSRReg</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-a54ce2a38606056cc2758bbfe5fcfea6.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 24. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for CSRReg goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zicsr.html#L31">doCSR</a></span><span class="p">(</span><span class="n">csr</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">),</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">op</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">op</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">CSRRW</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="n">rs1</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">zreg</span><span class="p">))</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ctz">CTZ</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-832fadf5a73f300ff9c7d9d1a842d91a.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 25. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for CTZ goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L118">to_bits</a></span><span class="p">(</span><span class="n">count_trailing_zeros</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ctzw">CTZW</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-31bb748a202d20cd0cdf1453498fccef.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 26. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for CTZW goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L118">to_bits</a></span><span class="p">(</span><span class="n">count_trailing_zeros</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">]));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_div">DIV</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-1923e94d7e7bd8417ef108e9e5d5f9c3.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 27. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for DIV goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_bits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_bits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_unsigned</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_bits</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_bits</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_unsigned</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs2_bits</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs2_bits</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">quotient</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs2_int</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">quot_round_zero</span><span class="p">(</span><span class="n">rs1_int</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_int</span><span class="p">);</span><span class="w">
  </span><span class="c">// Check for signed overflow.</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">quotient</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n">is_unsigned</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">quotient</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">negate</span><span class="p">(</span><span class="n">2 ^</span><span class="w"> </span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">quotient</span><span class="p">;</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L131">to_bits_truncate</a></span><span class="p">(</span><span class="n">quotient</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_divw">DIVW</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-a6837b57c18f0995031bfc23a5227ec8.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 28. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for DIVW goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_bits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_bits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_unsigned</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_bits</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_bits</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_unsigned</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs2_bits</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs2_bits</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">quotient</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs2_int</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">quot_round_zero</span><span class="p">(</span><span class="n">rs1_int</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_int</span><span class="p">);</span><span class="w">
  </span><span class="c">// Check for signed overflow.</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">quotient</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n">is_unsigned</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">quotient</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="mi">31</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">negate</span><span class="p">(</span><span class="n">2 ^</span><span class="w"> </span><span class="mi">31</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">quotient</span><span class="p">;</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L131">to_bits_truncate</a></span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="w"> </span><span class="n">quotient</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ebreak">EBREAK</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-f640fd5da67324dd1a0f44673e3c8cc7.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 29. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for EBREAK goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="n">Memory_Exception</span><span class="p">(</span><span class="n">Virtaddr</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_regs.html#L11">PC</a></span><span class="p">),</span><span class="w"> </span><span class="n">E_Breakpoint</span><span class="p">())</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ecall">ECALL</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-52a01bb9322e6b5dc647160269b4ecd0.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 30. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ECALL goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">sync_exception</span><span class="w"> </span><span class="p">=</span><span class="w">
    </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">trap</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L13">cur_privilege</a></span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                      </span><span class="n">User</span><span class="w">       </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">E_U_EnvCall</span><span class="p">(),</span><span class="w">
                      </span><span class="n">Supervisor</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">E_S_EnvCall</span><span class="p">(),</span><span class="w">
                      </span><span class="n">Machine</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">E_M_EnvCall</span><span class="p">()</span><span class="w">
                    </span><span class="p">},</span><span class="w">
             </span><span class="n">excinfo</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">option</span><span class="p">(</span><span class="n">xlenbits</span><span class="p">)),</span><span class="w">
             </span><span class="n">ext</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">};</span><span class="w">
  </span><span class="n">Trap</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L13">cur_privilege</a></span><span class="p">,</span><span class="w"> </span><span class="n">CTL_TRAP</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_regs.html#L11">PC</a></span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_f_type_d">F.BIN.F.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-6c5a03331686da725d7494444d4f0474.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 31. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.F.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">e1</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L37">fsplit_D</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">e2</span><span class="p">,</span><span class="w"> </span><span class="n">m2</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L37">fsplit_D</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs2_val_D</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_D</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L40">fmake_D</a></span><span class="w"> </span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">e1</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">);</span><span class="w">

  </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_f_type_d_2">F.BIN.F.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-6c5a03331686da725d7494444d4f0474.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 32. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.F.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">e1</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L37">fsplit_D</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">e2</span><span class="p">,</span><span class="w"> </span><span class="n">m2</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L37">fsplit_D</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs2_val_D</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_D</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L40">fmake_D</a></span><span class="w"> </span><span class="p">(</span><span class="mb">0b1</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">e1</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">);</span><span class="w">

  </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_f_type_d_3">F.BIN.F.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-6c5a03331686da725d7494444d4f0474.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 33. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.F.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">e1</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L37">fsplit_D</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">e2</span><span class="p">,</span><span class="w"> </span><span class="n">m2</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L37">fsplit_D</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs2_val_D</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_D</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L40">fmake_D</a></span><span class="w"> </span><span class="p">(</span><span class="n">s1</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">e1</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">);</span><span class="w">

  </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_f_type_d_4">F.BIN.F.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-6c5a03331686da725d7494444d4f0474.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 34. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.F.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">is_quiet</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">rs1_lt_rs2</span><span class="p">,</span><span class="w"> </span><span class="n">fflags</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L191">fle_D</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="p">,</span><span class="w"> </span><span class="n">is_quiet</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_D</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w">      </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L125">f_is_NaN_D</a></span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L125">f_is_NaN_D</a></span><span class="p">(</span><span class="n">rs2_val_D</span><span class="p">))</span><span class="w">           </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L34">canonical_NaN_D</a></span><span class="p">()</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L125">f_is_NaN_D</a></span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">)</span><span class="w">                                     </span><span class="k">then</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L125">f_is_NaN_D</a></span><span class="p">(</span><span class="n">rs2_val_D</span><span class="p">)</span><span class="w">                                     </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L69">f_is_neg_zero_D</a></span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L77">f_is_pos_zero_D</a></span><span class="p">(</span><span class="n">rs2_val_D</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L69">f_is_neg_zero_D</a></span><span class="p">(</span><span class="n">rs2_val_D</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L77">f_is_pos_zero_D</a></span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs1_lt_rs2</span><span class="w">                                                </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="c">/* (not rs1_lt_rs2) */</span><span class="w">                                            </span><span class="n">rs2_val_D</span><span class="p">;</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_f_type_d_5">F.BIN.F.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-6c5a03331686da725d7494444d4f0474.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 35. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.F.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">is_quiet</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">rs2_lt_rs1</span><span class="p">,</span><span class="w"> </span><span class="n">fflags</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L191">fle_D</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs2_val_D</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="p">,</span><span class="w"> </span><span class="n">is_quiet</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_D</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w">      </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L125">f_is_NaN_D</a></span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L125">f_is_NaN_D</a></span><span class="p">(</span><span class="n">rs2_val_D</span><span class="p">))</span><span class="w">           </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L34">canonical_NaN_D</a></span><span class="p">()</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L125">f_is_NaN_D</a></span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">)</span><span class="w">                                     </span><span class="k">then</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L125">f_is_NaN_D</a></span><span class="p">(</span><span class="n">rs2_val_D</span><span class="p">)</span><span class="w">                                     </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L69">f_is_neg_zero_D</a></span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L77">f_is_pos_zero_D</a></span><span class="p">(</span><span class="n">rs2_val_D</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L69">f_is_neg_zero_D</a></span><span class="p">(</span><span class="n">rs2_val_D</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L77">f_is_pos_zero_D</a></span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs2_lt_rs1</span><span class="w">                                                </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="c">/* (not rs2_lt_rs1) */</span><span class="w">                                            </span><span class="n">rs2_val_D</span><span class="p">;</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_f_type_h">F.BIN.F.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-9af3702d32c1574e8c3e3da08b465ade.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 36. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.F.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">e1</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L32">fsplit_H</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">e2</span><span class="p">,</span><span class="w"> </span><span class="n">m2</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L32">fsplit_H</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs2_val_H</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_H</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L35">fmake_H</a></span><span class="w"> </span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">e1</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">);</span><span class="w">

  </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_f_type_h_2">F.BIN.F.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-9af3702d32c1574e8c3e3da08b465ade.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 37. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.F.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">e1</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L32">fsplit_H</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">e2</span><span class="p">,</span><span class="w"> </span><span class="n">m2</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L32">fsplit_H</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs2_val_H</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_H</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L35">fmake_H</a></span><span class="w"> </span><span class="p">(</span><span class="mb">0b1</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">e1</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">);</span><span class="w">

  </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_f_type_h_3">F.BIN.F.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-9af3702d32c1574e8c3e3da08b465ade.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 38. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.F.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">e1</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L32">fsplit_H</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">e2</span><span class="p">,</span><span class="w"> </span><span class="n">m2</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L32">fsplit_H</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs2_val_H</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_H</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L35">fmake_H</a></span><span class="w"> </span><span class="p">(</span><span class="n">s1</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">e1</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">);</span><span class="w">

  </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_f_type_h_4">F.BIN.F.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-9af3702d32c1574e8c3e3da08b465ade.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 39. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.F.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">is_quiet</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">rs1_lt_rs2</span><span class="p">,</span><span class="w"> </span><span class="n">fflags</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L132">fle_H</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="p">,</span><span class="w"> </span><span class="n">is_quiet</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_H</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w">      </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L125">f_is_NaN_H</a></span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L125">f_is_NaN_H</a></span><span class="p">(</span><span class="n">rs2_val_H</span><span class="p">))</span><span class="w">           </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L32">canonical_NaN_H</a></span><span class="p">()</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L125">f_is_NaN_H</a></span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">)</span><span class="w">                                     </span><span class="k">then</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L125">f_is_NaN_H</a></span><span class="p">(</span><span class="n">rs2_val_H</span><span class="p">)</span><span class="w">                                     </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L93">f_is_neg_zero_H</a></span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L101">f_is_pos_zero_H</a></span><span class="p">(</span><span class="n">rs2_val_H</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L93">f_is_neg_zero_H</a></span><span class="p">(</span><span class="n">rs2_val_H</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L101">f_is_pos_zero_H</a></span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs1_lt_rs2</span><span class="w">                                                </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="c">/* (not rs1_lt_rs2) */</span><span class="w">                                            </span><span class="n">rs2_val_H</span><span class="p">;</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_f_type_h_5">F.BIN.F.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-9af3702d32c1574e8c3e3da08b465ade.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 40. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.F.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">is_quiet</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">rs2_lt_rs1</span><span class="p">,</span><span class="w"> </span><span class="n">fflags</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L132">fle_H</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs2_val_H</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="p">,</span><span class="w"> </span><span class="n">is_quiet</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_H</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w">      </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L125">f_is_NaN_H</a></span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L125">f_is_NaN_H</a></span><span class="p">(</span><span class="n">rs2_val_H</span><span class="p">))</span><span class="w">           </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L32">canonical_NaN_H</a></span><span class="p">()</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L125">f_is_NaN_H</a></span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">)</span><span class="w">                                     </span><span class="k">then</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L125">f_is_NaN_H</a></span><span class="p">(</span><span class="n">rs2_val_H</span><span class="p">)</span><span class="w">                                     </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L93">f_is_neg_zero_H</a></span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L101">f_is_pos_zero_H</a></span><span class="p">(</span><span class="n">rs2_val_H</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L93">f_is_neg_zero_H</a></span><span class="p">(</span><span class="n">rs2_val_H</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L101">f_is_pos_zero_H</a></span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs2_lt_rs1</span><span class="w">                                                </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="c">/* (not rs2_lt_rs1) */</span><span class="w">                                            </span><span class="n">rs2_val_H</span><span class="p">;</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_rm_type_d">F.BIN.RM.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-5733418a2c12f67304211a309b1897a6.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 41. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.RM.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_64b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_64b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_64b</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">64</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">FADD_D</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L108">riscv_f64Add</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_64b</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_64b</span><span class="p">),</span><span class="w">
        </span><span class="n">FSUB_D</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L115">riscv_f64Sub</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_64b</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_64b</span><span class="p">),</span><span class="w">
        </span><span class="n">FMUL_D</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L122">riscv_f64Mul</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_64b</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_64b</span><span class="p">),</span><span class="w">
        </span><span class="n">FDIV_D</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L129">riscv_f64Div</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_64b</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_64b</span><span class="p">)</span><span class="w">
      </span><span class="p">};</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_64b</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_rm_type_h">F.BIN.RM.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-9ed23ff6132de11c58f30074a7b92455.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 42. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.RM.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_16b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_16b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_16b</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">FADD_H</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L52">riscv_f16Add</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_16b</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_16b</span><span class="p">),</span><span class="w">
        </span><span class="n">FSUB_H</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L59">riscv_f16Sub</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_16b</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_16b</span><span class="p">),</span><span class="w">
        </span><span class="n">FMUL_H</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L66">riscv_f16Mul</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_16b</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_16b</span><span class="p">),</span><span class="w">
        </span><span class="n">FDIV_H</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L73">riscv_f16Div</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_16b</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_16b</span><span class="p">)</span><span class="w">
      </span><span class="p">};</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_16b</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_rm_type_s">F.BIN.RM.TYPE.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-e5e58a66a3104c09bc532cce02c89efa.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 43. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.RM.TYPE.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_32b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_32b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_32b</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">FADD_S</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L80">riscv_f32Add</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_32b</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_32b</span><span class="p">),</span><span class="w">
        </span><span class="n">FSUB_S</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L87">riscv_f32Sub</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_32b</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_32b</span><span class="p">),</span><span class="w">
        </span><span class="n">FMUL_S</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L94">riscv_f32Mul</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_32b</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_32b</span><span class="p">),</span><span class="w">
        </span><span class="n">FDIV_S</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L101">riscv_f32Div</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_32b</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_32b</span><span class="p">)</span><span class="w">
      </span><span class="p">};</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_32b</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_type_f_s">F.BIN.TYPE.F.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-0567d0e46266255a4172b764dac1ade1.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 44. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.TYPE.F.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">e1</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L76">fsplit_S</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">e2</span><span class="p">,</span><span class="w"> </span><span class="n">m2</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L76">fsplit_S</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs2_val_S</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_S</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L79">fmake_S</a></span><span class="w"> </span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">e1</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">);</span><span class="w">

  </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_type_f_s_2">F.BIN.TYPE.F.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-0567d0e46266255a4172b764dac1ade1.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 45. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.TYPE.F.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">e1</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L76">fsplit_S</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">e2</span><span class="p">,</span><span class="w"> </span><span class="n">m2</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L76">fsplit_S</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs2_val_S</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_S</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L79">fmake_S</a></span><span class="w"> </span><span class="p">(</span><span class="mb">0b1</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">e1</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">);</span><span class="w">

  </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_type_f_s_3">F.BIN.TYPE.F.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-0567d0e46266255a4172b764dac1ade1.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 46. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.TYPE.F.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">e1</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L76">fsplit_S</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">e2</span><span class="p">,</span><span class="w"> </span><span class="n">m2</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L76">fsplit_S</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs2_val_S</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_S</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L79">fmake_S</a></span><span class="w"> </span><span class="p">(</span><span class="n">s1</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">e1</span><span class="p">,</span><span class="w"> </span><span class="n">m1</span><span class="p">);</span><span class="w">

  </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_type_f_s_4">F.BIN.TYPE.F.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-0567d0e46266255a4172b764dac1ade1.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 47. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.TYPE.F.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">is_quiet</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">rs1_lt_rs2</span><span class="p">,</span><span class="w"> </span><span class="n">fflags</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L229">fle_S</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="p">,</span><span class="w"> </span><span class="n">is_quiet</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_S</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w">      </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L164">f_is_NaN_S</a></span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L164">f_is_NaN_S</a></span><span class="p">(</span><span class="n">rs2_val_S</span><span class="p">))</span><span class="w">           </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L33">canonical_NaN_S</a></span><span class="p">()</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L164">f_is_NaN_S</a></span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">)</span><span class="w">                                     </span><span class="k">then</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L164">f_is_NaN_S</a></span><span class="p">(</span><span class="n">rs2_val_S</span><span class="p">)</span><span class="w">                                     </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L108">f_is_neg_zero_S</a></span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L116">f_is_pos_zero_S</a></span><span class="p">(</span><span class="n">rs2_val_S</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L108">f_is_neg_zero_S</a></span><span class="p">(</span><span class="n">rs2_val_S</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L116">f_is_pos_zero_S</a></span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs1_lt_rs2</span><span class="w">                                                </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="c">/* (not rs1_lt_rs2) */</span><span class="w">                                            </span><span class="n">rs2_val_S</span><span class="p">;</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_type_f_s_5">F.BIN.TYPE.F.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-0567d0e46266255a4172b764dac1ade1.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 48. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.TYPE.F.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">is_quiet</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">rs2_lt_rs1</span><span class="p">,</span><span class="w"> </span><span class="n">fflags</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L229">fle_S</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs2_val_S</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="p">,</span><span class="w"> </span><span class="n">is_quiet</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_S</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w">      </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L164">f_is_NaN_S</a></span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L164">f_is_NaN_S</a></span><span class="p">(</span><span class="n">rs2_val_S</span><span class="p">))</span><span class="w">           </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L33">canonical_NaN_S</a></span><span class="p">()</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L164">f_is_NaN_S</a></span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">)</span><span class="w">                                     </span><span class="k">then</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L164">f_is_NaN_S</a></span><span class="p">(</span><span class="n">rs2_val_S</span><span class="p">)</span><span class="w">                                     </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L108">f_is_neg_zero_S</a></span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L116">f_is_pos_zero_S</a></span><span class="p">(</span><span class="n">rs2_val_S</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L108">f_is_neg_zero_S</a></span><span class="p">(</span><span class="n">rs2_val_S</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L116">f_is_pos_zero_S</a></span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs2_lt_rs1</span><span class="w">                                                </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="c">/* (not rs2_lt_rs1) */</span><span class="w">                                            </span><span class="n">rs2_val_S</span><span class="p">;</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_type_x_s">F.BIN.TYPE.X.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-b29cad3b57ef7303b72588456139769c.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 49. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.TYPE.X.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L464">riscv_f32Eq</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="p">);</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L112">bool_to_bits</a></span><span class="p">(</span><span class="n">rd_val</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_type_x_s_2">F.BIN.TYPE.X.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-b29cad3b57ef7303b72588456139769c.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 50. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.TYPE.X.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L436">riscv_f32Lt</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="p">);</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L112">bool_to_bits</a></span><span class="p">(</span><span class="n">rd_val</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_type_x_s_3">F.BIN.TYPE.X.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-b29cad3b57ef7303b72588456139769c.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 51. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.TYPE.X.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L450">riscv_f32Le</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="p">);</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L112">bool_to_bits</a></span><span class="p">(</span><span class="n">rd_val</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_x_type_d">F.BIN.X.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-b5ca8d97b3a86b9b3235bca2f2029f16.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 52. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.X.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L499">riscv_f64Eq</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="p">);</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L112">bool_to_bits</a></span><span class="p">(</span><span class="n">rd_val</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_x_type_d_2">F.BIN.X.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-b5ca8d97b3a86b9b3235bca2f2029f16.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 53. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.X.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L471">riscv_f64Lt</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="p">);</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L112">bool_to_bits</a></span><span class="p">(</span><span class="n">rd_val</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_x_type_d_3">F.BIN.X.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-b5ca8d97b3a86b9b3235bca2f2029f16.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 54. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.X.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L485">riscv_f64Le</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="p">);</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L112">bool_to_bits</a></span><span class="p">(</span><span class="n">rd_val</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_x_type_h">F.BIN.X.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-46e7935e3fb3adb1845c537e8e115e2f.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 55. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.X.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L429">riscv_f16Eq</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="p">);</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L112">bool_to_bits</a></span><span class="p">(</span><span class="n">rd_val</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_x_type_h_2">F.BIN.X.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-46e7935e3fb3adb1845c537e8e115e2f.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 56. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.X.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L401">riscv_f16Lt</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="p">);</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L112">bool_to_bits</a></span><span class="p">(</span><span class="n">rd_val</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_bin_x_type_h_3">F.BIN.X.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-46e7935e3fb3adb1845c537e8e115e2f.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 57. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.BIN.X.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L415">riscv_f16Le</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="p">);</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L112">bool_to_bits</a></span><span class="p">(</span><span class="n">rd_val</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_madd_type_d">F.MADD.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-81212968dbaa599851d5802d4cb95e0a.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 58. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.MADD.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_64b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_64b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs3_val_64b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs3</span><span class="p">);</span><span class="w">

  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_64b</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">64</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w">
        </span><span class="k">match</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="n">FMADD_D</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L153">riscv_f64MulAdd</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_64b</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_64b</span><span class="p">,</span><span class="w"> </span><span class="n">rs3_val_64b</span><span class="p">),</span><span class="w">
          </span><span class="n">FMSUB_D</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L153">riscv_f64MulAdd</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_64b</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_64b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L136">negate_D</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs3_val_64b</span><span class="p">)),</span><span class="w">
          </span><span class="n">FNMSUB_D</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L153">riscv_f64MulAdd</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L136">negate_D</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_64b</span><span class="p">),</span><span class="w"> </span><span class="n">rs2_val_64b</span><span class="p">,</span><span class="w"> </span><span class="n">rs3_val_64b</span><span class="p">),</span><span class="w">
          </span><span class="n">FNMADD_D</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L153">riscv_f64MulAdd</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L136">negate_D</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_64b</span><span class="p">),</span><span class="w"> </span><span class="n">rs2_val_64b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L136">negate_D</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs3_val_64b</span><span class="p">))</span><span class="w">
        </span><span class="p">};</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_64b</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_madd_type_h">F.MADD.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-d8c55ab03e975b7c0de531bc35b182cc.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 59. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.MADD.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_16b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_16b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs3_val_16b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs3</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_16b</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w">
        </span><span class="k">match</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="n">FMADD_H</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L139">riscv_f16MulAdd</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_16b</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_16b</span><span class="p">,</span><span class="w"> </span><span class="n">rs3_val_16b</span><span class="p">),</span><span class="w">
          </span><span class="n">FMSUB_H</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L139">riscv_f16MulAdd</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_16b</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_16b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L38">negate_H</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs3_val_16b</span><span class="p">)),</span><span class="w">
          </span><span class="n">FNMSUB_H</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L139">riscv_f16MulAdd</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L38">negate_H</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_16b</span><span class="p">),</span><span class="w"> </span><span class="n">rs2_val_16b</span><span class="p">,</span><span class="w"> </span><span class="n">rs3_val_16b</span><span class="p">),</span><span class="w">
          </span><span class="n">FNMADD_H</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L139">riscv_f16MulAdd</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L38">negate_H</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_16b</span><span class="p">),</span><span class="w"> </span><span class="n">rs2_val_16b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L38">negate_H</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs3_val_16b</span><span class="p">))</span><span class="w">
        </span><span class="p">};</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_16b</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_madd_type_s">F.MADD.TYPE.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-b0790bda8e6dd9fa96a2793c53654aca.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 60. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.MADD.TYPE.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_32b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_32b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs3_val_32b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs3</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_32b</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w">
        </span><span class="k">match</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="n">FMADD_S</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L146">riscv_f32MulAdd</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_32b</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_32b</span><span class="p">,</span><span class="w"> </span><span class="n">rs3_val_32b</span><span class="p">),</span><span class="w">
          </span><span class="n">FMSUB_S</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L146">riscv_f32MulAdd</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_32b</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_32b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L174">negate_S</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs3_val_32b</span><span class="p">)),</span><span class="w">
          </span><span class="n">FNMSUB_S</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L146">riscv_f32MulAdd</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L174">negate_S</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_32b</span><span class="p">),</span><span class="w"> </span><span class="n">rs2_val_32b</span><span class="p">,</span><span class="w"> </span><span class="n">rs3_val_32b</span><span class="p">),</span><span class="w">
          </span><span class="n">FNMADD_S</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L146">riscv_f32MulAdd</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L174">negate_S</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_32b</span><span class="p">),</span><span class="w"> </span><span class="n">rs2_val_32b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L174">negate_S</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs3_val_32b</span><span class="p">))</span><span class="w">
        </span><span class="p">};</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_32b</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_f_type_d">F.UN.F.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-02597f8f7c2822ff27e8c634139aeb84.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 61. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.F.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">F_UN_F_TYPE_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">FMV_D_X</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">64</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">flen</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="n">F</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L40">nan_box</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">63</span><span class="o">..</span><span class="mi">0</span><span class="p">]);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_f_type_h">F.UN.F.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-c61c34928851b417ef04af8ce8736691.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 62. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.F.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_X</span><span class="w">            </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_H</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n">rs1_val_X</span><span class="w"> </span><span class="p">[</span><span class="mi">15</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="n">F</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L40">nan_box</a></span><span class="w"> </span><span class="p">(</span><span class="n">rd_val_H</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_ff_type_d">F.UN.RM.FF.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-242b6c693d37a1c19e2b1f3b134ddc88.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 63. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.FF.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L177">riscv_f64Sqrt</a></span><span class="w">   </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_ff_type_d_2">F.UN.RM.FF.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-242b6c693d37a1c19e2b1f3b134ddc88.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 64. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.FF.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L391">riscv_f64ToF32</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_ff_type_d_3">F.UN.RM.FF.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-242b6c693d37a1c19e2b1f3b134ddc88.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 65. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.FF.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L370">riscv_f32ToF64</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_ff_type_h">F.UN.RM.FF.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-8f6d2686464fa461d3bbc3ca0283e90e.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 66. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.FF.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L163">riscv_f16Sqrt</a></span><span class="w">   </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_ff_type_h_2">F.UN.RM.FF.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-8f6d2686464fa461d3bbc3ca0283e90e.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 67. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.FF.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L377">riscv_f32ToF16</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_ff_type_h_3">F.UN.RM.FF.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-8f6d2686464fa461d3bbc3ca0283e90e.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 68. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.FF.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L384">riscv_f64ToF16</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_ff_type_h_4">F.UN.RM.FF.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-8f6d2686464fa461d3bbc3ca0283e90e.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 69. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.FF.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L356">riscv_f16ToF32</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_ff_type_h_5">F.UN.RM.FF.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-8f6d2686464fa461d3bbc3ca0283e90e.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 70. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.FF.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L363">riscv_f16ToF64</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_ff_type_s">F.UN.RM.FF.TYPE.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-23d55fe554797057bf0ad70533af477a.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 71. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.FF.TYPE.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L170">riscv_f32Sqrt</a></span><span class="w">   </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_fx_type_d">F.UN.RM.FX.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-5d6d9c2ab99659318b6229c066853ad9.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 72. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.FX.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_W</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L300">riscv_f64ToI32</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="w"> </span><span class="p">(</span><span class="n">rd_val_W</span><span class="p">);</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_fx_type_d_2">F.UN.RM.FX.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-5d6d9c2ab99659318b6229c066853ad9.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 73. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.FX.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_WU</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L307">riscv_f64ToUi32</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="w"> </span><span class="p">(</span><span class="n">rd_val_WU</span><span class="p">);</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_fx_type_d_3">F.UN.RM.FX.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-5d6d9c2ab99659318b6229c066853ad9.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 74. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.FX.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">F_UN_RM_FX_TYPE_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rm</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">FCVT_L_D</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_L</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L328">riscv_f64ToI64</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">rd_val_L</span><span class="p">);</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_fx_type_d_4">F.UN.RM.FX.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-5d6d9c2ab99659318b6229c066853ad9.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 75. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.FX.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">F_UN_RM_FX_TYPE_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rm</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">FCVT_LU_D</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_LU</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L335">riscv_f64ToUi64</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">rd_val_LU</span><span class="p">);</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_fx_type_h">F.UN.RM.FX.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-82ac377f7593049bd679cb8b5f31099d.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 76. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.FX.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_W</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L187">riscv_f16ToI32</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="w"> </span><span class="p">(</span><span class="n">rd_val_W</span><span class="p">);</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_fx_type_h_2">F.UN.RM.FX.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-82ac377f7593049bd679cb8b5f31099d.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 77. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.FX.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_WU</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L194">riscv_f16ToUi32</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="w"> </span><span class="p">(</span><span class="n">rd_val_WU</span><span class="p">);</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_fx_type_h_3">F.UN.RM.FX.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-82ac377f7593049bd679cb8b5f31099d.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 78. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.FX.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">F_UN_RM_FX_TYPE_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rm</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">FCVT_L_H</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_L</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L215">riscv_f16ToI64</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">rd_val_L</span><span class="p">);</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_fx_type_h_4">F.UN.RM.FX.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-82ac377f7593049bd679cb8b5f31099d.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 79. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.FX.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">F_UN_RM_FX_TYPE_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rm</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">FCVT_LU_H</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_LU</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L222">riscv_f16ToUi64</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">rd_val_LU</span><span class="p">);</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_fx_type_s">F.UN.RM.FX.TYPE.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-fdcc1a35e51ae9239e700118cc901796.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 80. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.FX.TYPE.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_W</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L244">riscv_f32ToI32</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="w"> </span><span class="p">(</span><span class="n">rd_val_W</span><span class="p">);</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_fx_type_s_2">F.UN.RM.FX.TYPE.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-fdcc1a35e51ae9239e700118cc901796.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 81. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.FX.TYPE.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_WU</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L251">riscv_f32ToUi32</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="w"> </span><span class="p">(</span><span class="n">rd_val_WU</span><span class="p">);</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_fx_type_s_3">F.UN.RM.FX.TYPE.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-fdcc1a35e51ae9239e700118cc901796.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 82. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.FX.TYPE.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">F_UN_RM_FX_TYPE_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rm</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">FCVT_L_S</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_L</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L272">riscv_f32ToI64</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">rd_val_L</span><span class="p">);</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_fx_type_s_4">F.UN.RM.FX.TYPE.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-fdcc1a35e51ae9239e700118cc901796.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 83. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.FX.TYPE.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">F_UN_RM_FX_TYPE_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rm</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">FCVT_LU_S</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_LU</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L279">riscv_f32ToUi64</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">rd_val_LU</span><span class="p">);</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_xf_type_d">F.UN.RM.XF.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-016d509828df09a11bbc3e58f010c06a.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 84. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.XF.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_W</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L314">riscv_i32ToF64</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_W</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_xf_type_d_2">F.UN.RM.XF.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-016d509828df09a11bbc3e58f010c06a.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 85. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.XF.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_WU</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L321">riscv_ui32ToF64</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_WU</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_xf_type_d_3">F.UN.RM.XF.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-016d509828df09a11bbc3e58f010c06a.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 86. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.XF.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">F_UN_RM_XF_TYPE_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rm</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">FCVT_D_L</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_L</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">63</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L342">riscv_i64ToF64</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_L</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_xf_type_d_4">F.UN.RM.XF.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-016d509828df09a11bbc3e58f010c06a.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 87. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.XF.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">F_UN_RM_XF_TYPE_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rm</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">FCVT_D_LU</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_LU</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">63</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L349">riscv_ui64ToF64</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_LU</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_xf_type_h">F.UN.RM.XF.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-350028e64166f76b4c1f8eab1a538fdb.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 88. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.XF.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_W</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L201">riscv_i32ToF16</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_W</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_xf_type_h_2">F.UN.RM.XF.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-350028e64166f76b4c1f8eab1a538fdb.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 89. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.XF.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_WU</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L208">riscv_ui32ToF16</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_WU</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_xf_type_h_3">F.UN.RM.XF.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-350028e64166f76b4c1f8eab1a538fdb.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 90. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.XF.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">F_UN_RM_XF_TYPE_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rm</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">FCVT_H_L</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_L</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">63</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L229">riscv_i64ToF16</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_L</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_xf_type_h_4">F.UN.RM.XF.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-350028e64166f76b4c1f8eab1a538fdb.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 91. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.XF.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">F_UN_RM_XF_TYPE_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rm</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">FCVT_H_LU</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_LU</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">63</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L236">riscv_ui64ToF16</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_LU</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_xf_type_s">F.UN.RM.XF.TYPE.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-1213fdcf8c81cab183ac462840f1264f.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 92. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.XF.TYPE.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_W</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L258">riscv_i32ToF32</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_W</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_xf_type_s_2">F.UN.RM.XF.TYPE.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-1213fdcf8c81cab183ac462840f1264f.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 93. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.XF.TYPE.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_WU</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L265">riscv_ui32ToF32</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_WU</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_xf_type_s_3">F.UN.RM.XF.TYPE.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-1213fdcf8c81cab183ac462840f1264f.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 94. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.XF.TYPE.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">F_UN_RM_XF_TYPE_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rm</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">FCVT_S_L</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_L</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">63</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L286">riscv_i64ToF32</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_L</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_rm_xf_type_s_4">F.UN.RM.XF.TYPE.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-1213fdcf8c81cab183ac462840f1264f.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 95. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.RM.XF.TYPE.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">F_UN_RM_XF_TYPE_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rm</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">FCVT_S_LU</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_LU</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">63</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L293">riscv_ui64ToF32</a></span><span class="w"> </span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_LU</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_type_f_s">F.UN.TYPE.F.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-0504e2a8bd8eedb78e2d07765b68be32.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 96. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.TYPE.F.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">F</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L40">nan_box</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">]);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_type_x_s">F.UN.TYPE.X.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-d3f9be16a61a20d17c4f7f110887ab10.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 97. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.TYPE.X.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_10b</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w">
    </span><span class="k">if</span><span class="w">      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L84">f_is_neg_inf_S</a></span><span class="w">     </span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_0000_0001</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L92">f_is_neg_norm_S</a></span><span class="w">    </span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_0000_0010</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L100">f_is_neg_subnorm_S</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_0000_0100</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L108">f_is_neg_zero_S</a></span><span class="w">    </span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_0000_1000</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L116">f_is_pos_zero_S</a></span><span class="w">    </span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_0001_0000</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L124">f_is_pos_subnorm_S</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_0010_0000</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L132">f_is_pos_norm_S</a></span><span class="w">    </span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_0100_0000</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L140">f_is_pos_inf_S</a></span><span class="w">     </span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_1000_0000</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L148">f_is_SNaN_S</a></span><span class="w">        </span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_01_0000_0000</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L156">f_is_QNaN_S</a></span><span class="w">        </span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_10_0000_0000</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">();</span><span class="w">

  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="w"> </span><span class="p">(</span><span class="n">rd_val_10b</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_type_x_s_2">F.UN.TYPE.X.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-d3f9be16a61a20d17c4f7f110887ab10.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 98. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.TYPE.X.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">]);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_x_type_d">F.UN.X.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-5691cbf1202c2241a6e345c8251a543d.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 99. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.X.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_10b</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w">
    </span><span class="k">if</span><span class="w">      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L45">f_is_neg_inf_D</a></span><span class="w">     </span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_0000_0001</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L53">f_is_neg_norm_D</a></span><span class="w">    </span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_0000_0010</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L61">f_is_neg_subnorm_D</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_0000_0100</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L69">f_is_neg_zero_D</a></span><span class="w">    </span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_0000_1000</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L77">f_is_pos_zero_D</a></span><span class="w">    </span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_0001_0000</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L85">f_is_pos_subnorm_D</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_0010_0000</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L93">f_is_pos_norm_D</a></span><span class="w">    </span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_0100_0000</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L101">f_is_pos_inf_D</a></span><span class="w">     </span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_1000_0000</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L109">f_is_SNaN_D</a></span><span class="w">        </span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_01_0000_0000</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L117">f_is_QNaN_D</a></span><span class="w">        </span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_10_0000_0000</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">();</span><span class="w">

  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="w"> </span><span class="p">(</span><span class="n">rd_val_10b</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_x_type_d_2">F.UN.X.TYPE.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-5691cbf1202c2241a6e345c8251a543d.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 100. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.X.TYPE.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">F_UN_X_TYPE_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">FMV_X_D</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">64</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">flen</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">63</span><span class="o">..</span><span class="mi">0</span><span class="p">]);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_x_type_h">F.UN.X.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-aebb721fe3682ee89eb92c6f75a07f46.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 101. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.X.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_or_X_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_10b</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w">
    </span><span class="k">if</span><span class="w">      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L45">f_is_neg_inf_H</a></span><span class="w">     </span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_0000_0001</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L53">f_is_neg_norm_H</a></span><span class="w">    </span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_0000_0010</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L61">f_is_neg_subnorm_H</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_0000_0100</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L93">f_is_neg_zero_H</a></span><span class="w">    </span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_0000_1000</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L101">f_is_pos_zero_H</a></span><span class="w">    </span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_0001_0000</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L69">f_is_pos_subnorm_H</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_0010_0000</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L77">f_is_pos_norm_H</a></span><span class="w">    </span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_0100_0000</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L85">f_is_pos_inf_H</a></span><span class="w">     </span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_00_1000_0000</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L109">f_is_SNaN_H</a></span><span class="w">        </span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_01_0000_0000</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L117">f_is_QNaN_H</a></span><span class="w">        </span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mb">0b_10_0000_0000</span><span class="w">
    </span><span class="k">else</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">();</span><span class="w">

  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="w"> </span><span class="p">(</span><span class="n">rd_val_10b</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_un_x_type_h_2">F.UN.X.TYPE.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-aebb721fe3682ee89eb92c6f75a07f46.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 102. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for F.UN.X.TYPE.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w">            </span><span class="p">=</span><span class="w"> </span><span class="n">F</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">15</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_X</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_X</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fcvtmod_w_d">FCVTMOD.W.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-5ff19b4ce25596ad349612af96879399.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 103. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FCVTMOD.W.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfa.html#L726">fcvtmod_helper</a></span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">rd_val</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fence">FENCE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-a804da82267a94ae42536d2f26126924.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 104. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FENCE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">fiom</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L433">is_fiom_active</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">pred</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_base.html#L437">effective_fence_set</a></span><span class="p">(</span><span class="n">pred</span><span class="p">,</span><span class="w"> </span><span class="n">fiom</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">succ</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_base.html#L437">effective_fence_set</a></span><span class="p">(</span><span class="n">succ</span><span class="p">,</span><span class="w"> </span><span class="n">fiom</span><span class="p">);</span><span class="w">

  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n">pred</span><span class="p">,</span><span class="w"> </span><span class="n">succ</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="p">(</span><span class="mi">_</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b11</span><span class="p">,</span><span class="w"> </span><span class="mi">_</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b11</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sail_barrier</span><span class="p">(</span><span class="n">Barrier_RISCV_rw_rw</span><span class="p">),</span><span class="w">
    </span><span class="p">(</span><span class="mi">_</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b10</span><span class="p">,</span><span class="w"> </span><span class="mi">_</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b11</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sail_barrier</span><span class="p">(</span><span class="n">Barrier_RISCV_r_rw</span><span class="p">),</span><span class="w">
    </span><span class="p">(</span><span class="mi">_</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b10</span><span class="p">,</span><span class="w"> </span><span class="mi">_</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b10</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sail_barrier</span><span class="p">(</span><span class="n">Barrier_RISCV_r_r</span><span class="p">),</span><span class="w">
    </span><span class="p">(</span><span class="mi">_</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b11</span><span class="p">,</span><span class="w"> </span><span class="mi">_</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b01</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sail_barrier</span><span class="p">(</span><span class="n">Barrier_RISCV_rw_w</span><span class="p">),</span><span class="w">
    </span><span class="p">(</span><span class="mi">_</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b01</span><span class="p">,</span><span class="w"> </span><span class="mi">_</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b01</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sail_barrier</span><span class="p">(</span><span class="n">Barrier_RISCV_w_w</span><span class="p">),</span><span class="w">
    </span><span class="p">(</span><span class="mi">_</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b01</span><span class="p">,</span><span class="w"> </span><span class="mi">_</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b11</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sail_barrier</span><span class="p">(</span><span class="n">Barrier_RISCV_w_rw</span><span class="p">),</span><span class="w">
    </span><span class="p">(</span><span class="mi">_</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b11</span><span class="p">,</span><span class="w"> </span><span class="mi">_</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b10</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sail_barrier</span><span class="p">(</span><span class="n">Barrier_RISCV_rw_r</span><span class="p">),</span><span class="w">
    </span><span class="p">(</span><span class="mi">_</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b10</span><span class="p">,</span><span class="w"> </span><span class="mi">_</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b01</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sail_barrier</span><span class="p">(</span><span class="n">Barrier_RISCV_r_w</span><span class="p">),</span><span class="w">
    </span><span class="p">(</span><span class="mi">_</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b01</span><span class="p">,</span><span class="w"> </span><span class="mi">_</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b10</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sail_barrier</span><span class="p">(</span><span class="n">Barrier_RISCV_w_r</span><span class="p">),</span><span class="w">

    </span><span class="p">(</span><span class="mi">_</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">       </span><span class="p">,</span><span class="w"> </span><span class="mi">_</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b00</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(),</span><span class="w">
    </span><span class="p">(</span><span class="mi">_</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b00</span><span class="p">,</span><span class="w"> </span><span class="mi">_</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">       </span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(),</span><span class="w">

    </span><span class="mi">_</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">print</span><span class="p">(</span><span class="s">"FIXME: unsupported fence"</span><span class="p">);</span><span class="w">
           </span><span class="p">()</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fence_reserved">FENCE.RESERVED</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-29360b87c846104a09be30568cf7d0bf.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 105. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FENCE.RESERVED goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fence_tso">FENCE.TSO</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-ac30289a9fa4002e2c37ec784fcd5d19.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 106. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FENCE.TSO goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">sail_barrier</span><span class="p">(</span><span class="n">Barrier_RISCV_tso</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fencei_reserved">FENCEI.RESERVED</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-70f263c31e1adc82e43b0e59dea83ba4.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 107. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FENCEI.RESERVED goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fleq_d">FLEQ.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-94bcf7069183dd1b5e72568c95b1f759.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 108. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FLEQ.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_D</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L492">riscv_f64Le_quiet</a></span><span class="w">   </span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="p">);</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L112">bool_to_bits</a></span><span class="p">(</span><span class="n">rd_val</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fleq_h">FLEQ.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-01d240160700320a31e0a6dab7fb6107.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 109. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FLEQ.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_H</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L422">riscv_f16Le_quiet</a></span><span class="w">   </span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="p">);</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L112">bool_to_bits</a></span><span class="p">(</span><span class="n">rd_val</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fleq_s">FLEQ.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-a56ab709a015bae580243dc764fea16b.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 110. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FLEQ.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_S</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L457">riscv_f32Le_quiet</a></span><span class="w">   </span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="p">);</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L112">bool_to_bits</a></span><span class="p">(</span><span class="n">rd_val</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fli_d">FLI.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-82f95b97c28b2fe1cba888d3a6d03fe6.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 111. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FLI.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="kt">bits</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">constantidx</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="mb">0b00000</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0xbff0000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* -1.0 */</span><span class="w">
    </span><span class="mb">0b00001</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x0010000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* minimum positive normal */</span><span class="w">
    </span><span class="mb">0b00010</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3Ef0000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.0 * 2^-16 */</span><span class="w">
    </span><span class="mb">0b00011</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3f00000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.0 * 2^-15 */</span><span class="w">
    </span><span class="mb">0b00100</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3f70000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.0 * 2^-8  */</span><span class="w">
    </span><span class="mb">0b00101</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3f80000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.0 * 2^-7  */</span><span class="w">
    </span><span class="mb">0b00110</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3fb0000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.0 * 2^-4  */</span><span class="w">
    </span><span class="mb">0b00111</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3fc0000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.0 * 2^-3  */</span><span class="w">
    </span><span class="mb">0b01000</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3fd0000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.25 */</span><span class="w">
    </span><span class="mb">0b01001</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3fd4000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.3125 */</span><span class="w">
    </span><span class="mb">0b01010</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3fd8000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.375 */</span><span class="w">
    </span><span class="mb">0b01011</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3fdc000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.4375 */</span><span class="w">
    </span><span class="mb">0b01100</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3fe0000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.5 */</span><span class="w">
    </span><span class="mb">0b01101</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3fe4000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.625 */</span><span class="w">
    </span><span class="mb">0b01110</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3fe8000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.75 */</span><span class="w">
    </span><span class="mb">0b01111</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3fec000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.875 */</span><span class="w">
    </span><span class="mb">0b10000</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3ff0000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.0 */</span><span class="w">
    </span><span class="mb">0b10001</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3ff4000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.25 */</span><span class="w">
    </span><span class="mb">0b10010</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3ff8000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.5 */</span><span class="w">
    </span><span class="mb">0b10011</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3ffc000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.75 */</span><span class="w">
    </span><span class="mb">0b10100</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x4000000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 2.0 */</span><span class="w">
    </span><span class="mb">0b10101</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x4004000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 2.5 */</span><span class="w">
    </span><span class="mb">0b10110</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x4008000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 3 */</span><span class="w">
    </span><span class="mb">0b10111</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x4010000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 4 */</span><span class="w">
    </span><span class="mb">0b11000</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x4020000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 8 */</span><span class="w">
    </span><span class="mb">0b11001</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x4030000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 16 */</span><span class="w">
    </span><span class="mb">0b11010</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x4060000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 2^7 */</span><span class="w">
    </span><span class="mb">0b11011</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x4070000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 2^8 */</span><span class="w">
    </span><span class="mb">0b11100</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x40e0000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 2^15 */</span><span class="w">
    </span><span class="mb">0b11101</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x40f0000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 2^16 */</span><span class="w">
    </span><span class="mb">0b11110</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x7ff0000000000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* +inf */</span><span class="w">
    </span><span class="mb">0b11111</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L34">canonical_NaN_D</a></span><span class="p">()</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n">F_D</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kt">bits</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fli_h">FLI.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-9d75b932fe670bb839bc622271a04eda.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 112. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FLI.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="kt">bits</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">constantidx</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="mb">0b00000</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0xbc00</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* -1.0 */</span><span class="w">
    </span><span class="mb">0b00001</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x0400</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* minimum positive normal */</span><span class="w">
    </span><span class="mb">0b00010</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x0100</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.0 * 2^-16 */</span><span class="w">
    </span><span class="mb">0b00011</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x0200</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.0 * 2^-15 */</span><span class="w">
    </span><span class="mb">0b00100</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x1c00</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.0 * 2^-8  */</span><span class="w">
    </span><span class="mb">0b00101</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x2000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.0 * 2^-7  */</span><span class="w">
    </span><span class="mb">0b00110</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x2c00</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.0 * 2^-4  */</span><span class="w">
    </span><span class="mb">0b00111</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.0 * 2^-3  */</span><span class="w">
    </span><span class="mb">0b01000</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3400</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.25 */</span><span class="w">
    </span><span class="mb">0b01001</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3500</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.3125 */</span><span class="w">
    </span><span class="mb">0b01010</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3600</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.375 */</span><span class="w">
    </span><span class="mb">0b01011</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3700</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.4375 */</span><span class="w">
    </span><span class="mb">0b01100</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3800</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.5 */</span><span class="w">
    </span><span class="mb">0b01101</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3900</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.625 */</span><span class="w">
    </span><span class="mb">0b01110</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3a00</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.75 */</span><span class="w">
    </span><span class="mb">0b01111</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3b00</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.875 */</span><span class="w">
    </span><span class="mb">0b10000</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3c00</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.0 */</span><span class="w">
    </span><span class="mb">0b10001</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3d00</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.25 */</span><span class="w">
    </span><span class="mb">0b10010</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3e00</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.5 */</span><span class="w">
    </span><span class="mb">0b10011</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3f00</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.75 */</span><span class="w">
    </span><span class="mb">0b10100</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x4000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 2.0 */</span><span class="w">
    </span><span class="mb">0b10101</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x4100</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 2.5 */</span><span class="w">
    </span><span class="mb">0b10110</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x4200</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 3 */</span><span class="w">
    </span><span class="mb">0b10111</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x4400</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 4 */</span><span class="w">
    </span><span class="mb">0b11000</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x4800</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 8 */</span><span class="w">
    </span><span class="mb">0b11001</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x4c00</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 16 */</span><span class="w">
    </span><span class="mb">0b11010</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x5800</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 2^7 */</span><span class="w">
    </span><span class="mb">0b11011</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x5c00</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 2^8 */</span><span class="w">
    </span><span class="mb">0b11100</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x7800</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 2^15 */</span><span class="w">
    </span><span class="mb">0b11101</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x7c00</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 2^16 */</span><span class="w">
    </span><span class="mb">0b11110</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x7c00</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* +inf */</span><span class="w">
    </span><span class="mb">0b11111</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L32">canonical_NaN_H</a></span><span class="p">()</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n">F_H</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kt">bits</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fli_s">FLI.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-171db6451b6f629da02ecbfbf73f2dae.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 113. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FLI.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="kt">bits</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">constantidx</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="mb">0b00000</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0xbf800000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* -1.0 */</span><span class="w">
    </span><span class="mb">0b00001</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x00800000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* minimum positive normal */</span><span class="w">
    </span><span class="mb">0b00010</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x37800000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.0 * 2^-16 */</span><span class="w">
    </span><span class="mb">0b00011</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x38000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.0 * 2^-15 */</span><span class="w">
    </span><span class="mb">0b00100</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3b800000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.0 * 2^-8  */</span><span class="w">
    </span><span class="mb">0b00101</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3c000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.0 * 2^-7  */</span><span class="w">
    </span><span class="mb">0b00110</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3d800000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.0 * 2^-4  */</span><span class="w">
    </span><span class="mb">0b00111</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3e000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.0 * 2^-3  */</span><span class="w">
    </span><span class="mb">0b01000</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3e800000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.25 */</span><span class="w">
    </span><span class="mb">0b01001</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3ea00000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.3125 */</span><span class="w">
    </span><span class="mb">0b01010</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3ec00000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.375 */</span><span class="w">
    </span><span class="mb">0b01011</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3ee00000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.4375 */</span><span class="w">
    </span><span class="mb">0b01100</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3f000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.5 */</span><span class="w">
    </span><span class="mb">0b01101</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3f200000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.625 */</span><span class="w">
    </span><span class="mb">0b01110</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3f400000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.75 */</span><span class="w">
    </span><span class="mb">0b01111</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3f600000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 0.875 */</span><span class="w">
    </span><span class="mb">0b10000</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3f800000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.0 */</span><span class="w">
    </span><span class="mb">0b10001</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3fa00000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.25 */</span><span class="w">
    </span><span class="mb">0b10010</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3fc00000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.5 */</span><span class="w">
    </span><span class="mb">0b10011</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x3fe00000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 1.75 */</span><span class="w">
    </span><span class="mb">0b10100</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x40000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 2.0 */</span><span class="w">
    </span><span class="mb">0b10101</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x40200000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 2.5 */</span><span class="w">
    </span><span class="mb">0b10110</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x40400000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 3 */</span><span class="w">
    </span><span class="mb">0b10111</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x40800000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 4 */</span><span class="w">
    </span><span class="mb">0b11000</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x41000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 8 */</span><span class="w">
    </span><span class="mb">0b11001</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x41800000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 16 */</span><span class="w">
    </span><span class="mb">0b11010</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x43000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 2^7 */</span><span class="w">
    </span><span class="mb">0b11011</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x43800000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 2^8 */</span><span class="w">
    </span><span class="mb">0b11100</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x47000000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 2^15 */</span><span class="w">
    </span><span class="mb">0b11101</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x47800000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* 2^16 */</span><span class="w">
    </span><span class="mb">0b11110</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mh">0x7f800000</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="c">/* +inf */</span><span class="w">
    </span><span class="mb">0b11111</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L33">canonical_NaN_S</a></span><span class="p">()</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n">F_S</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kt">bits</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fltq_d">FLTQ.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-f9fc5dba8bd81f17f3a3cc8c29717286.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 114. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FLTQ.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_D</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L478">riscv_f64Lt_quiet</a></span><span class="w">   </span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="p">);</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L112">bool_to_bits</a></span><span class="p">(</span><span class="n">rd_val</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fltq_h">FLTQ.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-4eeecee5de715ded5fdd2756dcaa49b1.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 115. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FLTQ.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_H</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L408">riscv_f16Lt_quiet</a></span><span class="w">   </span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="p">);</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L112">bool_to_bits</a></span><span class="p">(</span><span class="n">rd_val</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fltq_s">FLTQ.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-c87146240161f6cb47cc215f61b5954d.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 116. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FLTQ.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_S</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L443">riscv_f32Lt_quiet</a></span><span class="w">   </span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="p">);</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L112">bool_to_bits</a></span><span class="p">(</span><span class="n">rd_val</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fmaxm_d">FMAXM.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-f2bf204b76a0d160451cf80bba4f8432.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 117. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FMAXM.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_D</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">is_quiet</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">rs2_lt_rs1</span><span class="p">,</span><span class="w"> </span><span class="n">fflags</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L191">fle_D</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs2_val_D</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="p">,</span><span class="w"> </span><span class="n">is_quiet</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_D</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w">      </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L125">f_is_NaN_D</a></span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L125">f_is_NaN_D</a></span><span class="p">(</span><span class="n">rs2_val_D</span><span class="p">))</span><span class="w">           </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L34">canonical_NaN_D</a></span><span class="p">()</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L69">f_is_neg_zero_D</a></span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L77">f_is_pos_zero_D</a></span><span class="p">(</span><span class="n">rs2_val_D</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L69">f_is_neg_zero_D</a></span><span class="p">(</span><span class="n">rs2_val_D</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L77">f_is_pos_zero_D</a></span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs2_lt_rs1</span><span class="w">                                                </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w">
                  </span><span class="k">else</span><span class="w">                                                              </span><span class="n">rs2_val_D</span><span class="p">;</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">F_D</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fmaxm_h">FMAXM.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-7024ccf99a2d3e1fc3e67d4c40699c4a.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 118. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FMAXM.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_H</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">is_quiet</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">rs2_lt_rs1</span><span class="p">,</span><span class="w"> </span><span class="n">fflags</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L132">fle_H</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs2_val_H</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="p">,</span><span class="w"> </span><span class="n">is_quiet</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_H</span><span class="w"> </span><span class="p">=</span><span class="w">  </span><span class="k">if</span><span class="w">      </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L125">f_is_NaN_H</a></span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L125">f_is_NaN_H</a></span><span class="p">(</span><span class="n">rs2_val_H</span><span class="p">))</span><span class="w">           </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L32">canonical_NaN_H</a></span><span class="p">()</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L93">f_is_neg_zero_H</a></span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L101">f_is_pos_zero_H</a></span><span class="p">(</span><span class="n">rs2_val_H</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L93">f_is_neg_zero_H</a></span><span class="p">(</span><span class="n">rs2_val_H</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L101">f_is_pos_zero_H</a></span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs2_lt_rs1</span><span class="w">                                                </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="c">/* (not rs2_lt_rs1) */</span><span class="w">                                            </span><span class="n">rs2_val_H</span><span class="p">;</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">F_H</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fmaxm_s">FMAXM.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-2d4fe855e8adf03c01211ce3cf72a8a5.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 119. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FMAXM.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_S</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">is_quiet</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">rs2_lt_rs1</span><span class="p">,</span><span class="w"> </span><span class="n">fflags</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L229">fle_S</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs2_val_S</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="p">,</span><span class="w"> </span><span class="n">is_quiet</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_S</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w">      </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L164">f_is_NaN_S</a></span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L164">f_is_NaN_S</a></span><span class="p">(</span><span class="n">rs2_val_S</span><span class="p">))</span><span class="w">           </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L33">canonical_NaN_S</a></span><span class="p">()</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L108">f_is_neg_zero_S</a></span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L116">f_is_pos_zero_S</a></span><span class="p">(</span><span class="n">rs2_val_S</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L108">f_is_neg_zero_S</a></span><span class="p">(</span><span class="n">rs2_val_S</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L116">f_is_pos_zero_S</a></span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs2_lt_rs1</span><span class="w">                                                </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="c">/* (not rs2_lt_rs1) */</span><span class="w">                                            </span><span class="n">rs2_val_S</span><span class="p">;</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">F_S</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fminm_d">FMINM.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-8102423b1ab3ab471e99a72b286276e8.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 120. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FMINM.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_D</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">is_quiet</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">rs1_lt_rs2</span><span class="p">,</span><span class="w"> </span><span class="n">fflags</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L191">fle_D</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="p">,</span><span class="w"> </span><span class="n">is_quiet</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_D</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w">      </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L125">f_is_NaN_D</a></span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L125">f_is_NaN_D</a></span><span class="p">(</span><span class="n">rs2_val_D</span><span class="p">))</span><span class="w">           </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L34">canonical_NaN_D</a></span><span class="p">()</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L69">f_is_neg_zero_D</a></span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L77">f_is_pos_zero_D</a></span><span class="p">(</span><span class="n">rs2_val_D</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L69">f_is_neg_zero_D</a></span><span class="p">(</span><span class="n">rs2_val_D</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_dext.html#L77">f_is_pos_zero_D</a></span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs2_val_D</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs1_lt_rs2</span><span class="w">                                                </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w">
                  </span><span class="k">else</span><span class="w">                                                              </span><span class="n">rs2_val_D</span><span class="p">;</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">F_D</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fminm_h">FMINM.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-48fd1bfe8673fa967ab614e447b3f3d2.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 121. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FMINM.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_H</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">is_quiet</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">rs1_lt_rs2</span><span class="p">,</span><span class="w"> </span><span class="n">fflags</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L132">fle_H</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="p">,</span><span class="w"> </span><span class="n">is_quiet</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_H</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w">      </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L125">f_is_NaN_H</a></span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L125">f_is_NaN_H</a></span><span class="p">(</span><span class="n">rs2_val_H</span><span class="p">))</span><span class="w">           </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L32">canonical_NaN_H</a></span><span class="p">()</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L93">f_is_neg_zero_H</a></span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L101">f_is_pos_zero_H</a></span><span class="p">(</span><span class="n">rs2_val_H</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L93">f_is_neg_zero_H</a></span><span class="p">(</span><span class="n">rs2_val_H</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zfh.html#L101">f_is_pos_zero_H</a></span><span class="p">(</span><span class="n">rs1_val_H</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs2_val_H</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs1_lt_rs2</span><span class="w">                                                </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="c">/* (not rs1_lt_rs2) */</span><span class="w">                                            </span><span class="n">rs2_val_H</span><span class="p">;</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">F_H</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fminm_s">FMINM.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-66e54ad687d222aa892ab2d52b25268f.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 122. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FMINM.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_S</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">is_quiet</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">rs1_lt_rs2</span><span class="p">,</span><span class="w"> </span><span class="n">fflags</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L229">fle_S</a></span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="p">,</span><span class="w"> </span><span class="n">is_quiet</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_S</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w">      </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L164">f_is_NaN_S</a></span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L164">f_is_NaN_S</a></span><span class="p">(</span><span class="n">rs2_val_S</span><span class="p">))</span><span class="w">           </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L33">canonical_NaN_S</a></span><span class="p">()</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L108">f_is_neg_zero_S</a></span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L116">f_is_pos_zero_S</a></span><span class="p">(</span><span class="n">rs2_val_S</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L108">f_is_neg_zero_S</a></span><span class="p">(</span><span class="n">rs2_val_S</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L116">f_is_pos_zero_S</a></span><span class="p">(</span><span class="n">rs1_val_S</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs2_val_S</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs1_lt_rs2</span><span class="w">                                                </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="c">/* (not rs1_lt_rs2) */</span><span class="w">                                            </span><span class="n">rs2_val_S</span><span class="p">;</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
  </span><span class="n">F_S</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fmvh_x_d">FMVH.X.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-4416f3caa7c9872463f9f92af886a9ed.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 123. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FMVH.X.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w">           </span><span class="p">=</span><span class="w"> </span><span class="n">F_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">63</span><span class="o">..</span><span class="mi">32</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_X</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">rs1_val_D</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w">                   </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_X</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fmvp_d_x">FMVP.D.X</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-da222c175b91d0f82eec010a52908ae5.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 124. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FMVP.D.X goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_X</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val_X</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">

  </span><span class="c">/* Concatenate the two values using '@' operator */</span><span class="w">
  </span><span class="c">/* e.g. */</span><span class="w">
  </span><span class="c">/*   rs1 = 0x01234567 */</span><span class="w">
  </span><span class="c">/*   rs2 = 0x89abcdef */</span><span class="w">
  </span><span class="c">/*   rd  = rs1 @ rs2 =&gt; 0x89abcdef01234567 */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rd_val_D</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">rs2_val_X</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">rs1_val_X</span><span class="p">;</span><span class="w">

  </span><span class="n">F_D</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w">           </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fround_d">FROUND.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-f1a67f07e908f63b850c6aa273d06853.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 125. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FROUND.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">

  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w">  </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L520">riscv_f64roundToInt</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_D</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fround_h">FROUND.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-eed4ff8174676bdcc52adbca31492cdf.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 126. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FROUND.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">

  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w">  </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L506">riscv_f16roundToInt</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_H</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fround_s">FROUND.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-150d7ee84f50ee8db58f2766cb04c662.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 127. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FROUND.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">

  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w">  </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L513">riscv_f32roundToInt</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_S</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_froundnx_d">FROUNDNX.D</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-59e83457e1384d5fed1ea7529ea9d4b4.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 128. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FROUNDNX.D goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_D</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">

  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w">  </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L520">riscv_f64roundToInt</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_D</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_D</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_D</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_froundnx_h">FROUNDNX.H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-48881377bd65f51a531459d857d5148f.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 129. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FROUNDNX.H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_H</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">

  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w">  </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L506">riscv_f16roundToInt</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_H</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_H</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_H</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_froundnx_s">FROUNDNX.S</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-99aa17a53d0d025293525fda95ea828c.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 130. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FROUNDNX.S goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F_S</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">

  </span><span class="k">match</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_fext.html#L53">select_instr_or_fcsr_rm</a></span><span class="p">(</span><span class="n">rm</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">None</span><span class="p">()</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Some</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w"> </span><span class="p">=</span><span class="w">  </span><span class="n">encdec_rounding_mode</span><span class="p">(</span><span class="n">rm</span><span class="err">'</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L513">riscv_f32roundToInt</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val_S</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span><span class="w">

      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
      </span><span class="n">F_S</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rd_val_S</span><span class="p">;</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fvfmatype">FVFMATYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-ccecb6b04bb989e4b6957c2af0d929e3.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 131. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FVFMATYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L429">fcsr</a></span><span class="p">[</span><span class="n">FRM</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L27">illegal_fp_normal</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">rm_3b</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L165">get_scalar_fp</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="nv">'m</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">VF_VMACC</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L329">fp_muladd</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">VF_VNMACC</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L364">fp_nmulsub</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">VF_VMSAC</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L352">fp_mulsub</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">VF_VNMSAC</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L340">fp_nmuladd</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">VF_VMADD</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L329">fp_muladd</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">VF_VNMADD</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L364">fp_nmulsub</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">VF_VMSUB</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L352">fp_mulsub</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">VF_VNMSUB</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L340">fp_nmuladd</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fvfmtype">FVFMTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-ccecb6b04bb989e4b6957c2af0d929e3.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 132. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FVFMTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L429">fcsr</a></span><span class="p">[</span><span class="n">FRM</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L39">illegal_fp_vd_unmasked</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">rm_3b</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">                  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L165">get_scalar_fp</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="nv">'m</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L379">init_masked_result_cmp</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">VFM_VMFEQ</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L250">fp_eq</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">),</span><span class="w">
        </span><span class="n">VFM_VMFNE</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="err">~</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L250">fp_eq</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">)),</span><span class="w">
        </span><span class="n">VFM_VMFLE</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L296">fp_le</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">),</span><span class="w">
        </span><span class="n">VFM_VMFLT</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L285">fp_lt</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">),</span><span class="w">
        </span><span class="n">VFM_VMFGE</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L273">fp_ge</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">),</span><span class="w">
        </span><span class="n">VFM_VMFGT</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L261">fp_gt</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">)</span><span class="w">
      </span><span class="p">};</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L110">bool_to_bit</a></span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L409">write_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fvftype">FVFTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-ccecb6b04bb989e4b6957c2af0d929e3.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 133. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FVFTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L429">fcsr</a></span><span class="p">[</span><span class="n">FRM</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L27">illegal_fp_normal</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">rm_3b</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L165">get_scalar_fp</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="nv">'m</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">VF_VADD</span><span class="w">          </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L190">fp_add</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">),</span><span class="w">
        </span><span class="n">VF_VSUB</span><span class="w">          </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L201">fp_sub</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">),</span><span class="w">
        </span><span class="n">VF_VRSUB</span><span class="w">         </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L201">fp_sub</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">VF_VMIN</span><span class="w">          </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L212">fp_min</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">),</span><span class="w">
        </span><span class="n">VF_VMAX</span><span class="w">          </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L231">fp_max</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">),</span><span class="w">
        </span><span class="n">VF_VMUL</span><span class="w">          </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L307">fp_mul</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">),</span><span class="w">
        </span><span class="n">VF_VDIV</span><span class="w">          </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L318">fp_div</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">),</span><span class="w">
        </span><span class="n">VF_VRDIV</span><span class="w">         </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L318">fp_div</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">VF_VSGNJ</span><span class="w">         </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">rs1_val</span><span class="p">[</span><span class="nv">'m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]]</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">][(</span><span class="nv">'m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">..</span><span class="mi">0</span><span class="p">],</span><span class="w">
        </span><span class="n">VF_VSGNJN</span><span class="w">        </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="mb">0b1</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">[</span><span class="n">rs1_val</span><span class="p">[</span><span class="nv">'m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]])</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">][(</span><span class="nv">'m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">..</span><span class="mi">0</span><span class="p">],</span><span class="w">
        </span><span class="n">VF_VSGNJX</span><span class="w">        </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">([</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="nv">'m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">[</span><span class="n">rs1_val</span><span class="p">[</span><span class="nv">'m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]])</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">][(</span><span class="nv">'m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">..</span><span class="mi">0</span><span class="p">],</span><span class="w">
        </span><span class="n">VF_VSLIDE1UP</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">if</span><span class="w"> </span><span class="n">vs2</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">vd</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
                              </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">VF_VSLIDE1DOWN</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">last_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L236">get_end_element</a></span><span class="p">();</span><span class="w">
                              </span><span class="n">assert</span><span class="p">(</span><span class="n">last_elem</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_elem</span><span class="p">);</span><span class="w">
                              </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">last_elem</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">rs1_val</span><span class="w">
                            </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fvvmatype">FVVMATYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-839391445edbe6f387b2befd0dd42f69.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 134. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FVVMATYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L429">fcsr</a></span><span class="p">[</span><span class="n">FRM</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L27">illegal_fp_normal</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">rm_3b</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">FVV_VMACC</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L329">fp_muladd</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">FVV_VNMACC</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L364">fp_nmulsub</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">FVV_VMSAC</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L352">fp_mulsub</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">FVV_VNMSAC</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L340">fp_nmuladd</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">FVV_VMADD</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L329">fp_muladd</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">FVV_VNMADD</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L364">fp_nmulsub</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">FVV_VMSUB</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L352">fp_mulsub</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">FVV_VNMSUB</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L340">fp_nmuladd</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fvvmtype">FVVMTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-839391445edbe6f387b2befd0dd42f69.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 135. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FVVMTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L429">fcsr</a></span><span class="p">[</span><span class="n">FRM</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L39">illegal_fp_vd_unmasked</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">rm_3b</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L379">init_masked_result_cmp</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">FVVM_VMFEQ</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L250">fp_eq</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">FVVM_VMFNE</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="err">~</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L250">fp_eq</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
        </span><span class="n">FVVM_VMFLE</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L296">fp_le</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">FVVM_VMFLT</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L285">fp_lt</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
      </span><span class="p">};</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L110">bool_to_bit</a></span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L409">write_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fvvtype">FVVTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-839391445edbe6f387b2befd0dd42f69.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 136. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FVVTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L429">fcsr</a></span><span class="p">[</span><span class="n">FRM</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L27">illegal_fp_normal</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">rm_3b</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">            </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">FVV_VADD</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L190">fp_add</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">FVV_VSUB</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L201">fp_sub</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">FVV_VMIN</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L212">fp_min</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">FVV_VMAX</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L231">fp_max</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">FVV_VMUL</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L307">fp_mul</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">FVV_VDIV</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L318">fp_div</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">FVV_VSGNJ</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">[</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="nv">'m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]]</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">][(</span><span class="nv">'m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">..</span><span class="mi">0</span><span class="p">],</span><span class="w">
        </span><span class="n">FVV_VSGNJN</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="mb">0b1</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">[</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="nv">'m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]])</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">][(</span><span class="nv">'m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">..</span><span class="mi">0</span><span class="p">],</span><span class="w">
        </span><span class="n">FVV_VSGNJX</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">([</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="nv">'m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">[</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="nv">'m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]])</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">][(</span><span class="nv">'m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="o">..</span><span class="mi">0</span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fwftype">FWFTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-ccecb6b04bb989e4b6957c2af0d929e3.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 137. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FWFTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L429">fcsr</a></span><span class="p">[</span><span class="n">FRM</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L45">illegal_fp_variable_width</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L165">get_scalar_fp</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="nv">'m</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">FWF_VADD</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L190">fp_add</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)),</span><span class="w">
        </span><span class="n">FWF_VSUB</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L201">fp_sub</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">))</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fwvfmatype">FWVFMATYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-ccecb6b04bb989e4b6957c2af0d929e3.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 138. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FWVFMATYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L429">fcsr</a></span><span class="p">[</span><span class="n">FRM</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w">  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L45">illegal_fp_variable_width</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">))</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L165">get_scalar_fp</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="nv">'m</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">FWVF_VMACC</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L329">fp_muladd</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">),</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">FWVF_VNMACC</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L364">fp_nmulsub</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">),</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">FWVF_VMSAC</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L352">fp_mulsub</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">),</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">FWVF_VNMSAC</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L340">fp_nmuladd</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">),</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fwvftype">FWVFTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-ccecb6b04bb989e4b6957c2af0d929e3.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 139. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FWVFTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L429">fcsr</a></span><span class="p">[</span><span class="n">FRM</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w">  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L45">illegal_fp_variable_width</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">))</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L165">get_scalar_fp</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="nv">'m</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">FWVF_VADD</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L190">fp_add</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)),</span><span class="w">
        </span><span class="n">FWVF_VSUB</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L201">fp_sub</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)),</span><span class="w">
        </span><span class="n">FWVF_VMUL</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L307">fp_mul</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">))</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fwvtype">FWVTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-839391445edbe6f387b2befd0dd42f69.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 140. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FWVTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L429">fcsr</a></span><span class="p">[</span><span class="n">FRM</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w">  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L45">illegal_fp_variable_width</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs1</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">))</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">FWV_VADD</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L190">fp_add</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
        </span><span class="n">FWV_VSUB</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L201">fp_sub</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fwvvmatype">FWVVMATYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-abc26734aac0ffd42f6f56d9abdc86aa.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 141. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FWVVMATYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L429">fcsr</a></span><span class="p">[</span><span class="n">FRM</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w">  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L45">illegal_fp_variable_width</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs1</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">))</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">))</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">FWVV_VMACC</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L329">fp_muladd</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">FWVV_VNMACC</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L364">fp_nmulsub</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">FWVV_VMSAC</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L352">fp_mulsub</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">FWVV_VNMSAC</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L340">fp_nmuladd</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fwvvtype">FWVVTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-839391445edbe6f387b2befd0dd42f69.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 142. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for FWVVTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L429">fcsr</a></span><span class="p">[</span><span class="n">FRM</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w">  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L45">illegal_fp_variable_width</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs1</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">))</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">))</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">FWVV_VADD</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L190">fp_add</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
        </span><span class="n">FWVV_VSUB</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L201">fp_sub</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
        </span><span class="n">FWVV_VMUL</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L307">fp_mul</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L395">fp_widen</a></span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_itype">ITYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-44ee2615439b966b9e2c56f003aa9ad6.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 143. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ITYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">immext</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">imm</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">ADDI</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">immext</span><span class="p">,</span><span class="w">
    </span><span class="n">SLTI</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L112">bool_to_bits</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="n">&lt;_s</span><span class="w"> </span><span class="n">immext</span><span class="p">)),</span><span class="w">
    </span><span class="n">SLTIU</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L112">bool_to_bits</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="n">&lt;_u</span><span class="w"> </span><span class="n">immext</span><span class="p">)),</span><span class="w">
    </span><span class="n">ANDI</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">immext</span><span class="p">,</span><span class="w">
    </span><span class="n">ORI</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">immext</span><span class="p">,</span><span class="w">
    </span><span class="n">XORI</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">immext</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_jal">JAL</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-f2ffe1f79ee771d4d444c1e6cd091014.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 144. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for JAL goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_regs.html#L11">PC</a></span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">imm</span><span class="p">);</span><span class="w">
  </span><span class="c">/* Extensions get the first checks on the prospective target address. */</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_addr_checks.html#L44">ext_control_check_pc</a></span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ext_ControlAddr_Error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Ext_ControlAddr_Check_Failure</span><span class="p">(</span><span class="n">e</span><span class="p">),</span><span class="w">
    </span><span class="n">Ext_ControlAddr_OK</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="c">/* Perform standard alignment check */</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">target_bits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">bits_of</span><span class="p">(</span><span class="n">target</span><span class="p">);</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L111">bit_to_bool</a></span><span class="p">(</span><span class="n">target_bits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n">currentlyEnabled</span><span class="p">(</span><span class="n">Ext_Zca</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">Memory_Exception</span><span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="n">E_Fetch_Addr_Align</span><span class="p">())</span><span class="w">
      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_pc_access.html#L21">get_next_pc</a></span><span class="p">();</span><span class="w">
        </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_pc_access.html#L24">set_next_pc</a></span><span class="p">(</span><span class="n">target_bits</span><span class="p">);</span><span class="w">
        </span><span class="n">RETIRE_SUCCESS</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_jalr">JALR</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-34daed6d5c2a3a901082bb1b7427da6e.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 145. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for JALR goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">imm</span><span class="p">);</span><span class="w">
  </span><span class="c">/* Extensions get the first checks on the prospective target address. */</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_addr_checks.html#L40">ext_control_check_addr</a></span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ext_ControlAddr_Error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w">
      </span><span class="n">Ext_ControlAddr_Check_Failure</span><span class="p">(</span><span class="n">e</span><span class="p">),</span><span class="w">
    </span><span class="n">Ext_ControlAddr_OK</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">bits_of</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">bitzero</span><span class="p">];</span><span class="w">  </span><span class="c">/* clear addr[0] */</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L111">bit_to_bool</a></span><span class="p">(</span><span class="n">target</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n">currentlyEnabled</span><span class="p">(</span><span class="n">Ext_Zca</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">Memory_Exception</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="n">E_Fetch_Addr_Align</span><span class="p">())</span><span class="w">
      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_pc_access.html#L21">get_next_pc</a></span><span class="p">();</span><span class="w">
        </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_pc_access.html#L24">set_next_pc</a></span><span class="p">(</span><span class="n">target</span><span class="p">);</span><span class="w">
        </span><span class="n">RETIRE_SUCCESS</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_load">LOAD</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-dcb0d4e027647e3329e4a49453dda952.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 146. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for LOAD goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">imm</span><span class="p">);</span><span class="w">

  </span><span class="c">// This is checked during decoding.</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">width</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">xlen_bytes</span><span class="p">);</span><span class="w">

  </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vmem_utils.html#L180">vmem_read</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">offset</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">Read</span><span class="p">(</span><span class="n">Data</span><span class="p">),</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_base.html#L283">extend_value</a></span><span class="p">(</span><span class="n">is_unsigned</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">);</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="n">Err</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_load_fp">LOAD.FP</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-96a482654647a2eac7b1686f57706c2a.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 147. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for LOAD.FP goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="p">(</span><span class="n">LOAD_FP</span><span class="p">(</span><span class="n">imm</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="c">// This is checked during decoding.</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">width</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">flen_bytes</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">imm</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vmem_utils.html#L180">vmem_read</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">offset</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">Read</span><span class="p">(</span><span class="n">Data</span><span class="p">),</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">F</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L40">nan_box</a></span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w"> </span><span class="n">RETIRE_SUCCESS</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="n">Err</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_loadres">LOADRES</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-408dd91b21bedc1c43627c99b82feb8a.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 148. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for LOADRES goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="p">(</span><span class="n">LOADRES</span><span class="p">(</span><span class="n">aq</span><span class="p">,</span><span class="w"> </span><span class="n">rl</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="c">// This is checked during decoding.</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">width</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">xlen_bytes</span><span class="p">);</span><span class="w">

  </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vmem_utils.html#L180">vmem_read</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">(),</span><span class="w"> </span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">Read</span><span class="p">(</span><span class="n">Data</span><span class="p">),</span><span class="w"> </span><span class="n">aq</span><span class="p">,</span><span class="w"> </span><span class="n">aq</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">rl</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">data</span><span class="p">);</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="n">Err</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_masktypei">MASKTYPEI</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-22b49f0b993a69e0d337996eec25e6e8.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 149. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for MASKTYPEI goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">start_element</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">nat</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L220">get_start_element</a></span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">end_element</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L236">get_end_element</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">           </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w"> </span><span class="c">/* max(VLMAX,VLEN/SEW)) */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">real_num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">);</span><span class="w"> </span><span class="c">/* VLMAX */</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L105">illegal_vd_masked</a></span><span class="p">(</span><span class="n">vd</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">imm_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">simm</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vector_init</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">tail_ag</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">agtype</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1036">get_vtype_vta</a></span><span class="p">();</span><span class="w">
  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">start_element</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">end_element</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">real_num_elem</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">tail_ag</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">UNDISTURBED</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">AGNOSTIC</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="c">/* TODO: configuration support */</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="c">/* the merge operates on all body elements */</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">vm_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">imm_val</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_masktypev">MASKTYPEV</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-5d67fc8f77e4a37520e9fd9695b95f48.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 150. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for MASKTYPEV goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">start_element</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">nat</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L220">get_start_element</a></span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">end_element</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L236">get_end_element</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">           </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w"> </span><span class="c">/* max(VLMAX,VLEN/SEW)) */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">real_num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">);</span><span class="w"> </span><span class="c">/* VLMAX */</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L105">illegal_vd_masked</a></span><span class="p">(</span><span class="n">vd</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vector_init</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">tail_ag</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">agtype</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1036">get_vtype_vta</a></span><span class="p">();</span><span class="w">
  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">start_element</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">end_element</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">real_num_elem</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">tail_ag</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">UNDISTURBED</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">AGNOSTIC</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="c">/* TODO: configuration support */</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="c">/* the merge operates on all body elements */</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">vm_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_masktypex">MASKTYPEX</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-7d38bfd088594f83b1bc356e00ea28c6.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 151. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for MASKTYPEX goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">start_element</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">nat</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L220">get_start_element</a></span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">end_element</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L236">get_end_element</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">           </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w"> </span><span class="c">/* max(VLMAX,VLEN/SEW)) */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">real_num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">);</span><span class="w"> </span><span class="c">/* VLMAX */</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L105">illegal_vd_masked</a></span><span class="p">(</span><span class="n">vd</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L173">get_scalar</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vector_init</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">tail_ag</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">agtype</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1036">get_vtype_vta</a></span><span class="p">();</span><span class="w">
  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">start_element</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">end_element</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">real_num_elem</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">tail_ag</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">UNDISTURBED</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">AGNOSTIC</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="c">/* TODO: configuration support */</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="c">/* the merge operates on all body elements */</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">vm_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_mmtype">MMTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-332ac27e621e640a8245c3c951578915.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 152. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for MMTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">VLEN</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L116">illegal_vd_unmasked</a></span><span class="p">()</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L340">init_masked_result_carry</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">MM_VMAND</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">vs2_val</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">)[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">MM_VMNAND</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="err">~</span><span class="p">(</span><span class="n">vs2_val</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">)[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">MM_VMANDN</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">vs2_val</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="err">~</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">))[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">MM_VMXOR</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">vs2_val</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">)[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">MM_VMOR</span><span class="w">      </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">vs2_val</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">)[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">MM_VMNOR</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="err">~</span><span class="p">(</span><span class="n">vs2_val</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">))[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">MM_VMORN</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">vs2_val</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">~</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">))[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">MM_VMXNOR</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="err">~</span><span class="p">(</span><span class="n">vs2_val</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">))[</span><span class="n">i</span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L409">write_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_movetypei">MOVETYPEI</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-a4810150db0aedc2ae5b555d55e4584e.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 153. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for MOVETYPEI goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L116">illegal_vd_unmasked</a></span><span class="p">()</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b1</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">imm_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">simm</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">imm_val</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_movetypev">MOVETYPEV</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-153627eab73dc9aac1621938b1a50d5b.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 154. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for MOVETYPEV goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L116">illegal_vd_unmasked</a></span><span class="p">()</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b1</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_movetypex">MOVETYPEX</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-d219854b04db8c767416bdbe163fe74c.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 155. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for MOVETYPEX goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L116">illegal_vd_unmasked</a></span><span class="p">()</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L173">get_scalar</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="nv">'m</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b1</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rs1_val</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_mret">MRET</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-57e2f32f948d982cc2a40a0adf658827.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 156. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for MRET goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">if</span><span class="w">   </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L13">cur_privilege</a></span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">Machine</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_exceptions.html#L14">ext_check_xret_priv</a></span><span class="p">(</span><span class="n">Machine</span><span class="p">))</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="n">Ext_XRET_Priv_Failure</span><span class="p">()</span><span class="w">
  </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_pc_access.html#L24">set_next_pc</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_control.html#L264">exception_handler</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L13">cur_privilege</a></span><span class="p">,</span><span class="w"> </span><span class="n">CTL_MRET</span><span class="p">(),</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_regs.html#L11">PC</a></span><span class="p">));</span><span class="w">
    </span><span class="n">RETIRE_SUCCESS</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_mul">MUL</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-c0bbb52539c99674ef571b2195a8e4ed.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 157. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for MUL goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_bits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_bits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">mul_op</span><span class="o">.</span><span class="n">signed_rs1</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_bits</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_bits</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">mul_op</span><span class="o">.</span><span class="n">signed_rs2</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs2_bits</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs2_bits</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">result_wide</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L131">to_bits_truncate</a></span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xlen</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_int</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rs2_int</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w">   </span><span class="n">mul_op</span><span class="o">.</span><span class="n">high</span><span class="w">
          </span><span class="k">then</span><span class="w"> </span><span class="n">result_wide</span><span class="p">[(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xlen</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="n">xlen</span><span class="p">]</span><span class="w">
          </span><span class="k">else</span><span class="w"> </span><span class="n">result_wide</span><span class="p">[(</span><span class="n">xlen</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_mulw">MULW</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-3455f40e405631efd6042ebc44ea2bb1.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 158. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for MULW goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_bits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_bits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_bits</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs2_bits</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">result32</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L131">to_bits_truncate</a></span><span class="p">(</span><span class="n">rs1_int</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rs2_int</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">result32</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_mvvcompress">MVVCOMPRESS</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-f1081dad25e4409ad5c19506c6e8aa80.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 159. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for MVVCOMPRESS goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">start_element</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">nat</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L220">get_start_element</a></span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">end_element</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L236">get_end_element</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="c">/* vcompress should always be executed with a vstart of 0 */</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="n">start_element</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">vs1</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">vd</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">vs2</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">vd</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L116">illegal_vd_unmasked</a></span><span class="p">()</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vector_init</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">

  </span><span class="c">/* body elements */</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">vd_idx</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">nat</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">
  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">end_element</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="k">let</span><span class="w"> </span><span class="nv">'p</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vd_idx</span><span class="p">;</span><span class="w">
        </span><span class="n">assert</span><span class="p">(</span><span class="nv">'p</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nv">'n</span><span class="p">);</span><span class="w">
        </span><span class="n">result</span><span class="p">[</span><span class="nv">'p</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w">
        </span><span class="n">vd_idx</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vd_idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="c">/* tail elements */</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="n">vd_idx</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">tail_ag</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">agtype</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1036">get_vtype_vta</a></span><span class="p">();</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="nv">'p</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vd_idx</span><span class="p">;</span><span class="w">
    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="nv">'p</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">tail_ag</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">UNDISTURBED</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">AGNOSTIC</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="c">/* TODO: configuration support */</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_mvvmatype">MVVMATYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-b70466bfd00231872382b4af6dda1a9f.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 160. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for MVVMATYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L99">illegal_normal</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">MVV_VMACC</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">get_slice_int</span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">MVV_VNMSAC</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">get_slice_int</span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w">
        </span><span class="n">MVV_VMADD</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">get_slice_int</span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">MVV_VNMSUB</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">get_slice_int</span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_mvvtype">MVVTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-b70466bfd00231872382b4af6dda1a9f.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 161. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for MVVTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L99">illegal_normal</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">MVV_VAADDU</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">result_add</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">rounding_incr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L455">get_fixed_rounding_incr</a></span><span class="p">(</span><span class="n">result_add</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">
                          </span><span class="n">slice</span><span class="p">(</span><span class="n">result_add</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nv">'m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">rounding_incr</span><span class="p">)</span><span class="w">
                        </span><span class="p">},</span><span class="w">
        </span><span class="n">MVV_VAADD</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">result_add</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">rounding_incr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L455">get_fixed_rounding_incr</a></span><span class="p">(</span><span class="n">result_add</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">
                          </span><span class="n">slice</span><span class="p">(</span><span class="n">result_add</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nv">'m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">rounding_incr</span><span class="p">)</span><span class="w">
                        </span><span class="p">},</span><span class="w">
        </span><span class="n">MVV_VASUBU</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">result_sub</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">rounding_incr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L455">get_fixed_rounding_incr</a></span><span class="p">(</span><span class="n">result_sub</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">
                          </span><span class="n">slice</span><span class="p">(</span><span class="n">result_sub</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nv">'m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">rounding_incr</span><span class="p">)</span><span class="w">
                        </span><span class="p">},</span><span class="w">
        </span><span class="n">MVV_VASUB</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">result_sub</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">rounding_incr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L455">get_fixed_rounding_incr</a></span><span class="p">(</span><span class="n">result_sub</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">
                          </span><span class="n">slice</span><span class="p">(</span><span class="n">result_sub</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nv">'m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">rounding_incr</span><span class="p">)</span><span class="w">
                        </span><span class="p">},</span><span class="w">
        </span><span class="n">MVV_VMUL</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">get_slice_int</span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w">
        </span><span class="n">MVV_VMULH</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">get_slice_int</span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">SEW</span><span class="p">),</span><span class="w">
        </span><span class="n">MVV_VMULHU</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">get_slice_int</span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">SEW</span><span class="p">),</span><span class="w">
        </span><span class="n">MVV_VMULHSU</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">get_slice_int</span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">SEW</span><span class="p">),</span><span class="w">
        </span><span class="n">MVV_VDIVU</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">divisor</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">dividend</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">divisor</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">quot_round_zero</span><span class="p">(</span><span class="n">dividend</span><span class="p">,</span><span class="w"> </span><span class="n">divisor</span><span class="p">);</span><span class="w">
                          </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">)</span><span class="w">
                        </span><span class="p">},</span><span class="w">
        </span><span class="n">MVV_VDIV</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">elem_max</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">elem_min</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">divisor</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">dividend</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">divisor</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">quot_round_zero</span><span class="p">(</span><span class="n">dividend</span><span class="p">,</span><span class="w"> </span><span class="n">divisor</span><span class="p">);</span><span class="w">
                          </span><span class="c">/* check for signed overflow */</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">q</span><span class="err">'</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">elem_max</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">elem_min</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">q</span><span class="p">;</span><span class="w">
                          </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="err">'</span><span class="p">)</span><span class="w">
                        </span><span class="p">},</span><span class="w">
        </span><span class="n">MVV_VREMU</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">divisor</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">dividend</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">divisor</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">dividend</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">rem_round_zero</span><span class="p">(</span><span class="n">dividend</span><span class="p">,</span><span class="w"> </span><span class="n">divisor</span><span class="p">);</span><span class="w">
                          </span><span class="c">/* signed overflow case returns zero naturally as required due to -1 divisor */</span><span class="w">
                          </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w">
                        </span><span class="p">},</span><span class="w">
        </span><span class="n">MVV_VREM</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">divisor</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">dividend</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                          </span><span class="k">let</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">divisor</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">dividend</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">rem_round_zero</span><span class="p">(</span><span class="n">dividend</span><span class="p">,</span><span class="w"> </span><span class="n">divisor</span><span class="p">);</span><span class="w">
                          </span><span class="c">/* signed overflow case returns zero naturally as required due to -1 divisor */</span><span class="w">
                          </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w">
                        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_mvxmatype">MVXMATYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-99cc521619cbc480adbeae8082869ffd.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 162. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for MVXMATYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L99">illegal_normal</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L173">get_scalar</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">MVX_VMACC</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">get_slice_int</span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">MVX_VNMSAC</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">get_slice_int</span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w">
        </span><span class="n">MVX_VMADD</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">get_slice_int</span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">MVX_VNMSUB</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">get_slice_int</span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_mvxtype">MVXTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-99cc521619cbc480adbeae8082869ffd.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 163. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for MVXTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L99">illegal_normal</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L173">get_scalar</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">MVX_VAADDU</span><span class="w">       </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">result_add</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">);</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">rounding_incr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L455">get_fixed_rounding_incr</a></span><span class="p">(</span><span class="n">result_add</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">
                              </span><span class="n">slice</span><span class="p">(</span><span class="n">result_add</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nv">'m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">rounding_incr</span><span class="p">)</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">MVX_VAADD</span><span class="w">        </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">result_add</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">);</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">rounding_incr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L455">get_fixed_rounding_incr</a></span><span class="p">(</span><span class="n">result_add</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">
                              </span><span class="n">slice</span><span class="p">(</span><span class="n">result_add</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nv">'m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">rounding_incr</span><span class="p">)</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">MVX_VASUBU</span><span class="w">       </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">result_sub</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">);</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">rounding_incr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L455">get_fixed_rounding_incr</a></span><span class="p">(</span><span class="n">result_sub</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">
                              </span><span class="n">slice</span><span class="p">(</span><span class="n">result_sub</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nv">'m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">rounding_incr</span><span class="p">)</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">MVX_VASUB</span><span class="w">        </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">result_sub</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">);</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">rounding_incr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L455">get_fixed_rounding_incr</a></span><span class="p">(</span><span class="n">result_sub</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">
                              </span><span class="n">slice</span><span class="p">(</span><span class="n">result_sub</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nv">'m</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">rounding_incr</span><span class="p">)</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">MVX_VSLIDE1UP</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">vs2</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">vd</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
                              </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">MVX_VSLIDE1DOWN</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">last_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L236">get_end_element</a></span><span class="p">();</span><span class="w">
                              </span><span class="n">assert</span><span class="p">(</span><span class="n">last_elem</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_elem</span><span class="p">);</span><span class="w">
                              </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">last_elem</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">rs1_val</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">MVX_VMUL</span><span class="w">         </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">get_slice_int</span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w">
        </span><span class="n">MVX_VMULH</span><span class="w">        </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">get_slice_int</span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">),</span><span class="w"> </span><span class="n">SEW</span><span class="p">),</span><span class="w">
        </span><span class="n">MVX_VMULHU</span><span class="w">       </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">get_slice_int</span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">),</span><span class="w"> </span><span class="n">SEW</span><span class="p">),</span><span class="w">
        </span><span class="n">MVX_VMULHSU</span><span class="w">      </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">get_slice_int</span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">),</span><span class="w"> </span><span class="n">SEW</span><span class="p">),</span><span class="w">
        </span><span class="n">MVX_VDIVU</span><span class="w">        </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">divisor</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">);</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">dividend</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">divisor</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">quot_round_zero</span><span class="p">(</span><span class="n">dividend</span><span class="p">,</span><span class="w"> </span><span class="n">divisor</span><span class="p">);</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">)</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">MVX_VDIV</span><span class="w">         </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">elem_max</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">elem_min</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">divisor</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">);</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">dividend</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">divisor</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">quot_round_zero</span><span class="p">(</span><span class="n">dividend</span><span class="p">,</span><span class="w"> </span><span class="n">divisor</span><span class="p">);</span><span class="w">
                              </span><span class="c">/* check for signed overflow */</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">q</span><span class="err">'</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">elem_max</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">elem_min</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">q</span><span class="p">;</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="err">'</span><span class="p">)</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">MVX_VREMU</span><span class="w">        </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">divisor</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">);</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">dividend</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">divisor</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">dividend</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">rem_round_zero</span><span class="p">(</span><span class="n">dividend</span><span class="p">,</span><span class="w"> </span><span class="n">divisor</span><span class="p">);</span><span class="w">
                              </span><span class="c">/* signed overflow case returns zero naturally as required due to -1 divisor */</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">MVX_VREM</span><span class="w">         </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">divisor</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">);</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">dividend</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">divisor</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">dividend</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">rem_round_zero</span><span class="p">(</span><span class="n">dividend</span><span class="p">,</span><span class="w"> </span><span class="n">divisor</span><span class="p">);</span><span class="w">
                              </span><span class="c">/* signed overflow case returns zero naturally as required due to -1 divisor */</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w">
                            </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_nistype">NISTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-2449d412cb937e514abe7629a60cd0b5.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 164. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for NISTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w">  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L125">illegal_variable_width</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">))</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">imm_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">simm</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">NIS_VNSRL</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n">imm_val</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">);</span><span class="w">
                        </span><span class="n">slice</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w">
                      </span><span class="p">},</span><span class="w">
        </span><span class="n">NIS_VNSRA</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n">imm_val</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">);</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">v_double</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">arith_shifted</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">slice</span><span class="p">(</span><span class="n">v_double</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">);</span><span class="w">
                        </span><span class="n">slice</span><span class="p">(</span><span class="n">arith_shifted</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w">
                      </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_nitype">NITYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-2449d412cb937e514abe7629a60cd0b5.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 165. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for NITYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w">  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L125">illegal_variable_width</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">))</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">imm_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">simm</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n">imm_val</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rounding_incr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L455">get_fixed_rounding_incr</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">);</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">NI_VNCLIPU</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">result_wide</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'o</span><span class="p">,</span><span class="w"> </span><span class="n">rounding_incr</span><span class="p">);</span><span class="w">
                        </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L472">unsigned_saturation</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">result_wide</span><span class="p">)</span><span class="w">
                      </span><span class="p">},</span><span class="w">
        </span><span class="n">NI_VNCLIP</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">v_double</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">result_wide</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">slice</span><span class="p">(</span><span class="n">v_double</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nv">'o</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'o</span><span class="p">,</span><span class="w"> </span><span class="n">rounding_incr</span><span class="p">);</span><span class="w">
                        </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L483">signed_saturation</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">result_wide</span><span class="p">)</span><span class="w">
                      </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_nvstype">NVSTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-da8bceee7bdb98404cbb8f3544a86f44.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 166. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for NVSTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w">  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L125">illegal_variable_width</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">))</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">NVS_VNSRL</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">);</span><span class="w">
                        </span><span class="n">slice</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w">
                      </span><span class="p">},</span><span class="w">
        </span><span class="n">NVS_VNSRA</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">);</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">v_double</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">arith_shifted</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">slice</span><span class="p">(</span><span class="n">v_double</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">);</span><span class="w">
                        </span><span class="n">slice</span><span class="p">(</span><span class="n">arith_shifted</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w">
                      </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_nvtype">NVTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-da8bceee7bdb98404cbb8f3544a86f44.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 167. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for NVTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w">  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L125">illegal_variable_width</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">))</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rounding_incr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L455">get_fixed_rounding_incr</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">);</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">NV_VNCLIPU</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">result_wide</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'o</span><span class="p">,</span><span class="w"> </span><span class="n">rounding_incr</span><span class="p">);</span><span class="w">
                        </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L472">unsigned_saturation</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">result_wide</span><span class="p">);</span><span class="w">
                      </span><span class="p">},</span><span class="w">
        </span><span class="n">NV_VNCLIP</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">v_double</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">result_wide</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">slice</span><span class="p">(</span><span class="n">v_double</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nv">'o</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'o</span><span class="p">,</span><span class="w"> </span><span class="n">rounding_incr</span><span class="p">);</span><span class="w">
                        </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L483">signed_saturation</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">result_wide</span><span class="p">);</span><span class="w">
                      </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_nxstype">NXSTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-215d8e71c8cbcd7743e68e95833ac0b5.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 168. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for NXSTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w">  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L125">illegal_variable_width</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">))</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L173">get_scalar</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">NXS_VNSRL</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">);</span><span class="w">
                        </span><span class="n">slice</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w">
                      </span><span class="p">},</span><span class="w">
        </span><span class="n">NXS_VNSRA</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">);</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">v_double</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">arith_shifted</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">slice</span><span class="p">(</span><span class="n">v_double</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">);</span><span class="w">
                        </span><span class="n">slice</span><span class="p">(</span><span class="n">arith_shifted</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w">
                      </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_nxtype">NXTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-215d8e71c8cbcd7743e68e95833ac0b5.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 169. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for NXTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w">  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L125">illegal_variable_width</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">))</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L173">get_scalar</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">rounding_incr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L455">get_fixed_rounding_incr</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">);</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">NX_VNCLIPU</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">result_wide</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'o</span><span class="p">,</span><span class="w"> </span><span class="n">rounding_incr</span><span class="p">);</span><span class="w">
                        </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L472">unsigned_saturation</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">result_wide</span><span class="p">)</span><span class="w">
                      </span><span class="p">},</span><span class="w">
        </span><span class="n">NX_VNCLIP</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">v_double</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">result_wide</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">slice</span><span class="p">(</span><span class="n">v_double</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nv">'o</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'o</span><span class="p">,</span><span class="w"> </span><span class="n">rounding_incr</span><span class="p">);</span><span class="w">
                        </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L483">signed_saturation</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">result_wide</span><span class="p">)</span><span class="w">
                      </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_orcb">ORCB</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-7cb17e59cc1993e79efbd4ab314d293c.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 170. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ORCB goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">();</span><span class="w">
  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w">
    </span><span class="n">result</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">[(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">()</span><span class="w">
                           </span><span class="k">then</span><span class="w"> </span><span class="mh">0x00</span><span class="w">
                           </span><span class="k">else</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">;</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_rem">REM</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-67c0a68ca680f992d2379a6d840840f1.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 171. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for REM goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_bits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_bits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_unsigned</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_bits</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_bits</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_unsigned</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs2_bits</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs2_bits</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">remainder</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs2_int</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_int</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">rem_round_zero</span><span class="p">(</span><span class="n">rs1_int</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_int</span><span class="p">);</span><span class="w">
  </span><span class="c">// Signed overflow case returns zero naturally as required due to -1 divisor.</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L131">to_bits_truncate</a></span><span class="p">(</span><span class="n">remainder</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_remw">REMW</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-5dfcfbb4457f3f299c124008e9e5b33d.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 172. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for REMW goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_bits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_bits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_unsigned</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_bits</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_bits</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_unsigned</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs2_bits</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs2_bits</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">remainder</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs2_int</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_int</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">rem_round_zero</span><span class="p">(</span><span class="n">rs1_int</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_int</span><span class="p">);</span><span class="w">
  </span><span class="c">// Signed overflow case returns zero naturally as required due to -1 divisor.</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L131">to_bits_truncate</a></span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="w"> </span><span class="n">remainder</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_rev8">REV8</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-3d9cbfbfba4261b93a1aec5b5833f9dc.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 173. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for REV8 goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./arithmetic.html#L53">rev8</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_rfvvtype">RFVVTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-839391445edbe6f387b2befd0dd42f69.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 174. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for RFVVTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem_vs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">FVV_VFWREDOSUM</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">FVV_VFWREDUSUM</span><span class="w"> </span><span class="k">then</span><span class="w">
    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_red.html#L74">process_rfvv_widen</a></span><span class="p">(</span><span class="n">funct6</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">num_elem_vs</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">)</span><span class="w">
  </span><span class="k">else</span><span class="w">
    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_red.html#L31">process_rfvv_single</a></span><span class="p">(</span><span class="n">funct6</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">num_elem_vs</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_rivvtype">RIVVTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-da8bceee7bdb98404cbb8f3544a86f44.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 175. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for RIVVTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L140">illegal_reduction_widen</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem_vs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem_vd</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">);</span><span class="w"> </span><span class="c">/* vd regardless of LMUL setting */</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">)</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">RETIRE_SUCCESS</span><span class="p">;</span><span class="w"> </span><span class="c">/* if vl=0, no operation is performed */</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem_vs</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'d</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem_vd</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem_vs</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'d</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem_vd</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem_vs</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">mask</span><span class="w">    </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L303">init_masked_source</a></span><span class="p">(</span><span class="n">num_elem_vs</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="k">var</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L317">read_single_element</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w"> </span><span class="c">/* vs1 regardless of LMUL setting */</span><span class="w">
  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem_vs</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">elem</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">IVV_VWREDSUMU</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
        </span><span class="n">IVV_VWREDSUM</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="w">
      </span><span class="p">};</span><span class="w">
      </span><span class="n">sum</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">elem</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L352">write_single_element</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">sum</span><span class="p">);</span><span class="w">
  </span><span class="c">/* other elements in vd are treated as tail elements, currently remain unchanged */</span><span class="w">
  </span><span class="c">/* TODO: configuration support for agnostic behavior */</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_rmvvtype">RMVVTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-b70466bfd00231872382b4af6dda1a9f.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 176. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for RMVVTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem_vs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem_vd</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w"> </span><span class="c">/* vd regardless of LMUL setting */</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L134">illegal_reduction</a></span><span class="p">()</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">)</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">RETIRE_SUCCESS</span><span class="p">;</span><span class="w"> </span><span class="c">/* if vl=0, no operation is performed */</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem_vs</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'d</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem_vd</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem_vs</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'d</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem_vd</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem_vs</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">mask</span><span class="w">    </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L303">init_masked_source</a></span><span class="p">(</span><span class="n">num_elem_vs</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="k">var</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L317">read_single_element</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w"> </span><span class="c">/* vs1 regardless of LMUL setting */</span><span class="w">
  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem_vs</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">sum</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">MVV_VREDSUM</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">MVV_VREDAND</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">MVV_VREDOR</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">MVV_VREDXOR</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">MVV_VREDMIN</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">sum</span><span class="p">))),</span><span class="w">
        </span><span class="n">MVV_VREDMINU</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">sum</span><span class="p">))),</span><span class="w">
        </span><span class="n">MVV_VREDMAX</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">sum</span><span class="p">))),</span><span class="w">
        </span><span class="n">MVV_VREDMAXU</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">sum</span><span class="p">)))</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L352">write_single_element</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">sum</span><span class="p">);</span><span class="w">
  </span><span class="c">/* other elements in vd are treated as tail elements, currently remain unchanged */</span><span class="w">
  </span><span class="c">/* TODO: configuration support for agnostic behavior */</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_rori">RORI</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-5e1040a3647260ee21bb13aa7c1fc5e6.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 177. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for RORI goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">shamt</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">shamt</span><span class="p">[</span><span class="n">log2_xlen</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_roriw">RORIW</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-3935713ba6b0122e9bd56ae6bb4e2d41.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 178. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for RORIW goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_rtype">RTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-186ff11468299b8868439b1fea4cdea1.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 179. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for RTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">ADD</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">),</span><span class="w">
    </span><span class="n">SLT</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L112">bool_to_bits</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="n">&lt;_s</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">))),</span><span class="w">
    </span><span class="n">SLTU</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L112">bool_to_bits</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="n">&lt;_u</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">))),</span><span class="w">
    </span><span class="n">AND</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">),</span><span class="w">
    </span><span class="n">OR</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">),</span><span class="w">
    </span><span class="n">XOR</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">),</span><span class="w">
    </span><span class="n">SLL</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)[</span><span class="n">log2_xlen</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span><span class="w">
    </span><span class="n">SRL</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)[</span><span class="n">log2_xlen</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span><span class="w">
    </span><span class="n">SUB</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">),</span><span class="w">
    </span><span class="n">SRA</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L185">shift_bits_right_arith</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">),</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)[</span><span class="n">log2_xlen</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">]),</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_rtypew">RTYPEW</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-87aaee98e9883fa676fe6d93efe61a13.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 180. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for RTYPEW goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">ADDW</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rs2_val</span><span class="p">,</span><span class="w">
    </span><span class="n">SUBW</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rs2_val</span><span class="p">,</span><span class="w">
    </span><span class="n">SLLW</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">rs2_val</span><span class="p">[</span><span class="mi">4</span><span class="o">..</span><span class="mi">0</span><span class="p">],</span><span class="w">
    </span><span class="n">SRLW</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">rs2_val</span><span class="p">[</span><span class="mi">4</span><span class="o">..</span><span class="mi">0</span><span class="p">],</span><span class="w">
    </span><span class="n">SRAW</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L185">shift_bits_right_arith</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">rs2_val</span><span class="p">[</span><span class="mi">4</span><span class="o">..</span><span class="mi">0</span><span class="p">]),</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sfence_inval_ir">SFENCE.INVAL.IR</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-2ecd59b552c85629dc07621a5c7afc0f.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 181. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SFENCE.INVAL.IR goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L13">cur_privilege</a></span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">User</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="k">else</span><span class="w"> </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sfence_vma">SFENCE.VMA</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-0621cf013a3f1a1b510a161f76f3878e.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 182. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SFENCE.VMA goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">addr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs1</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">zreg</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">Some</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">))</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">None</span><span class="p">();</span><span class="w">
  </span><span class="c">// Note, the Sail model does not currently support Sv32 &amp; SXLEN=32 on RV64.</span><span class="w">
  </span><span class="c">// In that case this asidlen would be incorrect because the maximum asidlen</span><span class="w">
  </span><span class="c">// is 9 but we always set it to 16 for RV64.</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">asid</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs2</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">zreg</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">Some</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)[</span><span class="n">asidlen</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">None</span><span class="p">();</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L13">cur_privilege</a></span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">User</span><span class="w">       </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">Supervisor</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L263">mstatus</a></span><span class="p">[</span><span class="n">TVM</span><span class="p">]</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="mb">0b1</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
                    </span><span class="mb">0b0</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vmem_tlb.html#L165">flush_TLB</a></span><span class="p">(</span><span class="n">asid</span><span class="p">,</span><span class="w"> </span><span class="n">addr</span><span class="p">);</span><span class="w"> </span><span class="n">RETIRE_SUCCESS</span><span class="w"> </span><span class="p">},</span><span class="w">
                  </span><span class="p">},</span><span class="w">
    </span><span class="n">Machine</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vmem_tlb.html#L165">flush_TLB</a></span><span class="p">(</span><span class="n">asid</span><span class="p">,</span><span class="w"> </span><span class="n">addr</span><span class="p">);</span><span class="w"> </span><span class="n">RETIRE_SUCCESS</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sfence_w_inval">SFENCE.W.INVAL</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-38fa1674cce2d09486c50226af236824.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 183. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SFENCE.W.INVAL goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L13">cur_privilege</a></span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">User</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="k">else</span><span class="w"> </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sha256sig0">SHA256SIG0</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-18e7b39d9ac0b0d716f53399cefb8961.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 184. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SHA256SIG0 goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">inb</span><span class="w">    </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">inb</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">inb</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">18</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">inb</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w">  </span><span class="mi">3</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sha256sig1">SHA256SIG1</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-9639547e764260a58ec69928766e8a98.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 185. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SHA256SIG1 goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">inb</span><span class="w">    </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">inb</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">17</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">inb</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">19</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">inb</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sha256sum0">SHA256SUM0</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-48db96e27a22fa73e1b9f2b2f22e8ecb.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 186. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SHA256SUM0 goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">inb</span><span class="w">    </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">inb</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">inb</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">13</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">inb</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">22</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sha256sum1">SHA256SUM1</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-3b6ef575134ae701dadace52fe2f433f.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 187. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SHA256SUM1 goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">inb</span><span class="w">    </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">inb</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">inb</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">11</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">inb</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">25</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sha512sig0">SHA512SIG0</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-b78f88c6a7c6796cc6ea9d4234f9580f.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 188. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SHA512SIG0 goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">SHA512SIG0</span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">input</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w">  </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w">  </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">7</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sha512sig0h">SHA512SIG0H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-2efa3a8cc374f4a9cc3bd40e5164efc4.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 189. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SHA512SIG0H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">((</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w">  </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w">  </span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w">  </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w">
               </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">31</span><span class="p">)</span><span class="w">                  </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">24</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sha512sig0l">SHA512SIG0L</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-4445b260ad0f48d44e7e4b8c0dba19f8.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 190. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SHA512SIG0L goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">((</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w">  </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w">  </span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w">  </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w">
               </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">31</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">25</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">24</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sha512sig1">SHA512SIG1</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-ef920e463335b838a200c806ae0b3b08.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 191. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SHA512SIG1 goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">SHA512SIG1</span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">input</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">19</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">61</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">6</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sha512sig1h">SHA512SIG1H</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-10c62a918bb9e2ea6a961a5ac1bec675.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 192. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SHA512SIG1H goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">((</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w">  </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w">  </span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">19</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w">
               </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">29</span><span class="p">)</span><span class="w">                  </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">13</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sha512sig1l">SHA512SIG1L</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-5a117d02f4fd0097764798b08f4c708a.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 193. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SHA512SIG1L goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">((</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w">  </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w">  </span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">19</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w">
               </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">29</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">26</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">13</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sha512sum0">SHA512SUM0</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-f466eb8427b40f10d61146cc42a32ac6.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 194. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SHA512SUM0 goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">SHA512SUM0</span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">input</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">28</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">34</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">39</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sha512sum0r">SHA512SUM0R</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-d6d86cf3510385044884b545c1839cb6.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 195. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SHA512SUM0R goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">((</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">25</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">30</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">28</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w">
               </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w">  </span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w">  </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w">  </span><span class="mi">4</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sha512sum1">SHA512SUM1</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-246458d46a528a739e56c852b3874125.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 196. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SHA512SUM1 goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">SHA512SUM1</span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">input</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">18</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">input</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">41</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sha512sum1r">SHA512SUM1R</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-7889ab8fa1870499fa0dd099b1fea4a0.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 197. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SHA512SUM1R goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">((</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">23</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">18</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w">
               </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w">  </span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">18</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">14</span><span class="p">));</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_shiftiop">SHIFTIOP</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-552da8041c1ba31faaba18e9ba93ae4b.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 198. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SHIFTIOP goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">shamt</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">shamt</span><span class="p">[</span><span class="n">log2_xlen</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">SLLI</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">,</span><span class="w">
    </span><span class="n">SRLI</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">,</span><span class="w">
    </span><span class="n">SRAI</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L185">shift_bits_right_arith</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">),</span><span class="w"> </span><span class="n">shamt</span><span class="p">),</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_shiftiwop">SHIFTIWOP</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-a0a71cf4c6780163e0196c93437a3767.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 199. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SHIFTIWOP goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">SLLIW</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">,</span><span class="w">
    </span><span class="n">SRLIW</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">,</span><span class="w">
    </span><span class="n">SRAIW</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L185">shift_bits_right_arith</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">shamt</span><span class="p">),</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sinval_vma">SINVAL.VMA</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-68912102927625afe9032a66ac5f2616.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 200. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SINVAL.VMA goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">execute</span><span class="p">(</span><span class="n">SFENCE_VMA</span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rs2</span><span class="p">))</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_slliuw">SLLIUW</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-420fdf03f081a160465bc9fde076afbb.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 201. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SLLIUW goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sm3p0">SM3P0</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-0a2a007da68bf26a6794b35f076759ee.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 202. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SM3P0 goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">r1</span><span class="w">     </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w">  </span><span class="n">r1</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">r1</span><span class="w"> </span><span class="o">&lt;&lt;&lt;</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">r1</span><span class="w"> </span><span class="o">&lt;&lt;&lt;</span><span class="w"> </span><span class="mi">17</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sm3p1">SM3P1</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-66d50cbbfe6e15d6333fd099a3859592.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 203. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SM3P1 goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">r1</span><span class="w">     </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w">  </span><span class="n">r1</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">r1</span><span class="w"> </span><span class="o">&lt;&lt;&lt;</span><span class="w"> </span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">r1</span><span class="w"> </span><span class="o">&lt;&lt;&lt;</span><span class="w"> </span><span class="mi">23</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sm4ed">SM4ED</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-96f5f4750eeb1e0e842e01ee9c070da9.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 204. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SM4ED goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">shamt</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">bs</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b000</span><span class="p">;</span><span class="w"> </span><span class="c">/* shamt = bs*8 */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">sb_in</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">)[</span><span class="mi">7</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">x</span><span class="w">     </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mh">0x000000</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L214">sm4_sbox</a></span><span class="p">(</span><span class="n">sb_in</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">y</span><span class="w">     </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w">               </span><span class="o">&lt;&lt;</span><span class="w">  </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="w">               </span><span class="o">&lt;&lt;</span><span class="w">  </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w">
                             </span><span class="p">(</span><span class="n">x</span><span class="w">               </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">18</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">((</span><span class="n">x</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x0000003F</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">26</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w">
                             </span><span class="p">((</span><span class="n">x</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x000000C0</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">z</span><span class="w">     </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;&lt;&lt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w">                </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sm4ks">SM4KS</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-1edb9791c14c50d38785a32b134eb95e.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 205. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SM4KS goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">shamt</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">bs</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mb">0b000</span><span class="p">);</span><span class="w"> </span><span class="c">/* shamt = bs*8 */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">sb_in</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">)[</span><span class="mi">7</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">x</span><span class="w">     </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mh">0x000000</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L214">sm4_sbox</a></span><span class="p">(</span><span class="n">sb_in</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">y</span><span class="w">     </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">((</span><span class="n">x</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x00000007</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">29</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">((</span><span class="n">x</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x000000FE</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w">  </span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w">
                             </span><span class="p">((</span><span class="n">x</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x00000001</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">23</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">((</span><span class="n">x</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x000000F8</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">13</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">z</span><span class="w">     </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;&lt;&lt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sret">SRET</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-7f0b8bdced8c687c3251ffd4c2a2cb10.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 206. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for SRET goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">sret_illegal</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L13">cur_privilege</a></span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">User</span><span class="w">       </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="nb">true</span><span class="p">,</span><span class="w">
    </span><span class="n">Supervisor</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n">currentlyEnabled</span><span class="p">(</span><span class="n">Ext_S</span><span class="p">))</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L263">mstatus</a></span><span class="p">[</span><span class="n">TSR</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mb">0b1</span><span class="p">,</span><span class="w">
    </span><span class="n">Machine</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n">currentlyEnabled</span><span class="p">(</span><span class="n">Ext_S</span><span class="p">))</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">if</span><span class="w">   </span><span class="n">sret_illegal</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_exceptions.html#L14">ext_check_xret_priv</a></span><span class="w"> </span><span class="p">(</span><span class="n">Supervisor</span><span class="p">))</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="n">Ext_XRET_Priv_Failure</span><span class="p">()</span><span class="w">
  </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_pc_access.html#L24">set_next_pc</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_control.html#L264">exception_handler</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L13">cur_privilege</a></span><span class="p">,</span><span class="w"> </span><span class="n">CTL_SRET</span><span class="p">(),</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_regs.html#L11">PC</a></span><span class="p">));</span><span class="w">
    </span><span class="n">RETIRE_SUCCESS</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_store">STORE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-5dbc2fefb720d6f3dc1a9f7de2191c23.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 207. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for STORE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">imm</span><span class="p">);</span><span class="w">

  </span><span class="c">// This is checked during decoding.</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">width</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">xlen_bytes</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)[</span><span class="n">width</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vmem_utils.html#L245">vmem_write</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">offset</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">Write</span><span class="p">(</span><span class="n">Data</span><span class="p">),</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="mi">_</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">RETIRE_SUCCESS</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_store_fp">STORE.FP</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-3029e9618bb7c1d7ebfffd470a0c0a6d.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 208. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for STORE.FP goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">STORE_FP</span><span class="p">(</span><span class="n">imm</span><span class="p">,</span><span class="w"> </span><span class="n">rs2</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="c">// This is checked during decoding.</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">width</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">flen_bytes</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">imm</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">F</span><span class="p">(</span><span class="n">rs2</span><span class="p">)[</span><span class="n">width</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w">  </span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vmem_utils.html#L245">vmem_write</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">offset</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">Write</span><span class="p">(</span><span class="n">Data</span><span class="p">),</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">RETIRE_SUCCESS</span><span class="p">,</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="nb">false</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_errors.html#L20">internal_error</a></span><span class="p">(</span><span class="mi">__</span><span class="n">FILE__</span><span class="p">,</span><span class="w"> </span><span class="mi">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="s">"store got false from vmem_write"</span><span class="p">),</span><span class="w">
    </span><span class="n">Err</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_storecon">STORECON</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-c17a808d85857370d9a4538baea59544.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 209. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for STORECON goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">STORECON</span><span class="p">(</span><span class="n">aq</span><span class="p">,</span><span class="w"> </span><span class="n">rl</span><span class="p">,</span><span class="w"> </span><span class="n">rs2</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="c">// This is checked during decoding.</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">width</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">xlen_bytes</span><span class="p">);</span><span class="w">

  </span><span class="c">/* normal non-rmem case</span><span class="w">
</span><span class="c">   * RMEM: SC is allowed to succeed (but might fail later)</span><span class="w">
</span><span class="c">   */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)[</span><span class="n">width</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vmem_utils.html#L245">vmem_write</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">(),</span><span class="w"> </span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">Write</span><span class="p">(</span><span class="n">Data</span><span class="p">),</span><span class="w"> </span><span class="n">aq</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">rl</span><span class="p">,</span><span class="w"> </span><span class="n">rl</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n">bool_bits</span><span class="p">(</span><span class="err">~</span><span class="p">(</span><span class="n">b</span><span class="p">)));</span><span class="w">
      </span><span class="n">cancel_reservation</span><span class="p">();</span><span class="w">
      </span><span class="n">RETIRE_SUCCESS</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="n">Err</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_unzip">UNZIP</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-213d0d8850f3e8983ed5541a5977f12a.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 210. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for UNZIP goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">UNZIP</span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">32</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">();</span><span class="w">
  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">xlen_bytes</span><span class="o">*</span><span class="mi">4</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="p">];</span><span class="w">
    </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlen_bytes</span><span class="o">*</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_utype">UTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-c1f7f06f2c1bf74fd9ca85c3341e5cf2.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 211. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for UTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">off</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">imm</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="mh">0x000</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">LUI</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">off</span><span class="p">,</span><span class="w">
    </span><span class="n">AUIPC</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_pc_access.html#L18">get_arch_pc</a></span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">off</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vaesdf">VAESDF</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-282711e47d35f1e68bf625c31c3d8fad.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 212. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VAESDF goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">32</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_len</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L952">vstart</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">eg_len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_elem</span><span class="p">);</span><span class="w">

    </span><span class="k">let</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L185">get_velem_quad</a></span><span class="p">(</span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">rkey</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">ZVK_VAESDF_VV</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L185">get_velem_quad</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w">
      </span><span class="n">ZVK_VAESDF_VS</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L185">get_velem_quad</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w">
    </span><span class="p">};</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">sr</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L302">aes_shift_rows_inv</a></span><span class="p">(</span><span class="n">state</span><span class="p">);</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">sb</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L330">aes_subbytes_inv</a></span><span class="p">(</span><span class="n">sr</span><span class="p">);</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">ark</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">sb</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">rkey</span><span class="p">;</span><span class="w">

    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L189">write_velem_quad</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">ark</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vaesdm">VAESDM</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-9f0859f2b3626c8b2afd5bb79a759734.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 213. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VAESDM goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">32</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_len</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L952">vstart</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">eg_len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_elem</span><span class="p">);</span><span class="w">

    </span><span class="k">let</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L185">get_velem_quad</a></span><span class="p">(</span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">rkey</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">ZVK_VAESDM_VV</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L185">get_velem_quad</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w">
      </span><span class="n">ZVK_VAESDM_VS</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L185">get_velem_quad</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w">
    </span><span class="p">};</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">sr</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L302">aes_shift_rows_inv</a></span><span class="p">(</span><span class="n">state</span><span class="p">);</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">sb</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L330">aes_subbytes_inv</a></span><span class="p">(</span><span class="n">sr</span><span class="p">);</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">ark</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="n">sb</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">rkey</span><span class="p">;</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">mix</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L354">aes_mixcolumns_inv</a></span><span class="p">(</span><span class="n">ark</span><span class="p">);</span><span class="w">

    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L189">write_velem_quad</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">mix</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vaesef">VAESEF</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-bd9448dba8a09fdb7613c3d620f3e9f4.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 214. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VAESEF goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">32</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_len</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L952">vstart</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">eg_len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_elem</span><span class="p">);</span><span class="w">

    </span><span class="k">let</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L185">get_velem_quad</a></span><span class="p">(</span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">rkey</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">ZVK_VAESEF_VV</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L185">get_velem_quad</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w">
      </span><span class="n">ZVK_VAESEF_VS</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L185">get_velem_quad</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w">
    </span><span class="p">};</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">sb</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L318">aes_subbytes_fwd</a></span><span class="p">(</span><span class="n">state</span><span class="p">);</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">sr</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L285">aes_shift_rows_fwd</a></span><span class="p">(</span><span class="n">sb</span><span class="p">);</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">ark</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="n">sr</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">rkey</span><span class="p">;</span><span class="w">

    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L189">write_velem_quad</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">ark</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vaesem">VAESEM</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-9cdfe06f6e6575555b7c71e5ee1745fb.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 215. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VAESEM goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">32</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_len</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L952">vstart</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">eg_len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_elem</span><span class="p">);</span><span class="w">

    </span><span class="k">let</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L185">get_velem_quad</a></span><span class="p">(</span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">rkey</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">ZVK_VAESEM_VV</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L185">get_velem_quad</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w">
      </span><span class="n">ZVK_VAESEM_VS</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L185">get_velem_quad</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w">
    </span><span class="p">};</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">sb</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L318">aes_subbytes_fwd</a></span><span class="p">(</span><span class="n">state</span><span class="p">);</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">sr</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L285">aes_shift_rows_fwd</a></span><span class="p">(</span><span class="n">sb</span><span class="p">);</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">mix</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L342">aes_mixcolumns_fwd</a></span><span class="p">(</span><span class="n">sr</span><span class="p">);</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">ark</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="n">mix</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">rkey</span><span class="p">;</span><span class="w">

    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L189">write_velem_quad</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">ark</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vaeskf1_vi">VAESKF1.VI</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-3cc7da6daa422c307111ca25cc12081f.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 216. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VAESKF1.VI goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">32</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">var</span><span class="w"> </span><span class="n">rnd_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rnd</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n">rnd_val</span><span class="p">[</span><span class="mi">3</span><span class="o">..</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n">rnd_val</span><span class="p">[</span><span class="mi">3</span><span class="o">..</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="n">rnd_val</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L23">not_bit</a></span><span class="p">(</span><span class="n">rnd_val</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rnd_val</span><span class="p">[</span><span class="mi">3</span><span class="o">..</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">var</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vector_init</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_len</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L952">vstart</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">eg_len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_elem</span><span class="p">);</span><span class="w">

    </span><span class="k">let</span><span class="w"> </span><span class="n">current_round_key</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L209">get_velem_quad_vec</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">

    </span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L194">aes_subword_fwd</a></span><span class="p">(</span><span class="n">current_round_key</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w">
           </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L86">aes_decode_rcon</a></span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">current_round_key</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w">
    </span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">current_round_key</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="w">
    </span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">current_round_key</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="w">
    </span><span class="n">w</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">current_round_key</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span><span class="w">

    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L213">write_velem_quad_vec</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vaeskf2_vi">VAESKF2.VI</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-a46b130ff07e66ad6b6b4d6f9f8f29a9.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 217. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VAESKF2.VI goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">32</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">var</span><span class="w"> </span><span class="n">rnd_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rnd</span><span class="p">[</span><span class="mi">3</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n">rnd_val</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n">rnd_val</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="n">rnd_val</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L23">not_bit</a></span><span class="p">(</span><span class="n">rnd_val</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span><span class="w">

  </span><span class="k">var</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vector_init</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_len</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L952">vstart</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">eg_len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_elem</span><span class="p">);</span><span class="w">

    </span><span class="k">let</span><span class="w"> </span><span class="n">current_round_key</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L209">get_velem_quad_vec</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">round_key_b</span><span class="w">       </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L209">get_velem_quad_vec</a></span><span class="p">(</span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">

    </span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rnd_val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="p">)</span><span class="w">
           </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L194">aes_subword_fwd</a></span><span class="p">(</span><span class="n">current_round_key</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">round_key_b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w">
           </span><span class="k">else</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L194">aes_subword_fwd</a></span><span class="p">(</span><span class="n">current_round_key</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w">
                </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_types_kext.html#L86">aes_decode_rcon</a></span><span class="p">((</span><span class="n">rnd_val</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">round_key_b</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w">
    </span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">round_key_b</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="w">
    </span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">round_key_b</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="w">
    </span><span class="n">w</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">round_key_b</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span><span class="w">

    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L213">write_velem_quad_vec</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vaesz_vs">VAESZ.VS</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-b238dbdde3a949f11606a29d76e4f3e3.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 218. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VAESZ.VS goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">32</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_len</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L952">vstart</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">eg_len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_elem</span><span class="p">);</span><span class="w">

    </span><span class="k">let</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L185">get_velem_quad</a></span><span class="p">(</span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">rkey</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L185">get_velem_quad</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">ark</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">rkey</span><span class="p">;</span><span class="w">

    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L189">write_velem_quad</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">ark</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vandn_vv">VANDN.VV</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-7297a2a614d282eafa4dc382dbbc953c.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 219. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VANDN.VV goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="err">~</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vandn_vx">VANDN.VX</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-ce23f88ad16637fef3ccba0e6402c4e5.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 220. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VANDN.VX goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L173">get_scalar</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="err">~</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vbrev_v">VBREV.V</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-f6bdebdf568a26d4bff0eed62205cf7e.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 221. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VBREV.V goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">var</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">();</span><span class="w">
      </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w">
        </span><span class="n">output</span><span class="p">[</span><span class="n">SEW</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">output</span><span class="p">;</span><span class="w">
    </span><span class="p">};</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vbrev8_v">VBREV8.V</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-c137621c8b56b4e0bdd42a306a9ac8e9.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 222. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VBREV8.V goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./arithmetic.html#L11">brev8</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
    </span><span class="p">};</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vclmul_vv">VCLMUL.VV</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-9a21be49852a52ddab0f7c4c1f0fdf71.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 223. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VCLMUL.VV goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">       </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="nv">'n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">prod</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./arithmetic.html#L20">carryless_mul</a></span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">prod</span><span class="p">[</span><span class="nv">'m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">];</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vclmul_vx">VCLMUL.VX</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-8ce636161d8eaed1ade15bbe0d4decef.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 224. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VCLMUL.VX goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">       </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L173">get_scalar</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="nv">'n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">prod</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./arithmetic.html#L20">carryless_mul</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">prod</span><span class="p">[</span><span class="nv">'m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">];</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vclmulh_vv">VCLMULH.VV</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-fba32beef38b3391cd5f944c049ed0ee.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 225. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VCLMULH.VV goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">       </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="nv">'n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">prod</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./arithmetic.html#L20">carryless_mul</a></span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">prod</span><span class="p">[</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="n">SEW</span><span class="p">];</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vclmulh_vx">VCLMULH.VX</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-baf9b59dcc34d47f5a1ba5d41e554ffa.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 226. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VCLMULH.VX goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">       </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L173">get_scalar</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="nv">'n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">prod</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./arithmetic.html#L20">carryless_mul</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">prod</span><span class="p">[</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="n">SEW</span><span class="p">];</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vclz_v">VCLZ.V</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-16d3a9feddd01ea4da59fef5291a2c6b.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 227. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VCLZ.V goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">clz</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">count_leading_zeros</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L118">to_bits</a></span><span class="p">(</span><span class="n">clz</span><span class="p">);</span><span class="w">
    </span><span class="p">};</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vcpop_m">VCPOP.M</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-2f4515da598ce4947069155152875b39.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 228. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VCPOP.M goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">VLEN</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L116">illegal_vd_unmasked</a></span><span class="p">()</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L48">assert_vstart</a></span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="mi">_</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L379">init_masked_result_cmp</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="k">var</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">nat</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">
  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mask</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">xlen</span><span class="p">,</span><span class="w"> </span><span class="n">count</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vcpop_v">VCPOP.V</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-5093e8522f53cef829a1ebbee5a3a78b.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 229. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VCPOP.V goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="k">if</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
        </span><span class="p">};</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">};</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vctz_v">VCTZ.V</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-267af4484f4a01655f27604e9ee3fa96.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 230. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VCTZ.V goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">ctz</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">count_trailing_zeros</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L118">to_bits</a></span><span class="p">(</span><span class="n">ctz</span><span class="p">);</span><span class="w">
    </span><span class="p">};</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vexttype">VEXTTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-f51106dd5c45187525fb2f925bb64e38.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 231. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VEXTTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_frac_pow</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">}</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">VEXT2_ZVF2</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w">  </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="n">VEXT2_SVF2</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w">  </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="n">VEXT4_ZVF4</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w">  </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="n">VEXT4_SVF4</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w">  </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="n">VEXT8_ZVF8</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w">  </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="n">VEXT8_SVF8</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w">  </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_div</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SEW_frac_pow</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_div</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">2 ^</span><span class="w"> </span><span class="n">SEW_frac_pow</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w">  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L125">illegal_variable_width</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_div</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_div</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_div</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">))</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW_div</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_div</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_div</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_div</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">VEXT2_ZVF2</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">VEXT2_SVF2</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">VEXT4_ZVF4</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">VEXT4_SVF4</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">VEXT8_ZVF8</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">VEXT8_SVF8</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vfirst_m">VFIRST.M</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-6ab1940b3bc3f511313a60dfe533eaab.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 232. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VFIRST.M goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">VLEN</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L116">illegal_vd_unmasked</a></span><span class="p">()</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L48">assert_vstart</a></span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="mi">_</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L379">init_masked_result_cmp</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="k">var</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="w">
  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mask</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w">
    </span><span class="p">};</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">xlen</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vfmerge">VFMERGE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-aeacfcd81d0e318848e880751d5ab165.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 233. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VFMERGE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w">         </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L429">fcsr</a></span><span class="p">[</span><span class="n">FRM</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">start_element</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">nat</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L220">get_start_element</a></span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">end_element</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L236">get_end_element</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">           </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w"> </span><span class="c">/* max(VLMAX,VLEN/SEW)) */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">real_num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">);</span><span class="w"> </span><span class="c">/* VLMAX */</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L33">illegal_fp_vd_masked</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">rm_3b</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L165">get_scalar_fp</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="nv">'m</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vector_init</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">tail_ag</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">agtype</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1036">get_vtype_vta</a></span><span class="p">();</span><span class="w">
  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">start_element</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">end_element</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">real_num_elem</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">tail_ag</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">UNDISTURBED</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">AGNOSTIC</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="c">/* TODO: configuration support */</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="c">/* the merge operates on all body elements */</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">vm_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vfmv">VFMV</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-b5928d5873247caf2bb6f2586c7b4aa3.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 234. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VFMV goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L429">fcsr</a></span><span class="p">[</span><span class="n">FRM</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L39">illegal_fp_vd_unmasked</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">rm_3b</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L165">get_scalar_fp</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="nv">'m</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b1</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rs1_val</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vfmvfs">VFMVFS</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-60c368ffcad01b36d223b4ceb0ec419a.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 235. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VFMVFS goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L429">fcsr</a></span><span class="p">[</span><span class="n">FRM</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L39">illegal_fp_vd_unmasked</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">rm_3b</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">flen</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="mi">16</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">F_H</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w">
    </span><span class="mi">32</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">F_S</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w">
    </span><span class="mi">64</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">F_D</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">

  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vfmvsf">VFMVSF</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-e1963ec772389e8cbdab04f7c0711ed3.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 236. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VFMVSF goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L429">fcsr</a></span><span class="p">[</span><span class="n">FRM</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L39">illegal_fp_vd_unmasked</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">rm_3b</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b1</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L165">get_scalar_fp</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="nv">'m</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="c">/* one body element */</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">;</span><span class="w">

  </span><span class="c">/* others treated as tail elements */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">tail_ag</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">agtype</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1036">get_vtype_vta</a></span><span class="p">();</span><span class="w">
  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">tail_ag</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">UNDISTURBED</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
      </span><span class="n">AGNOSTIC</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="c">/* TODO: configuration support */</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vfnunary0">VFNUNARY0</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-94af9372ab43a3636df2012ab9fcfecb.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 237. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VFNUNARY0 goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L429">fcsr</a></span><span class="p">[</span><span class="n">FRM</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w">  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L45">illegal_fp_variable_width</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">))</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">vfnunary0</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">FNV_CVT_XU_F</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="mi">8</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L438">riscv_f16ToUi8</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">16</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L445">riscv_f32ToUi16</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">32</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L307">riscv_f64ToUi32</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                              </span><span class="p">};</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                              </span><span class="n">elem</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">FNV_CVT_X_F</span><span class="w">      </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="mi">8</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L415">riscv_f16ToI8</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">16</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L423">riscv_f32ToI16</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">32</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L300">riscv_f64ToI32</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                              </span><span class="p">};</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                              </span><span class="n">elem</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">FNV_CVT_F_XU</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="mi">8</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
                                </span><span class="mi">16</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L208">riscv_ui32ToF16</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">32</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L293">riscv_ui64ToF32</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                              </span><span class="p">};</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                              </span><span class="n">elem</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">FNV_CVT_F_X</span><span class="w">      </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="mi">8</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
                                </span><span class="mi">16</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L201">riscv_i32ToF16</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">32</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L286">riscv_i64ToF32</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                              </span><span class="p">};</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                              </span><span class="n">elem</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">FNV_CVT_F_F</span><span class="w">      </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="mi">8</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
                                </span><span class="mi">16</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L377">riscv_f32ToF16</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">32</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L391">riscv_f64ToF32</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                              </span><span class="p">};</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                              </span><span class="n">elem</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">FNV_CVT_ROD_F_F</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="mi">8</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
                                </span><span class="mi">16</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L377">riscv_f32ToF16</a></span><span class="p">(</span><span class="mb">0b110</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">32</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L391">riscv_f64ToF32</a></span><span class="p">(</span><span class="mb">0b110</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                              </span><span class="p">};</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                              </span><span class="n">elem</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">FNV_CVT_RTZ_XU_F</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="mi">8</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L438">riscv_f16ToUi8</a></span><span class="p">(</span><span class="mb">0b001</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">16</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L445">riscv_f32ToUi16</a></span><span class="p">(</span><span class="mb">0b001</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">32</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L307">riscv_f64ToUi32</a></span><span class="p">(</span><span class="mb">0b001</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                              </span><span class="p">};</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                              </span><span class="n">elem</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">FNV_CVT_RTZ_X_F</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="mi">8</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L415">riscv_f16ToI8</a></span><span class="p">(</span><span class="mb">0b001</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">16</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L423">riscv_f32ToI16</a></span><span class="p">(</span><span class="mb">0b001</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">32</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L300">riscv_f64ToI32</a></span><span class="p">(</span><span class="mb">0b001</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                              </span><span class="p">};</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                              </span><span class="n">elem</span><span class="w">
                            </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vfunary0">VFUNARY0</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-72f8b8ccfef16e7cd2a7a315b84ed628.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 238. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VFUNARY0 goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L429">fcsr</a></span><span class="p">[</span><span class="n">FRM</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L27">illegal_fp_normal</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">rm_3b</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">vfunary0</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">FV_CVT_XU_F</span><span class="w">      </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="mi">16</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L431">riscv_f16ToUi16</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">32</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L251">riscv_f32ToUi32</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">64</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L335">riscv_f64ToUi64</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                              </span><span class="p">};</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                              </span><span class="n">elem</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">FV_CVT_X_F</span><span class="w">       </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="mi">16</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L407">riscv_f16ToI16</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">32</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L244">riscv_f32ToI32</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">64</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L328">riscv_f64ToI64</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                              </span><span class="p">};</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                              </span><span class="n">elem</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">FV_CVT_F_XU</span><span class="w">      </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="mi">16</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L208">riscv_ui32ToF16</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
                                </span><span class="mi">32</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L265">riscv_ui32ToF32</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">64</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L349">riscv_ui64ToF64</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                              </span><span class="p">};</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                              </span><span class="n">elem</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">FV_CVT_F_X</span><span class="w">       </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="mi">16</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L201">riscv_i32ToF16</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
                                </span><span class="mi">32</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L258">riscv_i32ToF32</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">64</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L342">riscv_i64ToF64</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                              </span><span class="p">};</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                              </span><span class="n">elem</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">FV_CVT_RTZ_XU_F</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="mi">16</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L431">riscv_f16ToUi16</a></span><span class="p">(</span><span class="mb">0b001</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">32</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L251">riscv_f32ToUi32</a></span><span class="p">(</span><span class="mb">0b001</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">64</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L335">riscv_f64ToUi64</a></span><span class="p">(</span><span class="mb">0b001</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                              </span><span class="p">};</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                              </span><span class="n">elem</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">FV_CVT_RTZ_X_F</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="mi">16</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L407">riscv_f16ToI16</a></span><span class="p">(</span><span class="mb">0b001</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">32</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L244">riscv_f32ToI32</a></span><span class="p">(</span><span class="mb">0b001</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">64</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L328">riscv_f64ToI64</a></span><span class="p">(</span><span class="mb">0b001</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                              </span><span class="p">};</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                              </span><span class="n">elem</span><span class="w">
                            </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vfunary1">VFUNARY1</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-fdfae48202f8b73235d13005f8448fe5.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 239. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VFUNARY1 goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L429">fcsr</a></span><span class="p">[</span><span class="n">FRM</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L27">illegal_fp_normal</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">rm_3b</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">vfunary1</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">FVV_VSQRT</span><span class="w">      </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                            </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="mi">16</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L163">riscv_f16Sqrt</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                              </span><span class="mi">32</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L170">riscv_f32Sqrt</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                              </span><span class="mi">64</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L177">riscv_f64Sqrt</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                            </span><span class="p">};</span><span class="w">
                            </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                            </span><span class="n">elem</span><span class="w">
                          </span><span class="p">},</span><span class="w">
        </span><span class="n">FVV_VRSQRT7</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                            </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="mi">16</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L497">riscv_f16Rsqrte7</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                              </span><span class="mi">32</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L513">riscv_f32Rsqrte7</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                              </span><span class="mi">64</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L529">riscv_f64Rsqrte7</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                            </span><span class="p">};</span><span class="w">
                            </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                            </span><span class="n">elem</span><span class="w">
                          </span><span class="p">},</span><span class="w">
        </span><span class="n">FVV_VREC7</span><span class="w">      </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                            </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="mi">16</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L603">riscv_f16Recip7</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                              </span><span class="mi">32</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L620">riscv_f32Recip7</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                              </span><span class="mi">64</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L637">riscv_f64Recip7</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                            </span><span class="p">};</span><span class="w">
                            </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                            </span><span class="n">elem</span><span class="w">
                          </span><span class="p">},</span><span class="w">
        </span><span class="n">FVV_VCLASS</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L377">fp_class</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vfwunary0">VFWUNARY0</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-b902e6cd47d34a81937c4e017bfc1b25.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 240. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VFWUNARY0 goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rm_3b</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L429">fcsr</a></span><span class="p">[</span><span class="n">FRM</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w">  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_fp_utils.html#L45">illegal_fp_variable_width</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">))</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">vfwunary0</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">FWV_CVT_XU_F</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="mi">8</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
                                </span><span class="mi">16</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L194">riscv_f16ToUi32</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">32</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L279">riscv_f32ToUi64</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                              </span><span class="p">};</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                              </span><span class="n">elem</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">FWV_CVT_X_F</span><span class="w">      </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="mi">8</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
                                </span><span class="mi">16</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L187">riscv_f16ToI32</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">32</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L272">riscv_f32ToI64</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                              </span><span class="p">};</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                              </span><span class="n">elem</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">FWV_CVT_F_XU</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="mi">8</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L208">riscv_ui32ToF16</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
                                </span><span class="mi">16</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L265">riscv_ui32ToF32</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
                                </span><span class="mi">32</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L321">riscv_ui32ToF64</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                              </span><span class="p">};</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                              </span><span class="n">elem</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">FWV_CVT_F_X</span><span class="w">      </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="mi">8</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L201">riscv_i32ToF16</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
                                </span><span class="mi">16</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L258">riscv_i32ToF32</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
                                </span><span class="mi">32</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L314">riscv_i32ToF64</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                              </span><span class="p">};</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                              </span><span class="n">elem</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">FWV_CVT_F_F</span><span class="w">      </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="mi">8</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
                                </span><span class="mi">16</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L356">riscv_f16ToF32</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">32</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L370">riscv_f32ToF64</a></span><span class="p">(</span><span class="n">rm_3b</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                              </span><span class="p">};</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                              </span><span class="n">elem</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">FWV_CVT_RTZ_XU_F</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="mi">8</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
                                </span><span class="mi">16</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L194">riscv_f16ToUi32</a></span><span class="p">(</span><span class="mb">0b001</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">32</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L279">riscv_f32ToUi64</a></span><span class="p">(</span><span class="mb">0b001</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                              </span><span class="p">};</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                              </span><span class="n">elem</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">FWV_CVT_RTZ_X_F</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">fflags</span><span class="p">,</span><span class="w"> </span><span class="n">elem</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">bits_fflags</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="mi">8</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
                                </span><span class="mi">16</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L187">riscv_f16ToI32</a></span><span class="p">(</span><span class="mb">0b001</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
                                </span><span class="mi">32</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_softfloat_interface.html#L272">riscv_f32ToI64</a></span><span class="p">(</span><span class="mb">0b001</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
                              </span><span class="p">};</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_fdext_regs.html#L440">accrue_fflags</a></span><span class="p">(</span><span class="n">fflags</span><span class="p">);</span><span class="w">
                              </span><span class="n">elem</span><span class="w">
                            </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vghsh_vv">VGHSH.VV</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-c0911e2f4e8d7b0cdd46fef86a12c102.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 241. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VGHSH.VV goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">32</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_len</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L952">vstart</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">eg_len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_elem</span><span class="p">);</span><span class="w">

    </span><span class="k">let</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L185">get_velem_quad</a></span><span class="p">(</span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L185">get_velem_quad</a></span><span class="p">(</span><span class="n">vs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
    </span><span class="k">var</span><span class="w"> </span><span class="n">H</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./arithmetic.html#L11">brev8</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L185">get_velem_quad</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">));</span><span class="w">

    </span><span class="k">var</span><span class="w"> </span><span class="n">Z</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">();</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./arithmetic.html#L11">brev8</a></span><span class="p">(</span><span class="n">Y</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">X</span><span class="p">);</span><span class="w">

    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">127</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="n">S</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">Z</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Z</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">H</span><span class="p">;</span><span class="w">

      </span><span class="k">let</span><span class="w"> </span><span class="n">reduce</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">H</span><span class="p">[</span><span class="mi">127</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="p">;</span><span class="w">
      </span><span class="n">H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">H</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="n">reduce</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">H</span><span class="p">[</span><span class="mi">127</span><span class="o">..</span><span class="mi">8</span><span class="p">]</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="mi">7</span><span class="o">..</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="mh">0x87</span><span class="p">);</span><span class="w">
    </span><span class="p">};</span><span class="w">

    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L189">write_velem_quad</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./arithmetic.html#L11">brev8</a></span><span class="p">(</span><span class="n">Z</span><span class="p">),</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vgmul_vv">VGMUL.VV</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-8d11cf21ae553601e452b062a8366111.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 242. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VGMUL.VV goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">32</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_len</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L952">vstart</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">eg_len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_elem</span><span class="p">);</span><span class="w">

    </span><span class="k">let</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./arithmetic.html#L11">brev8</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L185">get_velem_quad</a></span><span class="p">(</span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">));</span><span class="w">
    </span><span class="k">var</span><span class="w"> </span><span class="n">H</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./arithmetic.html#L11">brev8</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L185">get_velem_quad</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">));</span><span class="w">
    </span><span class="k">var</span><span class="w"> </span><span class="n">Z</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">();</span><span class="w">

    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">127</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="n">Y</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">Z</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Z</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">H</span><span class="p">;</span><span class="w">

      </span><span class="k">let</span><span class="w"> </span><span class="n">reduce</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">H</span><span class="p">[</span><span class="mi">127</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="p">;</span><span class="w">
      </span><span class="n">H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">H</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="n">reduce</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">H</span><span class="p">[</span><span class="mi">127</span><span class="o">..</span><span class="mi">8</span><span class="p">]</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="mi">7</span><span class="o">..</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="mh">0x87</span><span class="p">);</span><span class="w">
    </span><span class="p">};</span><span class="w">

    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L189">write_velem_quad</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./arithmetic.html#L11">brev8</a></span><span class="p">(</span><span class="n">Z</span><span class="p">),</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vicmptype">VICMPTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-2449d412cb937e514abe7629a60cd0b5.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 243. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VICMPTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L116">illegal_vd_unmasked</a></span><span class="p">()</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">imm_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">                  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">simm</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L379">init_masked_result_cmp</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">VICMP_VMSEQ</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">imm_val</span><span class="p">,</span><span class="w">
        </span><span class="n">VICMP_VMSNE</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">imm_val</span><span class="p">,</span><span class="w">
        </span><span class="n">VICMP_VMSLEU</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">imm_val</span><span class="p">),</span><span class="w">
        </span><span class="n">VICMP_VMSLE</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">imm_val</span><span class="p">),</span><span class="w">
        </span><span class="n">VICMP_VMSGTU</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">imm_val</span><span class="p">),</span><span class="w">
        </span><span class="n">VICMP_VMSGT</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">imm_val</span><span class="p">)</span><span class="w">
      </span><span class="p">};</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L110">bool_to_bit</a></span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L409">write_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vid_v">VID.V</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-bdd32b6a8d3aad8f6bc5ba23a8af38b9.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 244. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VID.V goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L99">illegal_normal</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vimctype">VIMCTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-757db21fd46e13f9a6a7f56769d68575.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 245. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VIMCTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L116">illegal_vd_unmasked</a></span><span class="p">()</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">imm_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">simm</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L340">init_masked_result_carry</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">VIMC_VMADC</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">imm_val</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w">
      </span><span class="p">};</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L110">bool_to_bit</a></span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L409">write_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vimstype">VIMSTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-59b7f430f455a6894d572bd8dc4ae0b3.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 246. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VIMSTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L105">illegal_vd_masked</a></span><span class="p">(</span><span class="n">vd</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="c">/* for bypassing normal masking in init_masked_result */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vec_trues</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L92">ones</a></span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L391">read_vmask_carry</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">imm_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">                  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">simm</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vec_trues</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">VIMS_VADC</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">imm_val</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="n">vm_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vimtype">VIMTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-59b7f430f455a6894d572bd8dc4ae0b3.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 247. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VIMTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L116">illegal_vd_unmasked</a></span><span class="p">()</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L391">read_vmask_carry</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">imm_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">                  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">simm</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L340">init_masked_result_carry</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">VIM_VMADC</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">imm_val</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="n">vm_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w">
      </span><span class="p">};</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L110">bool_to_bit</a></span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L409">write_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_viota_m">VIOTA.M</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-454037369bdec70cae793c31348f7cde.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 248. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VIOTA.M goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L99">illegal_normal</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L48">assert_vstart</a></span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">vd</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">vs2</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">var</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">
  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">sum</span><span class="p">);</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_visg">VISG</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-2449d412cb937e514abe7629a60cd0b5.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 249. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VISG goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_pow</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L997">get_sew_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L99">illegal_normal</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">imm_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">nat</span><span class="w">                  </span><span class="p">=</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n">xlen</span><span class="p">,</span><span class="w"> </span><span class="n">simm</span><span class="p">));</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">VI_VSLIDEUP</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">vs2</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">vd</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
                            </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">imm_val</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">imm_val</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w">
                          </span><span class="p">},</span><span class="w">
        </span><span class="n">VI_VSLIDEDOWN</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                            </span><span class="k">let</span><span class="w"> </span><span class="n">VLMAX</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="p">(</span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">VLEN_pow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SEW_pow</span><span class="p">);</span><span class="w">
                            </span><span class="n">assert</span><span class="p">(</span><span class="n">VLMAX</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">VLMAX</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nv">'n</span><span class="p">);</span><span class="w">
                            </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">imm_val</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">VLMAX</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">imm_val</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">()</span><span class="w">
                          </span><span class="p">},</span><span class="w">
        </span><span class="n">VI_VRGATHER</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">vs2</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">vd</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
                            </span><span class="k">let</span><span class="w"> </span><span class="n">VLMAX</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="p">(</span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">VLEN_pow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SEW_pow</span><span class="p">);</span><span class="w">
                            </span><span class="n">assert</span><span class="p">(</span><span class="n">VLMAX</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">VLMAX</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nv">'n</span><span class="p">);</span><span class="w">
                            </span><span class="k">if</span><span class="w"> </span><span class="n">imm_val</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">VLMAX</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">imm_val</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">()</span><span class="w">
                          </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vitype">VITYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-2449d412cb937e514abe7629a60cd0b5.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 250. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VITYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L99">illegal_normal</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">imm_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">simm</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">VI_VADD</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">imm_val</span><span class="p">,</span><span class="w">
        </span><span class="n">VI_VRSUB</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">imm_val</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">VI_VAND</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">imm_val</span><span class="p">,</span><span class="w">
        </span><span class="n">VI_VOR</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">imm_val</span><span class="p">,</span><span class="w">
        </span><span class="n">VI_VXOR</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">imm_val</span><span class="p">,</span><span class="w">
        </span><span class="n">VI_VSADDU</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L472">unsigned_saturation</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">imm_val</span><span class="p">)</span><span class="w"> </span><span class="p">),</span><span class="w">
        </span><span class="n">VI_VSADD</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L483">signed_saturation</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">imm_val</span><span class="p">)</span><span class="w"> </span><span class="p">),</span><span class="w">
        </span><span class="n">VI_VSLL</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">simm</span><span class="p">),</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
                        </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="w">
                      </span><span class="p">},</span><span class="w">
        </span><span class="n">VI_VSRL</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">simm</span><span class="p">),</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
                        </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="w">
                      </span><span class="p">},</span><span class="w">
        </span><span class="n">VI_VSRA</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">simm</span><span class="p">),</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">v_double</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                        </span><span class="n">slice</span><span class="p">(</span><span class="n">v_double</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w">
                      </span><span class="p">},</span><span class="w">
        </span><span class="n">VI_VSSRL</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">simm</span><span class="p">),</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">rounding_incr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L455">get_fixed_rounding_incr</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">);</span><span class="w">
                        </span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">rounding_incr</span><span class="p">)</span><span class="w">
                      </span><span class="p">},</span><span class="w">
        </span><span class="n">VI_VSSRA</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">simm</span><span class="p">),</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">rounding_incr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L455">get_fixed_rounding_incr</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">);</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">v_double</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                        </span><span class="n">slice</span><span class="p">(</span><span class="n">v_double</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">rounding_incr</span><span class="p">)</span><span class="w">
                      </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vloxsegtype">VLOXSEGTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-78fc0c099dc349c92f39da62f983fac7.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 251. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VLOXSEGTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW_index_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vlewidth_pow</span><span class="p">(</span><span class="n">width</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW_index_bytes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vlewidth_bytesnumber</span><span class="p">(</span><span class="n">width</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW_data_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L997">get_sew_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW_data_bytes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1011">get_sew_bytes</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EMUL_data_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EMUL_index_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">EEW_index_pow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">EEW_data_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">EMUL_data_pow</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">EMUL_data_pow</span><span class="p">,</span><span class="w"> </span><span class="n">EEW_data_bytes</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">nf_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nfields_int</span><span class="p">(</span><span class="n">nf</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L159">illegal_indexed_load</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">nf_int</span><span class="p">,</span><span class="w"> </span><span class="n">EEW_index_bytes</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_index_pow</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_data_pow</span><span class="p">)</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_mem.html#L398">process_vlxseg</a></span><span class="p">(</span><span class="n">nf_int</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">EEW_index_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">EEW_data_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_index_pow</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_data_pow</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vlretype">VLRETYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-01f27e99ee72e74850e4891d66b33a94.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 252. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VLRETYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">load_width_bytes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vlewidth_bytesnumber</span><span class="p">(</span><span class="n">width</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">load_width_bytes</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">elem_per_reg</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">VLEN</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">EEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">nf_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nfields_int</span><span class="p">(</span><span class="n">nf</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">elem_per_reg</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n">nf_int</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">nf_int</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">nf_int</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">nf_int</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_mem.html#L579">process_vlre</a></span><span class="p">(</span><span class="n">nf_int</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">load_width_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">elem_per_reg</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vlsegfftype">VLSEGFFTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-d8e64a970ea66e4be7082430d843c300.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 253. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VLSEGFFTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">load_width_bytes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vlewidth_bytesnumber</span><span class="p">(</span><span class="n">width</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">load_width_bytes</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vlewidth_pow</span><span class="p">(</span><span class="n">width</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L997">get_sew_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">EEW_pow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SEW_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">EMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">EEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">nf_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nfields_int</span><span class="p">(</span><span class="n">nf</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L146">illegal_load</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">nf_int</span><span class="p">,</span><span class="w"> </span><span class="n">EEW</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_pow</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_mem.html#L141">process_vlsegff</a></span><span class="p">(</span><span class="n">nf_int</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">load_width_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">num_elem</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vlsegtype">VLSEGTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-bb54f78d71497f9f864285a24995fd0d.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 254. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VLSEGTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">load_width_bytes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vlewidth_bytesnumber</span><span class="p">(</span><span class="n">width</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">load_width_bytes</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vlewidth_pow</span><span class="p">(</span><span class="n">width</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L997">get_sew_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">EEW_pow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SEW_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">EMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">EEW</span><span class="p">);</span><span class="w"> </span><span class="c">/* # of element of each register group */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">nf_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nfields_int</span><span class="p">(</span><span class="n">nf</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L146">illegal_load</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">nf_int</span><span class="p">,</span><span class="w"> </span><span class="n">EEW</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_pow</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_mem.html#L80">process_vlseg</a></span><span class="p">(</span><span class="n">nf_int</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">load_width_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">num_elem</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vlssegtype">VLSSEGTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-28a4c0adf13c61336e0ac2dcfb85b713.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 255. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VLSSEGTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">load_width_bytes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vlewidth_bytesnumber</span><span class="p">(</span><span class="n">width</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">load_width_bytes</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vlewidth_pow</span><span class="p">(</span><span class="n">width</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L997">get_sew_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">EEW_pow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SEW_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">EMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">EEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">nf_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nfields_int</span><span class="p">(</span><span class="n">nf</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L146">illegal_load</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">nf_int</span><span class="p">,</span><span class="w"> </span><span class="n">EEW</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_pow</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_mem.html#L277">process_vlsseg</a></span><span class="p">(</span><span class="n">nf_int</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">load_width_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rs2</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">num_elem</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vluxsegtype">VLUXSEGTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-f1df667ad725c171d0fa969be87267d8.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 256. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VLUXSEGTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW_index_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vlewidth_pow</span><span class="p">(</span><span class="n">width</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW_index_bytes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vlewidth_bytesnumber</span><span class="p">(</span><span class="n">width</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW_data_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L997">get_sew_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW_data_bytes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1011">get_sew_bytes</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EMUL_data_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EMUL_index_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">EEW_index_pow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">EEW_data_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">EMUL_data_pow</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">EMUL_data_pow</span><span class="p">,</span><span class="w"> </span><span class="n">EEW_data_bytes</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">nf_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nfields_int</span><span class="p">(</span><span class="n">nf</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L159">illegal_indexed_load</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">nf_int</span><span class="p">,</span><span class="w"> </span><span class="n">EEW_index_bytes</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_index_pow</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_data_pow</span><span class="p">)</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_mem.html#L398">process_vlxseg</a></span><span class="p">(</span><span class="n">nf_int</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">EEW_index_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">EEW_data_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_index_pow</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_data_pow</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vmsbf_m">VMSBF.M</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-a057c7df74bdac4cf0b55a0a390e409a.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 257. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VMSBF.M goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">VLEN</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L99">illegal_normal</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L48">assert_vstart</a></span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">vd</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">vs2</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L379">init_masked_result_cmp</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">var</span><span class="w"> </span><span class="n">found_elem</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w">
  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">found_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L110">bool_to_bit</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n">found_elem</span><span class="p">))</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L409">write_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vmsif_m">VMSIF.M</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-4e65a37307c46d405c0acb2b921e4a69.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 258. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VMSIF.M goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">VLEN</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L99">illegal_normal</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L48">assert_vstart</a></span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">vd</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">vs2</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L379">init_masked_result_cmp</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">var</span><span class="w"> </span><span class="n">found_elem</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w">
  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L110">bool_to_bit</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n">found_elem</span><span class="p">));</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">found_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">true</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L409">write_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vmsof_m">VMSOF.M</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-781cd2930e6a4fcdb84d82f277dd3dfc.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 259. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VMSOF.M goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">VLEN</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L99">illegal_normal</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L48">assert_vstart</a></span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">vd</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">vs2</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L379">init_masked_result_cmp</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">var</span><span class="w"> </span><span class="n">found_elem</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w">
  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n">found_elem</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">bitone</span><span class="p">;</span><span class="w">
        </span><span class="n">found_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">true</span><span class="w">
      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">bitzero</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L409">write_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vmtype">VMTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-b01b1bdedbb7bb540a500a8019367e49.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 260. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VMTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vl_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">evl</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">vl_val</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">vl_val</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">vl_val</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c">/* the effective vector length is evl=ceil(vl/8) */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">EMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">EEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L116">illegal_vd_unmasked</a></span><span class="p">()</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">evl</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_mem.html#L713">process_vm</a></span><span class="p">(</span><span class="n">vd_or_vs3</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">evl</span><span class="p">,</span><span class="w"> </span><span class="n">op</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vmvrtype">VMVRTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-594c39bac67ddb6706e0044429ad9ab5.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 261. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VMVRTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">start_element</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">nat</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L220">get_start_element</a></span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EMUL</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="n">nreg</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">EMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L229">log2</a></span><span class="p">(</span><span class="n">EMUL</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">EMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b1</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vector_init</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">start_element</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vmvsx">VMVSX</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-64e0fc3f97715997c51b3f1c8bab5370.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 262. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VMVSX goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L116">illegal_vd_unmasked</a></span><span class="p">()</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b1</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L173">get_scalar</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="nv">'m</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="c">/* one body element */</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">;</span><span class="w">

  </span><span class="c">/* others treated as tail elements */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">tail_ag</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">agtype</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1036">get_vtype_vta</a></span><span class="p">();</span><span class="w">
  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">tail_ag</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">UNDISTURBED</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
      </span><span class="n">AGNOSTIC</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="c">/* TODO: configuration support */</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vmvxs">VMVXS</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-9527cf38f5faba48493a19373105e2f2.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 263. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VMVXS goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L116">illegal_vd_unmasked</a></span><span class="p">()</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">xlen</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">slice</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">xlen</span><span class="p">)</span><span class="w">
          </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">xlen</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="w">
          </span><span class="k">else</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">

  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vrev8_v">VREV8.V</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-6d6bbaae12dcaacbcb0cd533a03c63bc.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 264. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VREV8.V goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./arithmetic.html#L53">rev8</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
    </span><span class="p">};</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vrol_vv">VROL.VV</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-87eba0c36a493fa70d65a919bffa1d4a.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 265. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VROL.VV goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_pow</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L997">get_sew_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="n">SEW_pow</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;&lt;</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">SEW_pow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vrol_vx">VROL.VX</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-3f5532331c3997fffe661657907fee0b.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 266. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VROL.VX goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_pow</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L997">get_sew_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="n">SEW_pow</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L173">get_scalar</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;&lt;</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">[</span><span class="n">SEW_pow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vror_vi">VROR.VI</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-dcf37a150781905c406c1ee37febdabc.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 267. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VROR.VI goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_pow</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L997">get_sew_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="n">SEW_pow</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">   </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">uimm_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n">uimm</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">   </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">uimm_val</span><span class="p">[</span><span class="n">SEW_pow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vror_vv">VROR.VV</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-f52bbce84fffcab0ad6420662292ad6b.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 268. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VROR.VV goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_pow</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L997">get_sew_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="n">SEW_pow</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">SEW_pow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vror_vx">VROR.VX</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-87ed74629c61c54c5ba03655fcc9d969.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 269. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VROR.VX goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_pow</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L997">get_sew_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="n">SEW_pow</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L173">get_scalar</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">[</span><span class="n">SEW_pow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vsetivli">VSETIVLI</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-4ee8df4ca0801424bddc50ca5736b073.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 270. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VSETIVLI goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L992">is_invalid_lmul_pow</a></span><span class="p">(</span><span class="n">lmul</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L989">is_invalid_sew_pow</a></span><span class="p">(</span><span class="n">sew</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_vset.html#L45">handle_illegal_vtype</a></span><span class="p">();</span><span class="w">
    </span><span class="k">return</span><span class="w"> </span><span class="n">RETIRE_SUCCESS</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_new</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">lmul_pow_val</span><span class="p">(</span><span class="n">lmul</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_pow_new</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">sew_pow_val</span><span class="p">(</span><span class="n">sew</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n">SEW_pow_new</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">LMUL_pow_new</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ELEN_pow</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_vset.html#L45">handle_illegal_vtype</a></span><span class="p">();</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">RETIRE_SUCCESS</span><span class="w"> </span><span class="p">};</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">VLMAX</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="p">(</span><span class="n">VLEN_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">LMUL_pow_new</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SEW_pow_new</span><span class="p">);</span><span class="w">

  </span><span class="c">/* set vl according to VLMAX and AVL */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">AVL</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">uimm</span><span class="p">);</span><span class="w"> </span><span class="c">/* AVL is encoded as 5-bit zero-extended imm in the rs1 field */</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_vset.html#L61">calculate_new_vl</a></span><span class="p">(</span><span class="n">AVL</span><span class="p">,</span><span class="w"> </span><span class="n">VLMAX</span><span class="p">);</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">;</span><span class="w">

  </span><span class="c">/* set vtype */</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L966">vtype</a></span><span class="o">.</span><span class="kt">bits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mb">0b0</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">ma</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">ta</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">sew</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">lmul</span><span class="p">;</span><span class="w">

  </span><span class="c">/* reset vstart to 0 */</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">

  </span><span class="n">csr_write_callback</span><span class="p">(</span><span class="s">"vtype"</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L966">vtype</a></span><span class="o">.</span><span class="kt">bits</span><span class="p">);</span><span class="w">
  </span><span class="n">csr_write_callback</span><span class="p">(</span><span class="s">"vl"</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">);</span><span class="w">
  </span><span class="n">csr_write_callback</span><span class="p">(</span><span class="s">"vstart"</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L952">vstart</a></span><span class="p">);</span><span class="w">

  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vsetvl">VSETVL</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-44b175350ed168fe8cf5cbeb36c1caa7.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 271. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VSETVL goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_ori</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_pow_ori</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L997">get_sew_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">ratio_pow_ori</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_pow_ori</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">LMUL_pow_ori</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vtype_new</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Mk_Vtype</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">));</span><span class="w">

  </span><span class="k">if</span><span class="w">   </span><span class="n">vtype_new</span><span class="p">[</span><span class="n">vill</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mb">0b1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">vtype_new</span><span class="p">[</span><span class="n">reserved</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">()</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_vset.html#L45">handle_illegal_vtype</a></span><span class="p">();</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">RETIRE_SUCCESS</span><span class="w"> </span><span class="p">};</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">ma</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="n">vtype_new</span><span class="p">[</span><span class="n">vma</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">ta</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="n">vtype_new</span><span class="p">[</span><span class="n">vta</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">sew</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">vtype_new</span><span class="p">[</span><span class="n">vsew</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">lmul</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vtype_new</span><span class="p">[</span><span class="n">vlmul</span><span class="p">];</span><span class="w">

  </span><span class="c">/* check new SEW and LMUL are legal and calculate VLMAX */</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L992">is_invalid_lmul_pow</a></span><span class="p">(</span><span class="n">lmul</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L989">is_invalid_sew_pow</a></span><span class="p">(</span><span class="n">sew</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_vset.html#L45">handle_illegal_vtype</a></span><span class="p">();</span><span class="w">
    </span><span class="k">return</span><span class="w"> </span><span class="n">RETIRE_SUCCESS</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_new</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">lmul_pow_val</span><span class="p">(</span><span class="n">lmul</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_pow_new</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">sew_pow_val</span><span class="p">(</span><span class="n">sew</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n">SEW_pow_new</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">LMUL_pow_new</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ELEN_pow</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_vset.html#L45">handle_illegal_vtype</a></span><span class="p">();</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">RETIRE_SUCCESS</span><span class="w"> </span><span class="p">};</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">VLMAX</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="p">(</span><span class="n">VLEN_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">LMUL_pow_new</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SEW_pow_new</span><span class="p">);</span><span class="w">

  </span><span class="c">/* set vl according to VLMAX and AVL */</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rs1</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">zreg</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c">/* normal stripmining */</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">AVL</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">);</span><span class="w">
    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_vset.html#L61">calculate_new_vl</a></span><span class="p">(</span><span class="n">AVL</span><span class="p">,</span><span class="w"> </span><span class="n">VLMAX</span><span class="p">);</span><span class="w">
    </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">;</span><span class="w">
  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rd</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">zreg</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c">/* set vl to VLMAX */</span><span class="w">
    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">xlen</span><span class="p">,</span><span class="w"> </span><span class="n">VLMAX</span><span class="p">);</span><span class="w">
    </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">;</span><span class="w">
  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c">/* keep existing vl if it is compatible and vtype.ill is valid */</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">ratio_pow_new</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_pow_new</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">LMUL_pow_new</span><span class="p">;</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">is_legal_vset</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ratio_pow_new</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">ratio_pow_ori</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L42">valid_vtype</a></span><span class="p">();</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n">is_legal_vset</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_vset.html#L45">handle_illegal_vtype</a></span><span class="p">();</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">RETIRE_SUCCESS</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="c">/* set vtype */</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L966">vtype</a></span><span class="o">.</span><span class="kt">bits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mb">0b0</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">ma</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">ta</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">sew</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">lmul</span><span class="p">;</span><span class="w">

  </span><span class="c">/* reset vstart to 0 */</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">

  </span><span class="n">csr_write_callback</span><span class="p">(</span><span class="s">"vtype"</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L966">vtype</a></span><span class="o">.</span><span class="kt">bits</span><span class="p">);</span><span class="w">
  </span><span class="n">csr_write_callback</span><span class="p">(</span><span class="s">"vl"</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">);</span><span class="w">
  </span><span class="n">csr_write_callback</span><span class="p">(</span><span class="s">"vstart"</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L952">vstart</a></span><span class="p">);</span><span class="w">

  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vsetvli">VSETVLI</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-75b5ab4d38cdb1a8104b3405fd4d023f.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 272. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VSETVLI goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_ori</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_pow_ori</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L997">get_sew_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">ratio_pow_ori</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_pow_ori</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">LMUL_pow_ori</span><span class="p">;</span><span class="w">

  </span><span class="c">/* check new SEW and LMUL are legal and calculate VLMAX */</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L992">is_invalid_lmul_pow</a></span><span class="p">(</span><span class="n">lmul</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L989">is_invalid_sew_pow</a></span><span class="p">(</span><span class="n">sew</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_vset.html#L45">handle_illegal_vtype</a></span><span class="p">();</span><span class="w">
    </span><span class="k">return</span><span class="w"> </span><span class="n">RETIRE_SUCCESS</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_new</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">lmul_pow_val</span><span class="p">(</span><span class="n">lmul</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_pow_new</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">sew_pow_val</span><span class="p">(</span><span class="n">sew</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n">SEW_pow_new</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">LMUL_pow_new</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ELEN_pow</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_vset.html#L45">handle_illegal_vtype</a></span><span class="p">();</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">RETIRE_SUCCESS</span><span class="w"> </span><span class="p">};</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">VLMAX</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="p">(</span><span class="n">VLEN_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">LMUL_pow_new</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SEW_pow_new</span><span class="p">);</span><span class="w">

  </span><span class="c">/* set vl according to VLMAX and AVL */</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rs1</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">zreg</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c">/* normal stripmining */</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">AVL</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">);</span><span class="w">
    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_vset.html#L61">calculate_new_vl</a></span><span class="p">(</span><span class="n">AVL</span><span class="p">,</span><span class="w"> </span><span class="n">VLMAX</span><span class="p">);</span><span class="w">
    </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">;</span><span class="w">
  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rd</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">zreg</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c">/* set vl to VLMAX */</span><span class="w">
    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">xlen</span><span class="p">,</span><span class="w"> </span><span class="n">VLMAX</span><span class="p">);</span><span class="w">
    </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">;</span><span class="w">
  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c">/* keep existing vl if it is compatible and vtype.ill is valid */</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">ratio_pow_new</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_pow_new</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">LMUL_pow_new</span><span class="p">;</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">is_legal_vset</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ratio_pow_new</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">ratio_pow_ori</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L42">valid_vtype</a></span><span class="p">();</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n">is_legal_vset</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_vset.html#L45">handle_illegal_vtype</a></span><span class="p">();</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">RETIRE_SUCCESS</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="c">/* set vtype */</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L966">vtype</a></span><span class="o">.</span><span class="kt">bits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mb">0b0</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">ma</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">ta</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">sew</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">lmul</span><span class="p">;</span><span class="w">

  </span><span class="c">/* reset vstart to 0 */</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">

  </span><span class="n">csr_write_callback</span><span class="p">(</span><span class="s">"vtype"</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L966">vtype</a></span><span class="o">.</span><span class="kt">bits</span><span class="p">);</span><span class="w">
  </span><span class="n">csr_write_callback</span><span class="p">(</span><span class="s">"vl"</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">);</span><span class="w">
  </span><span class="n">csr_write_callback</span><span class="p">(</span><span class="s">"vstart"</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L952">vstart</a></span><span class="p">);</span><span class="w">

  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vsha2ms_vv">VSHA2MS.VV</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-1b4f03fedb969f25a22cc591a8522fe5.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 273. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VSHA2MS.VV goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="nv">'SEW</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">32</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">var</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'SEW</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vector_init</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_len</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L952">vstart</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">eg_len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_elem</span><span class="p">);</span><span class="w">

    </span><span class="n">w</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">w</span><span class="w"> </span><span class="k">with</span><span class="w">
      </span><span class="mi">0</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="p">],</span><span class="w">
      </span><span class="mi">1</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="w">
      </span><span class="mi">2</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span><span class="w">
      </span><span class="mi">3</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">3</span><span class="p">],</span><span class="w">

      </span><span class="mi">4</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="p">],</span><span class="w">
      </span><span class="mi">9</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="w">
      </span><span class="mi">10</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span><span class="w">
      </span><span class="mi">11</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">3</span><span class="p">],</span><span class="w">

      </span><span class="mi">12</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="p">],</span><span class="w">
      </span><span class="mi">13</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="w">
      </span><span class="mi">14</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span><span class="w">
      </span><span class="mi">15</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span><span class="w">
    </span><span class="p">];</span><span class="w">

    </span><span class="n">w</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L41">zvk_sig1</a></span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">14</span><span class="p">],</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L33">zvk_sig0</a></span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w">
    </span><span class="n">w</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L41">zvk_sig1</a></span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L33">zvk_sig0</a></span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="w">
    </span><span class="n">w</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L41">zvk_sig1</a></span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L33">zvk_sig0</a></span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="w">
    </span><span class="n">w</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L41">zvk_sig1</a></span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L33">zvk_sig0</a></span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span><span class="w">

    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L189">write_velem_quad</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vsm3c_vi">VSM3C.VI</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-ae3cc8aeb4aa25f7cab0a51c8764f79d.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 274. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VSM3C.VI goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">32</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">rnds</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">uimm</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_len</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L952">vstart</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">eg_len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_elem</span><span class="p">);</span><span class="w">

    </span><span class="k">let</span><span class="w"> </span><span class="n">A_H</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L497">vrev8</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L198">get_velem_oct_vec</a></span><span class="p">(</span><span class="n">vd_val</span><span class="p">,</span><span class="w">  </span><span class="n">i</span><span class="p">));</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">w</span><span class="w">   </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L497">vrev8</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L198">get_velem_oct_vec</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">));</span><span class="w">

    </span><span class="k">let</span><span class="w"> </span><span class="n">x_0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">x_1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span><span class="w">

    </span><span class="k">let</span><span class="w"> </span><span class="n">A1_H1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L146">zvk_sm3_round</a></span><span class="p">(</span><span class="w">  </span><span class="n">A_H</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">x_0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rnds</span><span class="p">);</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">A2_H2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L146">zvk_sm3_round</a></span><span class="p">(</span><span class="n">A1_H1</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">x_1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rnds</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">

    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L202">write_velem_oct_vec</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L497">vrev8</a></span><span class="p">([</span><span class="n">A1_H1</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="w"> </span><span class="n">A2_H2</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="w"> </span><span class="n">A1_H1</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="n">A2_H2</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="n">A1_H1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">A2_H2</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">A1_H1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">A2_H2</span><span class="p">[</span><span class="mi">0</span><span class="p">]]),</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vsm3me_vv">VSM3ME.VV</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-02c492da07ca708952734be8f550d23d.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 275. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VSM3ME.VV goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="nv">'SEW</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">32</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">

  </span><span class="k">var</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vector_init</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_len</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L952">vstart</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">eg_len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_elem</span><span class="p">);</span><span class="w">

    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">w</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./arithmetic.html#L53">rev8</a></span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="p">]);</span><span class="w">
      </span><span class="n">w</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">8</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./arithmetic.html#L53">rev8</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="p">]);</span><span class="w">
    </span><span class="p">};</span><span class="w">

    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">23</span><span class="p">)</span><span class="w">
      </span><span class="n">w</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L123">zvk_sh_w</a></span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">16</span><span class="p">],</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">9</span><span class="p">],</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">13</span><span class="p">],</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">6</span><span class="p">]);</span><span class="w">

    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L202">write_velem_oct_vec</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L497">vrev8</a></span><span class="p">([</span><span class="n">w</span><span class="p">[</span><span class="mi">23</span><span class="p">],</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">22</span><span class="p">],</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">21</span><span class="p">],</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">20</span><span class="p">],</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">19</span><span class="p">],</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">18</span><span class="p">],</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span><span class="w"> </span><span class="n">w</span><span class="p">[</span><span class="mi">16</span><span class="p">]]),</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vsm4k_vi">VSM4K.VI</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-285a612001011a5844449d78738c4af4.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 276. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VSM4K.VI goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">32</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">rnd</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mb">0b00</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">uimm</span><span class="p">[</span><span class="mi">2</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_len</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L952">vstart</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">eg_len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_elem</span><span class="p">);</span><span class="w">

    </span><span class="k">let</span><span class="w"> </span><span class="n">rk_in</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L209">get_velem_quad_vec</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">

    </span><span class="k">var</span><span class="w"> </span><span class="n">rk_out</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vector_init</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">

    </span><span class="k">var</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rk_in</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">rk_in</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">rk_in</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L101">zvk_sm4_sbox</a></span><span class="p">(</span><span class="n">rnd</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w">
    </span><span class="k">var</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L104">zvk_sm4_subword</a></span><span class="p">(</span><span class="n">B</span><span class="p">);</span><span class="w">
    </span><span class="n">rk_out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L78">zvk_round_key</a></span><span class="p">(</span><span class="n">rk_in</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">S</span><span class="p">);</span><span class="w">

    </span><span class="n">B</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rk_in</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w">  </span><span class="o">^</span><span class="w"> </span><span class="n">rk_in</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w">  </span><span class="o">^</span><span class="w"> </span><span class="n">rk_out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L101">zvk_sm4_sbox</a></span><span class="p">(</span><span class="n">rnd</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">
    </span><span class="n">S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L104">zvk_sm4_subword</a></span><span class="p">(</span><span class="n">B</span><span class="p">);</span><span class="w">
    </span><span class="n">rk_out</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L78">zvk_round_key</a></span><span class="p">(</span><span class="n">rk_in</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">S</span><span class="p">);</span><span class="w">

    </span><span class="n">B</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rk_in</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w">  </span><span class="o">^</span><span class="w"> </span><span class="n">rk_out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">rk_out</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L101">zvk_sm4_sbox</a></span><span class="p">(</span><span class="n">rnd</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w">
    </span><span class="n">S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L104">zvk_sm4_subword</a></span><span class="p">(</span><span class="n">B</span><span class="p">);</span><span class="w">
    </span><span class="n">rk_out</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L78">zvk_round_key</a></span><span class="p">(</span><span class="n">rk_in</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">S</span><span class="p">);</span><span class="w">

    </span><span class="n">B</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rk_out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">rk_out</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">rk_out</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L101">zvk_sm4_sbox</a></span><span class="p">(</span><span class="n">rnd</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span><span class="w">
    </span><span class="n">S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L104">zvk_sm4_subword</a></span><span class="p">(</span><span class="n">B</span><span class="p">);</span><span class="w">
    </span><span class="n">rk_out</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L78">zvk_round_key</a></span><span class="p">(</span><span class="n">rk_in</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="n">S</span><span class="p">);</span><span class="w">

    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L213">write_velem_quad_vec</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">rk_out</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vsoxsegtype">VSOXSEGTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-f367eb058e32343fd3f782dda6a332a4.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 277. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VSOXSEGTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW_index_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vlewidth_pow</span><span class="p">(</span><span class="n">width</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW_index_bytes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vlewidth_bytesnumber</span><span class="p">(</span><span class="n">width</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW_data_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L997">get_sew_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW_data_bytes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1011">get_sew_bytes</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EMUL_data_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EMUL_index_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">EEW_index_pow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">EEW_data_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">EMUL_data_pow</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">EMUL_data_pow</span><span class="p">,</span><span class="w"> </span><span class="n">EEW_data_bytes</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w"> </span><span class="c">/* number of data and indices are the same */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">nf_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nfields_int</span><span class="p">(</span><span class="n">nf</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L166">illegal_indexed_store</a></span><span class="p">(</span><span class="n">nf_int</span><span class="p">,</span><span class="w"> </span><span class="n">EEW_index_bytes</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_index_pow</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_data_pow</span><span class="p">)</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_mem.html#L490">process_vsxseg</a></span><span class="p">(</span><span class="n">nf_int</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">vs3</span><span class="p">,</span><span class="w"> </span><span class="n">EEW_index_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">EEW_data_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_index_pow</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_data_pow</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vsretype">VSRETYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-1fe5b6f12f5eb34de6be78722d51cfbf.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 278. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VSRETYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">load_width_bytes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">elem_per_reg</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">VLEN</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">EEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">nf_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nfields_int</span><span class="p">(</span><span class="n">nf</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">elem_per_reg</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n">nf_int</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">nf_int</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">nf_int</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">nf_int</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_mem.html#L641">process_vsre</a></span><span class="p">(</span><span class="n">nf_int</span><span class="p">,</span><span class="w"> </span><span class="n">load_width_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">vs3</span><span class="p">,</span><span class="w"> </span><span class="n">elem_per_reg</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vssegtype">VSSEGTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-159512ecdfc149a7d585c4120c28d63f.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 279. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VSSEGTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">load_width_bytes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vlewidth_bytesnumber</span><span class="p">(</span><span class="n">width</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">load_width_bytes</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vlewidth_pow</span><span class="p">(</span><span class="n">width</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L997">get_sew_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">EEW_pow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SEW_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">EMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">EEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">nf_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nfields_int</span><span class="p">(</span><span class="n">nf</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L153">illegal_store</a></span><span class="p">(</span><span class="n">nf_int</span><span class="p">,</span><span class="w"> </span><span class="n">EEW</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_pow</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_mem.html#L219">process_vsseg</a></span><span class="p">(</span><span class="n">nf_int</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">vs3</span><span class="p">,</span><span class="w"> </span><span class="n">load_width_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">num_elem</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vsssegtype">VSSSEGTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-304a92f7ac3973118d8e72bafde3c969.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 280. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VSSSEGTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">load_width_bytes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vlewidth_bytesnumber</span><span class="p">(</span><span class="n">width</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">load_width_bytes</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vlewidth_pow</span><span class="p">(</span><span class="n">width</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L997">get_sew_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">EEW_pow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SEW_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">EMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">EEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">nf_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nfields_int</span><span class="p">(</span><span class="n">nf</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L153">illegal_store</a></span><span class="p">(</span><span class="n">nf_int</span><span class="p">,</span><span class="w"> </span><span class="n">EEW</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_pow</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_mem.html#L339">process_vssseg</a></span><span class="p">(</span><span class="n">nf_int</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">vs3</span><span class="p">,</span><span class="w"> </span><span class="n">load_width_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rs2</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">num_elem</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vsuxsegtype">VSUXSEGTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-529acbd5cb91e33841c1de90684ceeeb.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 281. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VSUXSEGTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW_index_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vlewidth_pow</span><span class="p">(</span><span class="n">width</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW_index_bytes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vlewidth_bytesnumber</span><span class="p">(</span><span class="n">width</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW_data_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L997">get_sew_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EEW_data_bytes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1011">get_sew_bytes</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EMUL_data_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">EMUL_index_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">EEW_index_pow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">EEW_data_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">EMUL_data_pow</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">EMUL_data_pow</span><span class="p">,</span><span class="w"> </span><span class="n">EEW_data_bytes</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w"> </span><span class="c">/* number of data and indices are the same */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">nf_int</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nfields_int</span><span class="p">(</span><span class="n">nf</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L166">illegal_indexed_store</a></span><span class="p">(</span><span class="n">nf_int</span><span class="p">,</span><span class="w"> </span><span class="n">EEW_index_bytes</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_index_pow</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_data_pow</span><span class="p">)</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_mem.html#L490">process_vsxseg</a></span><span class="p">(</span><span class="n">nf_int</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">vs3</span><span class="p">,</span><span class="w"> </span><span class="n">EEW_index_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">EEW_data_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_index_pow</span><span class="p">,</span><span class="w"> </span><span class="n">EMUL_data_pow</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vvcmptype">VVCMPTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-da8bceee7bdb98404cbb8f3544a86f44.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 282. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VVCMPTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L116">illegal_vd_unmasked</a></span><span class="p">()</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L379">init_masked_result_cmp</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">VVCMP_VMSEQ</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">VVCMP_VMSNE</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">VVCMP_VMSLTU</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">VVCMP_VMSLT</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">VVCMP_VMSLEU</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w">
        </span><span class="n">VVCMP_VMSLE</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w">
      </span><span class="p">};</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L110">bool_to_bit</a></span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L409">write_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vvmctype">VVMCTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-d261e5e4645e641c43ec4350fda5e41a.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 283. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VVMCTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L116">illegal_vd_unmasked</a></span><span class="p">()</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L340">init_masked_result_carry</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">VVMC_VMADC</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="n">VVMC_VMSBC</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w">
      </span><span class="p">};</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L110">bool_to_bit</a></span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L409">write_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vvmstype">VVMSTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-75550708eb0f48171cf557635d8b25b2.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 284. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VVMSTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L105">illegal_vd_masked</a></span><span class="p">(</span><span class="n">vd</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="c">/* for bypassing normal masking in init_masked_result */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vec_trues</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L92">ones</a></span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L391">read_vmask_carry</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vec_trues</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">VVMS_VADC</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="n">vm_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="p">)),</span><span class="w">
        </span><span class="n">VVMS_VSBC</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="n">vm_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vvmtype">VVMTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-75550708eb0f48171cf557635d8b25b2.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 285. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VVMTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L116">illegal_vd_unmasked</a></span><span class="p">()</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L391">read_vmask_carry</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L340">init_masked_result_carry</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">VVM_VMADC</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="n">vm_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="n">VVM_VMSBC</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="n">vm_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w">
      </span><span class="p">};</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L110">bool_to_bit</a></span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L409">write_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vvtype">VVTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-da8bceee7bdb98404cbb8f3544a86f44.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 286. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VVTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_pow</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L997">get_sew_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L99">illegal_normal</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">VV_VADD</span><span class="w">          </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">VV_VSUB</span><span class="w">          </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">VV_VAND</span><span class="w">          </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">VV_VOR</span><span class="w">           </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">VV_VXOR</span><span class="w">          </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">VV_VSADDU</span><span class="w">        </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L472">unsigned_saturation</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
        </span><span class="n">VV_VSADD</span><span class="w">         </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L483">signed_saturation</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
        </span><span class="n">VV_VSSUBU</span><span class="w">        </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">if</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">()</span><span class="w">
                              </span><span class="k">else</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L472">unsigned_saturation</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">VV_VSSUB</span><span class="w">         </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L483">signed_saturation</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
        </span><span class="n">VV_VSMUL</span><span class="w">         </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">result_mul</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">rounding_incr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L455">get_fixed_rounding_incr</a></span><span class="p">(</span><span class="n">result_mul</span><span class="p">,</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">result_wide</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">result_mul</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">rounding_incr</span><span class="p">);</span><span class="w">
                              </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L483">signed_saturation</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">result_wide</span><span class="p">[</span><span class="nv">'m</span><span class="o">..</span><span class="mi">0</span><span class="p">])</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">VV_VSLL</span><span class="w">          </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
                              </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">VV_VSRL</span><span class="w">          </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
                              </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">VV_VSRA</span><span class="w">          </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">v_double</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                              </span><span class="n">slice</span><span class="p">(</span><span class="n">v_double</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">VV_VSSRL</span><span class="w">         </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">rounding_incr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L455">get_fixed_rounding_incr</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">);</span><span class="w">
                              </span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">rounding_incr</span><span class="p">)</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">VV_VSSRA</span><span class="w">         </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">rounding_incr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L455">get_fixed_rounding_incr</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">);</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">v_double</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                              </span><span class="n">slice</span><span class="p">(</span><span class="n">v_double</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">rounding_incr</span><span class="p">)</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">VV_VMINU</span><span class="w">         </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))),</span><span class="w">
        </span><span class="n">VV_VMIN</span><span class="w">          </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))),</span><span class="w">
        </span><span class="n">VV_VMAXU</span><span class="w">         </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))),</span><span class="w">
        </span><span class="n">VV_VMAX</span><span class="w">          </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))),</span><span class="w">
        </span><span class="n">VV_VRGATHER</span><span class="w">      </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">vs1</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">vd</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">vs2</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">vd</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">VLMAX</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="p">(</span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">VLEN_pow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SEW_pow</span><span class="p">);</span><span class="w">
                              </span><span class="n">assert</span><span class="p">(</span><span class="n">VLMAX</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nv">'n</span><span class="p">);</span><span class="w">
                              </span><span class="k">if</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">VLMAX</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">()</span><span class="w">
                            </span><span class="p">},</span><span class="w">
        </span><span class="n">VV_VRGATHEREI16</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">vs1</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">vd</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">vs2</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">vd</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
                              </span><span class="c">/* vrgatherei16.vv uses SEW/LMUL for the data in vs2 but EEW=16 and EMUL = (16/SEW)*LMUL for the indices in vs1 */</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_new</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SEW_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_new</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                              </span><span class="k">let</span><span class="w"> </span><span class="n">VLMAX</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="p">(</span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">VLEN_pow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SEW_pow</span><span class="p">);</span><span class="w">
                              </span><span class="n">assert</span><span class="p">(</span><span class="n">VLMAX</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nv">'n</span><span class="p">);</span><span class="w">
                              </span><span class="k">if</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">VLMAX</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">()</span><span class="w">
                            </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vwsll_vi">VWSLL.VI</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-7042e939f218fa663dd65af500254f8c.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 287. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VWSLL.VI goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">            </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w">       </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w">       </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L140">illegal_reduction_widen</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">      </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">uimm_val</span><span class="w">    </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n">uimm</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val_vec</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">      </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen_bits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="nv">'o</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n">vs2_val_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
        </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">uimm_val</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n">SEW_widen_bits</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span><span class="w">
    </span><span class="p">};</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vwsll_vv">VWSLL.VV</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-613745c47fb391a80a185ebdc222eb7c.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 288. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VWSLL.VV goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">            </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w">       </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w">       </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L140">illegal_reduction_widen</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">      </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val_vec</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val_vec</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">      </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen_bits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="nv">'o</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n">vs1_val_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n">vs2_val_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">vs1_val</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n">SEW_widen_bits</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span><span class="w">
    </span><span class="p">};</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vwsll_vx">VWSLL.VX</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-34d95a7029be536719bd4490eb5efd59.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 289. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VWSLL.VX goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">            </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w">       </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w">       </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L140">illegal_reduction_widen</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">      </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w">     </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L173">get_scalar</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">));</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val_vec</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">      </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen_bits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="nv">'o</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n">vs2_val_vec</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n">SEW_widen_bits</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span><span class="w">
    </span><span class="p">};</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vxcmptype">VXCMPTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-215d8e71c8cbcd7743e68e95833ac0b5.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 290. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VXCMPTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L116">illegal_vd_unmasked</a></span><span class="p">()</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">                  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L173">get_scalar</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L379">init_masked_result_cmp</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">VXCMP_VMSEQ</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">,</span><span class="w">
        </span><span class="n">VXCMP_VMSNE</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">,</span><span class="w">
        </span><span class="n">VXCMP_VMSLTU</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">),</span><span class="w">
        </span><span class="n">VXCMP_VMSLT</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">),</span><span class="w">
        </span><span class="n">VXCMP_VMSLEU</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">),</span><span class="w">
        </span><span class="n">VXCMP_VMSLE</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">),</span><span class="w">
        </span><span class="n">VXCMP_VMSGTU</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">),</span><span class="w">
        </span><span class="n">VXCMP_VMSGT</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)</span><span class="w">
      </span><span class="p">};</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L110">bool_to_bit</a></span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L409">write_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vxmctype">VXMCTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-00a0e863cf6b5d1b3c5579936944d973.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 291. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VXMCTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L116">illegal_vd_unmasked</a></span><span class="p">()</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L173">get_scalar</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L340">init_masked_result_carry</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">VXMC_VMADC</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="n">VXMC_VMSBC</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w">
      </span><span class="p">};</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L110">bool_to_bit</a></span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L409">write_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vxmstype">VXMSTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-bf100b03e1af4d4e4e4b94872e0923ba.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 292. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VXMSTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L105">illegal_vd_masked</a></span><span class="p">(</span><span class="n">vd</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="c">/* for bypassing normal masking in init_masked_result */</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vec_trues</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L92">ones</a></span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L391">read_vmask_carry</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">                  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L173">get_scalar</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vec_trues</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">VXMS_VADC</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="n">vm_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="p">)),</span><span class="w">
        </span><span class="n">VXMS_VSBC</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="n">vm_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vxmtype">VXMTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-bf100b03e1af4d4e4e4b94872e0923ba.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 293. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VXMTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L116">illegal_vd_unmasked</a></span><span class="p">()</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L391">read_vmask_carry</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">                  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L173">get_scalar</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="mb">0b0</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L340">init_masked_result_carry</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="k">let</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">VXM_VMADC</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="n">vm_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="n">VXM_VMSBC</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="n">vm_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w">
      </span><span class="p">};</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L110">bool_to_bit</a></span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L409">write_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vxsg">VXSG</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-215d8e71c8cbcd7743e68e95833ac0b5.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 294. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VXSG goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_pow</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L997">get_sew_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L99">illegal_normal</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">nat</span><span class="w">                  </span><span class="p">=</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">));</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">VX_VSLIDEUP</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">vs2</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">vd</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
                            </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w">
                          </span><span class="p">},</span><span class="w">
        </span><span class="n">VX_VSLIDEDOWN</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                            </span><span class="k">let</span><span class="w"> </span><span class="n">VLMAX</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="p">(</span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">VLEN_pow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SEW_pow</span><span class="p">);</span><span class="w">
                            </span><span class="n">assert</span><span class="p">(</span><span class="n">VLMAX</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">VLMAX</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nv">'n</span><span class="p">);</span><span class="w">
                            </span><span class="k">if</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">VLMAX</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">()</span><span class="w">
                          </span><span class="p">},</span><span class="w">
        </span><span class="n">VX_VRGATHER</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">vs2</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">vd</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">
                            </span><span class="k">let</span><span class="w"> </span><span class="n">VLMAX</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="p">(</span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">VLEN_pow</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SEW_pow</span><span class="p">);</span><span class="w">
                            </span><span class="n">assert</span><span class="p">(</span><span class="n">VLMAX</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">VLMAX</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nv">'n</span><span class="p">);</span><span class="w">
                            </span><span class="k">if</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">VLMAX</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">rs1_val</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">()</span><span class="w">
                          </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_vxtype">VXTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-215d8e71c8cbcd7743e68e95833ac0b5.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 295. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for VXTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L99">illegal_normal</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L173">get_scalar</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">VX_VADD</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">,</span><span class="w">
        </span><span class="n">VX_VSUB</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">,</span><span class="w">
        </span><span class="n">VX_VRSUB</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">VX_VAND</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">,</span><span class="w">
        </span><span class="n">VX_VOR</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">,</span><span class="w">
        </span><span class="n">VX_VXOR</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">,</span><span class="w">
        </span><span class="n">VX_VSADDU</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L472">unsigned_saturation</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">)</span><span class="w"> </span><span class="p">),</span><span class="w">
        </span><span class="n">VX_VSADD</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L483">signed_saturation</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">)</span><span class="w"> </span><span class="p">),</span><span class="w">
        </span><span class="n">VX_VSSUBU</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">if</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">()</span><span class="w">
                        </span><span class="k">else</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L472">unsigned_saturation</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">
                      </span><span class="p">},</span><span class="w">
        </span><span class="n">VX_VSSUB</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L483">signed_saturation</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">)</span><span class="w"> </span><span class="p">),</span><span class="w">
        </span><span class="n">VX_VSMUL</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">result_mul</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">));</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">rounding_incr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L455">get_fixed_rounding_incr</a></span><span class="p">(</span><span class="n">result_mul</span><span class="p">,</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">result_wide</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">result_mul</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">rounding_incr</span><span class="p">);</span><span class="w">
                        </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L483">signed_saturation</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">result_wide</span><span class="p">[</span><span class="nv">'m</span><span class="o">..</span><span class="mi">0</span><span class="p">])</span><span class="w">
                      </span><span class="p">},</span><span class="w">
        </span><span class="n">VX_VSLL</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
                        </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="w">
                      </span><span class="p">},</span><span class="w">
        </span><span class="n">VX_VSRL</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
                        </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="w">
                      </span><span class="p">},</span><span class="w">
        </span><span class="n">VX_VSRA</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">v_double</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                        </span><span class="n">slice</span><span class="p">(</span><span class="n">v_double</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w">
                      </span><span class="p">},</span><span class="w">
        </span><span class="n">VX_VSSRL</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">rounding_incr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L455">get_fixed_rounding_incr</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">);</span><span class="w">
                        </span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">rounding_incr</span><span class="p">)</span><span class="w">
                      </span><span class="p">},</span><span class="w">
        </span><span class="n">VX_VSSRA</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">shift_amount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L447">get_shift_amount</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">rounding_incr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L455">get_fixed_rounding_incr</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">);</span><span class="w">
                        </span><span class="k">let</span><span class="w"> </span><span class="n">v_double</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w">
                        </span><span class="n">slice</span><span class="p">(</span><span class="n">v_double</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">shift_amount</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="nv">'m</span><span class="p">,</span><span class="w"> </span><span class="n">rounding_incr</span><span class="p">)</span><span class="w">
                      </span><span class="p">},</span><span class="w">
        </span><span class="n">VX_VMINU</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">))),</span><span class="w">
        </span><span class="n">VX_VMIN</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">))),</span><span class="w">
        </span><span class="n">VX_VMAXU</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">))),</span><span class="w">
        </span><span class="n">VX_VMAX</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)))</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_wfi">WFI</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-5363177d36e2b17616f70b9a5881a788.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 296. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for WFI goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L13">cur_privilege</a></span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Machine</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Enter_Wait</span><span class="p">(</span><span class="n">WAIT_WFI</span><span class="p">),</span><span class="w">
    </span><span class="n">Supervisor</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">if</span><span class="w">   </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L263">mstatus</a></span><span class="p">[</span><span class="n">TW</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mb">0b1</span><span class="w">
                  </span><span class="k">then</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
                  </span><span class="k">else</span><span class="w"> </span><span class="n">Enter_Wait</span><span class="p">(</span><span class="n">WAIT_WFI</span><span class="p">),</span><span class="w">
    </span><span class="n">User</span><span class="w">       </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_wmvvtype">WMVVTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-b70466bfd00231872382b4af6dda1a9f.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 297. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for WMVVTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w">  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L125">illegal_variable_width</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs1</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">))</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">))</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">WMVV_VWMACC</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">WMVV_VWMACCU</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">WMVV_VWMACCSU</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="o">+</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_wmvxtype">WMVXTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-99cc521619cbc480adbeae8082869ffd.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 298. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for WMVXTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w">  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L125">illegal_variable_width</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">))</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L173">get_scalar</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">WMVX_VWMACCU</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">WMVX_VWMACC</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">WMVX_VWMACCUS</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">))</span><span class="o">+</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w">
        </span><span class="n">WMVX_VWMACCSU</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">))</span><span class="o">+</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_wrs">WRS</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-070bbce1366d9d97d40265041847c62a.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 299. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for WRS goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="n">Enter_Wait</span><span class="p">(</span><span class="n">WAIT_WRS_STO</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_wrs_2">WRS</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-070bbce1366d9d97d40265041847c62a.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 300. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for WRS goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="n">Enter_Wait</span><span class="p">(</span><span class="n">WAIT_WRS_NTO</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_wvtype">WVTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-b70466bfd00231872382b4af6dda1a9f.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 301. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for WVTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w">  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L125">illegal_variable_width</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs1</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">))</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">WV_VADD</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
        </span><span class="n">WV_VSUB</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
        </span><span class="n">WV_VADDU</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
        </span><span class="n">WV_VSUBU</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_wvvtype">WVVTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-b70466bfd00231872382b4af6dda1a9f.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 302. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for WVVTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w">  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L125">illegal_variable_width</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs1</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">))</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">))</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">WVV_VADD</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
        </span><span class="n">WVV_VSUB</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
        </span><span class="n">WVV_VADDU</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
        </span><span class="n">WVV_VSUBU</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
        </span><span class="n">WVV_VWMUL</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
        </span><span class="n">WVV_VWMULU</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span><span class="w">
        </span><span class="n">WVV_VWMULSU</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_wvxtype">WVXTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-99cc521619cbc480adbeae8082869ffd.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 303. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for WVXTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w">  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L125">illegal_variable_width</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w">
      </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L29">not</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L70">valid_reg_overlap</a></span><span class="p">(</span><span class="n">vs2</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">))</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L173">get_scalar</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">WVX_VADD</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)),</span><span class="w">
        </span><span class="n">WVX_VSUB</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)),</span><span class="w">
        </span><span class="n">WVX_VADDU</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)),</span><span class="w">
        </span><span class="n">WVX_VSUBU</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)),</span><span class="w">
        </span><span class="n">WVX_VWMUL</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)),</span><span class="w">
        </span><span class="n">WVX_VWMULU</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)),</span><span class="w">
        </span><span class="n">WVX_VWMULSU</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">))</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_wxtype">WXTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-99cc521619cbc480adbeae8082869ffd.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 304. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for WXTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW_widen</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L125">illegal_variable_width</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">)</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">();</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW_widen</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="nv">'n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">num_elem</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="nv">'o</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">;</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vm_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L373">read_vmask</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">vm</span><span class="p">,</span><span class="w"> </span><span class="n">zvreg</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'m</span><span class="p">)</span><span class="w">             </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L173">get_scalar</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="p">(</span><span class="n">initial_result</span><span class="p">,</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="nv">'n</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'o</span><span class="p">)),</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="nv">'n</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L247">init_masked_result</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">vm_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="w">   </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w">
    </span><span class="n">Err</span><span class="p">(())</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">initial_result</span><span class="p">;</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">num_elem</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="nb">bitone</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">WX_VADD</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)),</span><span class="w">
        </span><span class="n">WX_VSUB</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">signed</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)),</span><span class="w">
        </span><span class="n">WX_VADDU</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">)),</span><span class="w">
        </span><span class="n">WX_VSUBU</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L136">to_bits_unsafe</a></span><span class="p">(</span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs1_val</span><span class="p">))</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L330">write_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW_widen</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow_widen</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_xperm4">XPERM4</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-66492f05efd2518879dc9f97240203d3.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 305. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for XPERM4 goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">();</span><span class="w">
  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs2_val</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="o">..</span><span class="n">i</span><span class="p">]);</span><span class="w">
    </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="o">..</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="n">index</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">xlen</span><span class="w">
                     </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="n">index</span><span class="o">+</span><span class="mi">3</span><span class="o">..</span><span class="mi">4</span><span class="o">*</span><span class="n">index</span><span class="p">]</span><span class="w">
                     </span><span class="k">else</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_xperm8">XPERM8</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-2179b5d5e379b3d4d5c62d7b0109bb08.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 306. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for XPERM8 goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">();</span><span class="w">
  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">unsigned</span><span class="p">(</span><span class="n">rs2_val</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">7</span><span class="o">..</span><span class="n">i</span><span class="p">]);</span><span class="w">
    </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">7</span><span class="o">..</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="mi">8</span><span class="o">*</span><span class="n">index</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">xlen</span><span class="w">
                     </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">[</span><span class="mi">8</span><span class="o">*</span><span class="n">index</span><span class="o">+</span><span class="mi">7</span><span class="o">..</span><span class="mi">8</span><span class="o">*</span><span class="n">index</span><span class="p">]</span><span class="w">
                     </span><span class="k">else</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">()</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zba_rtype">ZBA.RTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-c92ce2f68c967d5e01c8b24ff3c8e468.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 307. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ZBA.RTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zba_rtypeuw">ZBA.RTYPEUW</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-4d15daee8ae4eff5ccb52ad705ee8ded.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 308. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ZBA.RTYPEUW goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zbb_extop">ZBB.EXTOP</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-d00be2cbe0bf9edb5b2bca6720c0ff72.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 309. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ZBB.EXTOP goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">SEXTB</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">[</span><span class="mi">7</span><span class="o">..</span><span class="mi">0</span><span class="p">]),</span><span class="w">
    </span><span class="n">SEXTH</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">[</span><span class="mi">15</span><span class="o">..</span><span class="mi">0</span><span class="p">]),</span><span class="w">
    </span><span class="n">ZEXTH</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n">rs1_val</span><span class="p">[</span><span class="mi">15</span><span class="o">..</span><span class="mi">0</span><span class="p">]),</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zbb_rtype">ZBB.RTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-961202e4ca44dc02189897cb589a637d.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 310. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ZBB.RTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">ANDN</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="err">~</span><span class="p">(</span><span class="n">rs2_val</span><span class="p">),</span><span class="w">
    </span><span class="n">ORN</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="err">~</span><span class="p">(</span><span class="n">rs2_val</span><span class="p">),</span><span class="w">
    </span><span class="n">XNOR</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="err">~</span><span class="p">(</span><span class="n">rs1_val</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">rs2_val</span><span class="p">),</span><span class="w">
    </span><span class="n">MAX</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="n">&gt;_s</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">rs2_val</span><span class="p">,</span><span class="w">
    </span><span class="n">MAXU</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="n">&gt;_u</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">rs2_val</span><span class="p">,</span><span class="w">
    </span><span class="n">MIN</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="n">&lt;_s</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">rs2_val</span><span class="p">,</span><span class="w">
    </span><span class="n">MINU</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="n">&lt;_u</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">rs2_val</span><span class="p">,</span><span class="w">
    </span><span class="n">ROL</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="o">&lt;&lt;&lt;</span><span class="w"> </span><span class="n">rs2_val</span><span class="p">[</span><span class="n">log2_xlen</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span><span class="w">
    </span><span class="n">ROR</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">rs2_val</span><span class="p">[</span><span class="n">log2_xlen</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zbb_rtypew">ZBB.RTYPEW</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-360b49ea2c9e31e64732d63e9ffde916.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 311. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ZBB.RTYPEW goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">)[</span><span class="mi">31</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">shamt</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">)[</span><span class="mi">4</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">ROLW</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="o">&lt;&lt;&lt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">,</span><span class="w">
    </span><span class="n">RORW</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">,</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zbkb_packw">ZBKB.PACKW</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-190b06820fca7b73d3684d634502bd39.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 312. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ZBKB.PACKW goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">ZBKB_PACKW</span><span class="p">(</span><span class="n">rs2</span><span class="p">,</span><span class="w"> </span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rs2_val</span><span class="p">[</span><span class="mi">15</span><span class="o">..</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">[</span><span class="mi">15</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L85">sign_extend</a></span><span class="p">(</span><span class="n">result</span><span class="p">);</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zbkb_rtype">ZBKB.RTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-16d0c9dc26e73566e6bbd5e785e236e3.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 313. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ZBKB.RTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">PACK</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs2_val</span><span class="p">[(</span><span class="n">xlen_bytes</span><span class="o">*</span><span class="mi">4</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">..</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">[(</span><span class="n">xlen_bytes</span><span class="o">*</span><span class="mi">4</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">..</span><span class="mi">0</span><span class="p">],</span><span class="w">
    </span><span class="n">PACKH</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n">rs2_val</span><span class="p">[</span><span class="mi">7</span><span class="o">..</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">[</span><span class="mi">7</span><span class="o">..</span><span class="mi">0</span><span class="p">])</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zbs_iop">ZBS.IOP</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-34f3ef56af391e061159bf86de743e86.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 314. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ZBS.IOP goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">mask</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">xlen</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">32</span><span class="w">
                        </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="mb">0b1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">[</span><span class="mi">4</span><span class="o">..</span><span class="mi">0</span><span class="p">]</span><span class="w">
                        </span><span class="k">else</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="mb">0b1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">shamt</span><span class="p">;</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">BCLRI</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="err">~</span><span class="p">(</span><span class="n">mask</span><span class="p">),</span><span class="w">
    </span><span class="n">BEXTI</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L112">bool_to_bits</a></span><span class="p">((</span><span class="n">rs1_val</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">())),</span><span class="w">
    </span><span class="n">BINVI</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">mask</span><span class="p">,</span><span class="w">
    </span><span class="n">BSETI</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">mask</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zbs_rtype">ZBS.RTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-6502849cc13ee21d8e0fd30c8821411a.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 315. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ZBS.RTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">mask</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">xlen</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">32</span><span class="w">
                        </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="mb">0b1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">rs2_val</span><span class="p">[</span><span class="mi">4</span><span class="o">..</span><span class="mi">0</span><span class="p">]</span><span class="w">
                        </span><span class="k">else</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="mb">0b1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">rs2_val</span><span class="p">[</span><span class="mi">5</span><span class="o">..</span><span class="mi">0</span><span class="p">];</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="n">op</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">BCLR</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="err">~</span><span class="p">(</span><span class="n">mask</span><span class="p">),</span><span class="w">
    </span><span class="n">BEXT</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L112">bool_to_bits</a></span><span class="p">((</span><span class="n">rs1_val</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">mask</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">())),</span><span class="w">
    </span><span class="n">BINV</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">mask</span><span class="p">,</span><span class="w">
    </span><span class="n">BSET</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">mask</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zicbom">ZICBOM</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-0c653abbf694cfc1edca94b13e563b69.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 316. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ZICBOM goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">if</span><span class="w">   </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zicbom.html#L13">cbo_clean_flush_enabled</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L13">cur_privilege</a></span><span class="p">)</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zicbom.html#L67">process_clean_inval</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">CBO_CLEAN</span><span class="p">)</span><span class="w">
  </span><span class="k">else</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zicbom_2">ZICBOM</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-0c653abbf694cfc1edca94b13e563b69.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 317. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ZICBOM goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">if</span><span class="w">   </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zicbom.html#L13">cbo_clean_flush_enabled</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L13">cur_privilege</a></span><span class="p">)</span><span class="w">
  </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zicbom.html#L67">process_clean_inval</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">CBO_FLUSH</span><span class="p">)</span><span class="w">
  </span><span class="k">else</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">()</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zicbom_3">ZICBOM</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-0c653abbf694cfc1edca94b13e563b69.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 318. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ZICBOM goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zicbom.html#L51">cbop_priv_check</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L13">cur_privilege</a></span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">CBOP_ILLEGAL</span><span class="w">         </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Illegal_Instruction</span><span class="p">(),</span><span class="w">
    </span><span class="n">CBOP_ILLEGAL_VIRTUAL</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_errors.html#L20">internal_error</a></span><span class="p">(</span><span class="mi">__</span><span class="n">FILE__</span><span class="p">,</span><span class="w"> </span><span class="mi">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="s">"unimplemented"</span><span class="p">),</span><span class="w">
    </span><span class="n">CBOP_INVAL_INVAL</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zicbom.html#L67">process_clean_inval</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">CBO_INVAL</span><span class="p">),</span><span class="w">
    </span><span class="n">CBOP_INVAL_FLUSH</span><span class="w">     </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zicbom.html#L67">process_clean_inval</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">CBO_FLUSH</span><span class="p">),</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zicboz">ZICBOZ</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-c4ffc95932967d39c080767ab2e176da.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 319. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ZICBOZ goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_zicboz.html#L13">cbo_zero_enabled</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L13">cur_privilege</a></span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">cache_block_size</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">2 ^</span><span class="w"> </span><span class="n">plat_cache_block_size_exp</span><span class="p">;</span><span class="w">

    </span><span class="c">// Offset from rs1 to the beginning of the cache block. This is 0 if rs1</span><span class="w">
    </span><span class="c">// is aligned to the cache block, or negative if rs1 is misaligned.</span><span class="w">
    </span><span class="k">let</span><span class="w"> </span><span class="n">negative_offset</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">rs1_val</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="err">~</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L86">zero_extend</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L92">ones</a></span><span class="p">(</span><span class="n">plat_cache_block_size_exp</span><span class="p">))))</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">;</span><span class="w">

    </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_addr_checks.html#L57">ext_data_get_addr</a></span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">negative_offset</span><span class="p">,</span><span class="w"> </span><span class="n">Write</span><span class="p">(</span><span class="n">Data</span><span class="p">),</span><span class="w"> </span><span class="n">cache_block_size</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="n">Ext_DataAddr_Error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Ext_DataAddr_Check_Failure</span><span class="p">(</span><span class="n">e</span><span class="p">),</span><span class="w">
      </span><span class="n">Ext_DataAddr_OK</span><span class="p">(</span><span class="n">vaddr</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="c">// "An implementation may update the bytes in any order and with any granularity</span><span class="w">
        </span><span class="c">//  and atomicity, including individual bytes."</span><span class="w">
        </span><span class="c">//</span><span class="w">
        </span><span class="c">// This implementation does a single atomic write.</span><span class="w">
        </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vmem.html#L356">translateAddr</a></span><span class="p">(</span><span class="n">vaddr</span><span class="p">,</span><span class="w"> </span><span class="n">Write</span><span class="p">(</span><span class="n">Data</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="c">// vaddr is the aligned address, but errors report the address that</span><span class="w">
          </span><span class="c">// was encoded in the instruction. We subtract the negative offset</span><span class="w">
          </span><span class="c">// (add the positive offset) to get it. Normally this will be</span><span class="w">
          </span><span class="c">// equal to rs1, but pointer masking can change that.</span><span class="w">
          </span><span class="n">Err</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="mi">_</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Memory_Exception</span><span class="p">(</span><span class="n">vaddr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">negative_offset</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">),</span><span class="w">
          </span><span class="n">Ok</span><span class="p">(</span><span class="n">paddr</span><span class="p">,</span><span class="w"> </span><span class="mi">_</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_mem.html#L169">mem_write_ea</a></span><span class="p">(</span><span class="n">paddr</span><span class="p">,</span><span class="w"> </span><span class="n">cache_block_size</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="n">Err</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Memory_Exception</span><span class="p">(</span><span class="n">vaddr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">negative_offset</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">),</span><span class="w">
              </span><span class="n">Ok</span><span class="p">(</span><span class="mi">_</span><span class="p">)</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="k">match</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_mem.html#L241">mem_write_value</a></span><span class="p">(</span><span class="n">paddr</span><span class="p">,</span><span class="w"> </span><span class="n">cache_block_size</span><span class="p">,</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">(),</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                  </span><span class="n">Ok</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span><span class="w">  </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">RETIRE_SUCCESS</span><span class="p">,</span><span class="w">
                  </span><span class="n">Ok</span><span class="p">(</span><span class="nb">false</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_errors.html#L20">internal_error</a></span><span class="p">(</span><span class="mi">__</span><span class="n">FILE__</span><span class="p">,</span><span class="w"> </span><span class="mi">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="s">"store got false from mem_write_value"</span><span class="p">),</span><span class="w">
                  </span><span class="n">Err</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w">    </span><span class="p">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Memory_Exception</span><span class="p">(</span><span class="n">vaddr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">negative_offset</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w">
                </span><span class="p">}</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">Illegal_Instruction</span><span class="p">()</span><span class="w">
  </span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zicond_rtype">ZICOND.RTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-49e02ae685119fbbbd2c4f2e7f1ea5b7.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 320. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ZICOND.RTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">condition</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">condition</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">()</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">()</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zicond_rtype_2">ZICOND.RTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-49e02ae685119fbbbd2c4f2e7f1ea5b7.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 321. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ZICOND.RTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">condition</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">condition</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">()</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">()</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">value</span><span class="p">;</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zimop_mop_r">ZIMOP.MOP.R</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-ab60d617de12e50da24ce6a57ab43d4f.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 322. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ZIMOP.MOP.R goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">();</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zimop_mop_rr">ZIMOP.MOP.RR</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-00d2d6735468ace7ea4196215d9a4315.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 323. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ZIMOP.MOP.RR goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">();</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zip">ZIP</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-a140d4ba2045059794bb04fecd9262a4.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 324. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ZIP goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="k">function</span><span class="w"> </span><span class="nf">clause</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="p">(</span><span class="n">ZIP</span><span class="p">(</span><span class="n">rs1</span><span class="p">,</span><span class="w"> </span><span class="n">rd</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">assert</span><span class="p">(</span><span class="n">xlen</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">32</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">rs1_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">X</span><span class="p">(</span><span class="n">rs1</span><span class="p">);</span><span class="w">
  </span><span class="k">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">xlenbits</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">();</span><span class="w">
  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">xlen_bytes</span><span class="o">*</span><span class="mi">4</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w">
    </span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">rs1_val</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlen_bytes</span><span class="o">*</span><span class="mi">4</span><span class="p">];</span><span class="w">
  </span><span class="p">};</span><span class="w">
  </span><span class="n">X</span><span class="p">(</span><span class="n">rd</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zvksha2type">ZVKSHA2TYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-c2e649ecacd7a3d45a7db56266fb86de.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 325. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ZVKSHA2TYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">32</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">SEW</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">64</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vs1_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs1</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_len</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L952">vstart</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">eg_len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_elem</span><span class="p">);</span><span class="w">

    </span><span class="k">var</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">0</span><span class="p">];</span><span class="w">
    </span><span class="k">var</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span><span class="w">
    </span><span class="k">var</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="p">];</span><span class="w">
    </span><span class="k">var</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vs2_val</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">3</span><span class="p">];</span><span class="w">

    </span><span class="k">var</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">0</span><span class="p">];</span><span class="w">
    </span><span class="k">var</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span><span class="w">
    </span><span class="k">var</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="p">];</span><span class="w">
    </span><span class="k">var</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vd_val</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">3</span><span class="p">];</span><span class="w">

    </span><span class="k">let</span><span class="w"> </span><span class="n">message_sched_plus_c</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L185">get_velem_quad</a></span><span class="p">(</span><span class="n">vs1_val</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">

    </span><span class="k">let</span><span class="w"> </span><span class="n">w0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">ZVK_VSHA2CL_VV</span><span class="w">
             </span><span class="k">then</span><span class="w"> </span><span class="n">message_sched_plus_c</span><span class="p">[(</span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="w">
             </span><span class="k">else</span><span class="w"> </span><span class="n">message_sched_plus_c</span><span class="p">[(</span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">)];</span><span class="w">

    </span><span class="k">let</span><span class="w"> </span><span class="n">w1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">ZVK_VSHA2CL_VV</span><span class="w">
             </span><span class="k">then</span><span class="w"> </span><span class="n">message_sched_plus_c</span><span class="p">[(</span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="n">SEW</span><span class="p">]</span><span class="w">
             </span><span class="k">else</span><span class="w"> </span><span class="n">message_sched_plus_c</span><span class="p">[(</span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">3</span><span class="p">)];</span><span class="w">

    </span><span class="k">var</span><span class="w"> </span><span class="n">T1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L57">zvk_sum1</a></span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L65">zvk_ch</a></span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w0</span><span class="p">;</span><span class="w">
    </span><span class="k">var</span><span class="w"> </span><span class="n">T2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L49">zvk_sum0</a></span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L68">zvk_maj</a></span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">);</span><span class="w">

    </span><span class="n">h</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">g</span><span class="p">;</span><span class="w">
    </span><span class="n">g</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">f</span><span class="p">;</span><span class="w">
    </span><span class="n">f</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">e</span><span class="p">;</span><span class="w">
    </span><span class="n">e</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T1</span><span class="p">;</span><span class="w">
    </span><span class="n">d</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span><span class="w">
    </span><span class="n">c</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w">
    </span><span class="n">b</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">a</span><span class="p">;</span><span class="w">
    </span><span class="n">a</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">T1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T2</span><span class="p">;</span><span class="w">

    </span><span class="n">T1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L57">zvk_sum1</a></span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L65">zvk_ch</a></span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w1</span><span class="p">;</span><span class="w">
    </span><span class="n">T2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L49">zvk_sum0</a></span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L68">zvk_maj</a></span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">);</span><span class="w">
    </span><span class="n">h</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">g</span><span class="p">;</span><span class="w">
    </span><span class="n">g</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">f</span><span class="p">;</span><span class="w">
    </span><span class="n">f</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">e</span><span class="p">;</span><span class="w">
    </span><span class="n">e</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T1</span><span class="p">;</span><span class="w">
    </span><span class="n">d</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span><span class="w">
    </span><span class="n">c</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w">
    </span><span class="n">b</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">a</span><span class="p">;</span><span class="w">
    </span><span class="n">a</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n">T1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T2</span><span class="p">;</span><span class="w">

    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L189">write_velem_quad</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zvksm4rtype">ZVKSM4RTYPE</h4>
<div class="imageblock">
<div class="content">
<img src="diag-wavedrom-md5-d8c4ccec538005129dc7c9ece0180480.png" alt="Diagram" width="800" height="70">
</div>
<div class="title">Figure 326. Encoding</div>
</div>
<div class="paragraph">
<p>Prose description or link for ZVKSM4RTYPE goes here</p>
</div>
<div class="listingblock">
<div class="title">Operation</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sail"><span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">SEW</span><span class="w">      </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1007">get_sew</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L1017">get_lmul_pow</a></span><span class="p">();</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">num_elem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L241">get_num_elem</a></span><span class="p">(</span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">);</span><span class="w">

  </span><span class="n">assert</span><span class="p">(</span><span class="n">SEW</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">32</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">vs2_val</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vs2</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">vd_val</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_regs.html#L279">read_vreg</a></span><span class="p">(</span><span class="n">num_elem</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">LMUL_pow</span><span class="p">,</span><span class="w"> </span><span class="n">vd</span><span class="p">);</span><span class="w">

  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_len</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L953">vl</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">
  </span><span class="k">let</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">unsigned</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_sys_regs.html#L952">vstart</a></span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w">

  </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">eg_start</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="p">(</span><span class="n">eg_len</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">assert</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_elem</span><span class="p">);</span><span class="w">

    </span><span class="k">let</span><span class="w"> </span><span class="n">rk_in</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">funct6</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="n">ZVK_VSM4R_VV</span><span class="w">
                </span><span class="k">then</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L209">get_velem_quad_vec</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w">
                </span><span class="k">else</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L209">get_velem_quad_vec</a></span><span class="p">(</span><span class="n">vs2_val</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w">

    </span><span class="k">let</span><span class="w"> </span><span class="n">x_in</span><span class="w">  </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L209">get_velem_quad_vec</a></span><span class="p">(</span><span class="n">vd_val</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">

    </span><span class="k">var</span><span class="w"> </span><span class="n">x_out</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">vector</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="kt">bits</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">vector_init</span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">

    </span><span class="k">var</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x_in</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">x_in</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">x_in</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">rk_in</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w">
    </span><span class="k">var</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L104">zvk_sm4_subword</a></span><span class="p">(</span><span class="n">B</span><span class="p">);</span><span class="w">
    </span><span class="n">x_out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L81">zvk_sm4_round</a></span><span class="p">(</span><span class="n">x_in</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">S</span><span class="p">);</span><span class="w">

    </span><span class="n">B</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x_in</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w">  </span><span class="o">^</span><span class="w"> </span><span class="n">x_in</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w">  </span><span class="o">^</span><span class="w"> </span><span class="n">x_out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">rk_in</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="w">
    </span><span class="n">S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L104">zvk_sm4_subword</a></span><span class="p">(</span><span class="n">B</span><span class="p">);</span><span class="w">
    </span><span class="n">x_out</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L81">zvk_sm4_round</a></span><span class="p">(</span><span class="n">x_in</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">S</span><span class="p">);</span><span class="w">

    </span><span class="n">B</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x_in</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w">  </span><span class="o">^</span><span class="w"> </span><span class="n">x_out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">x_out</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">rk_in</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="w">
    </span><span class="n">S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L104">zvk_sm4_subword</a></span><span class="p">(</span><span class="n">B</span><span class="p">);</span><span class="w">
    </span><span class="n">x_out</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L81">zvk_sm4_round</a></span><span class="p">(</span><span class="n">x_in</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">S</span><span class="p">);</span><span class="w">

    </span><span class="n">B</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">x_out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">x_out</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">x_out</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">rk_in</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span><span class="w">
    </span><span class="n">S</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L104">zvk_sm4_subword</a></span><span class="p">(</span><span class="n">B</span><span class="p">);</span><span class="w">
    </span><span class="n">x_out</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_zvk_utils.html#L81">zvk_sm4_round</a></span><span class="p">(</span><span class="n">x_in</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="n">S</span><span class="p">);</span><span class="w">

    </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_insts_vext_utils.html#L213">write_velem_quad_vec</a></span><span class="p">(</span><span class="n">vd</span><span class="p">,</span><span class="w"> </span><span class="n">SEW</span><span class="p">,</span><span class="w"> </span><span class="n">x_out</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
  </span><span class="p">};</span><span class="w">

  </span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./riscv_vext_control.html#L15">set_vstart</a></span><span class="p">(</span><span class="n"><a href="https://alasdair.github.io/sail-riscv/./prelude.html#L89">zeros</a></span><span class="p">());</span><span class="w">
  </span><span class="n">RETIRE_SUCCESS</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-07-14 18:34:10 +0100
</div>
</div>
</body>
</html>